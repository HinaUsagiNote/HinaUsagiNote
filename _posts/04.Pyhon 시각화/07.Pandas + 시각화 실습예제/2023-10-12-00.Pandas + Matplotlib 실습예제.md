---
layout: single
title: 'Pandas+시각화실습예제'
typora-root-url: ../
categories: Pandas+시각화.실습예제
tag: Pandas+시각화
toc: true
---

# 데이터 불러오기

- 2022년 주유소들의 일자별 가격 데이터
- https://www.opinet.co.kr/user/opdown/opDownload.do


```python
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
from datetime import datetime # 날짜시간=>일시 티입
from datetime import date # 날짜
from datetime import time # 시간
from datetime import timedelta

import warnings
warnings.filterwarnings('ignore')
```


```python
# 상반기, 하반기 주유소 가격 데이터 조회
d1 = pd.read_csv('data/2022년_서울_상반기_일별_가격.csv', encoding="cp949")
d2 = pd.read_csv('data/2022년_서울_하반기_일별_가격.csv', encoding="cp949")
```


```python
# 상반기, 하반기 DataFrame 합치기
df = pd.concat([d1, d2], ignore_index=True) # 원본의 index이름을 무시하고 붙인다. 
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>

<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>지역</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0006039</td>
      <td>서울 강남구</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220101</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A0006039</td>
      <td>서울 강남구</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220102</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0006039</td>
      <td>서울 강남구</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220103</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A0006039</td>
      <td>서울 강남구</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220104</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A0006039</td>
      <td>서울 강남구</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220105</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>164477</th>
      <td>A0009138</td>
      <td>서울 중랑구</td>
      <td>우림주유소</td>
      <td>서울 중랑구 용마산로 487 (망우제3동)</td>
      <td>20221227</td>
      <td>GS칼텍스</td>
      <td>셀프</td>
      <td>0</td>
      <td>1525</td>
      <td>1745</td>
      <td>0</td>
    </tr>
    <tr>
      <th>164478</th>
      <td>A0009138</td>
      <td>서울 중랑구</td>
      <td>우림주유소</td>
      <td>서울 중랑구 용마산로 487 (망우제3동)</td>
      <td>20221228</td>
      <td>GS칼텍스</td>
      <td>셀프</td>
      <td>0</td>
      <td>1525</td>
      <td>1720</td>
      <td>0</td>
    </tr>
    <tr>
      <th>164479</th>
      <td>A0009138</td>
      <td>서울 중랑구</td>
      <td>우림주유소</td>
      <td>서울 중랑구 용마산로 487 (망우제3동)</td>
      <td>20221229</td>
      <td>GS칼텍스</td>
      <td>셀프</td>
      <td>0</td>
      <td>1525</td>
      <td>1720</td>
      <td>0</td>
    </tr>
    <tr>
      <th>164480</th>
      <td>A0009138</td>
      <td>서울 중랑구</td>
      <td>우림주유소</td>
      <td>서울 중랑구 용마산로 487 (망우제3동)</td>
      <td>20221230</td>
      <td>GS칼텍스</td>
      <td>셀프</td>
      <td>0</td>
      <td>1515</td>
      <td>1715</td>
      <td>0</td>
    </tr>
    <tr>
      <th>164481</th>
      <td>A0009138</td>
      <td>서울 중랑구</td>
      <td>우림주유소</td>
      <td>서울 중랑구 용마산로 487 (망우제3동)</td>
      <td>20221231</td>
      <td>GS칼텍스</td>
      <td>셀프</td>
      <td>0</td>
      <td>1515</td>
      <td>1715</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>164482 rows × 11 columns</p>
</div>




```python
# DataFrame 기본 정보 조회
## shape
df.shape
```




    (164482, 11)




```python
## 컬럼정보
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 164482 entries, 0 to 164481
    Data columns (total 11 columns):
     #   Column  Non-Null Count   Dtype 
    ---  ------  --------------   ----- 
     0   번호      164482 non-null  object
     1   지역      164482 non-null  object
     2   상호      164482 non-null  object
     3   주소      164482 non-null  object
     4   기간      164482 non-null  int64 
     5   상표      164482 non-null  object
     6   셀프여부    164482 non-null  object
     7   고급휘발유   164482 non-null  int64 
     8   휘발유     164482 non-null  int64 
     9   경유      164482 non-null  int64 
     10  실내등유    164482 non-null  int64 
    dtypes: int64(5), object(6)
    memory usage: 13.8+ MB



```python
## 결측치
df.isnull().sum()
```




    번호       0
    지역       0
    상호       0
    주소       0
    기간       0
    상표       0
    셀프여부     0
    고급휘발유    0
    휘발유      0
    경유       0
    실내등유     0
    dtype: int64




```python
### 통계량
df.describe()  # 수치형
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>기간</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.644820e+05</td>
      <td>164482.000000</td>
      <td>164482.000000</td>
      <td>164482.000000</td>
      <td>164482.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.022066e+07</td>
      <td>1083.639146</td>
      <td>1877.600838</td>
      <td>1907.360337</td>
      <td>538.948444</td>
    </tr>
    <tr>
      <th>std</th>
      <td>3.456995e+02</td>
      <td>1085.018886</td>
      <td>243.317021</td>
      <td>237.067045</td>
      <td>761.401689</td>
    </tr>
    <tr>
      <th>min</th>
      <td>2.022010e+07</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>2.022033e+07</td>
      <td>0.000000</td>
      <td>1690.000000</td>
      <td>1817.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.022063e+07</td>
      <td>1760.000000</td>
      <td>1855.000000</td>
      <td>1899.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.022093e+07</td>
      <td>2130.000000</td>
      <td>2030.000000</td>
      <td>2018.000000</td>
      <td>1451.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2.022123e+07</td>
      <td>3496.000000</td>
      <td>3096.000000</td>
      <td>3230.000000</td>
      <td>2719.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
### 문자형의 통계량
df.describe(include="object")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>지역</th>
      <th>상호</th>
      <th>주소</th>
      <th>상표</th>
      <th>셀프여부</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>164482</td>
      <td>164482</td>
      <td>164482</td>
      <td>164482</td>
      <td>164482</td>
      <td>164482</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>469</td>
      <td>25</td>
      <td>464</td>
      <td>469</td>
      <td>7</td>
      <td>2</td>
    </tr>
    <tr>
      <th>top</th>
      <td>A0006039</td>
      <td>서울 강남구</td>
      <td>대성주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>SK에너지</td>
      <td>셀프</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>365</td>
      <td>12278</td>
      <td>730</td>
      <td>365</td>
      <td>48267</td>
      <td>92478</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 상표 컬럼의 고유값 조회
df['상표'].value_counts()
```




    상표
    SK에너지     48267
    현대오일뱅크    42351
    GS칼텍스     40449
    S-OIL     28762
    알뜰주유소      3551
    자가상표        737
    알뜰(ex)      365
    Name: count, dtype: int64




```python
# 지역 컬럼의 고유값 조회
df['지역'].value_counts()
```




    지역
    서울 강남구     12278
    서울 강서구     11825
    서울 송파구     11295
    서울 서초구     11231
    서울 영등포구     9814
    서울 양천구      9015
    서울 성북구      8522
    서울 구로구      7384
    서울 동대문구     6574
    서울 성동구      6006
    서울 도봉구      5992
    서울 은평구      5807
    서울 노원구      5474
    서울 서대문구     5472
    서울 강동구      5110
    서울 광진구      5107
    서울 관악구      5104
    서울 중랑구      4873
    서울 용산구      4637
    서울 강북구      4460
    서울 마포구      4375
    서울 금천구      4067
    서울 중구       3643
    서울 동작구      3436
    서울 종로구      2981
    Name: count, dtype: int64




```python
## self 여부
df['셀프여부'].value_counts()
```




    셀프여부
    셀프    92478
    일반    72004
    Name: count, dtype: int64



> ### str accessor
> - `Series.str.String메소드()`
> - 문자열 타입 Series에 String 메소드들을 사용하여 일괄처리 할 수 있도록 한다.
> - str accessor 메소드 : https://pandas.pydata.org/pandas-docs/stable/reference/series.html#api-series-str

> ### datetime으로 변환
> - `pd.to_datetime(변환할 Series, format="날짜형식")`
> - x 또는 y 축이 날짜 일 경우 datetime 타입으로 처리하는 것이 좋다.
> - format: 년월일의 형식을 strftime 형식문자열로 지정한다. 
>      - [strftime 형식](https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes)  
> - datetime을 변환하면 날짜만의 기능을 다룰 수 있다.
>     - dt accessor를 이용해 datetime의 속성값들을(년, 월, 일 등) 추출할 수 있다.
>     - https://pandas.pydata.org/pandas-docs/stable/reference/series.html#datetime-properties



```python
"서울,강남구".split(",")
"서울 강남구".split()[1]
```




    '강남구'




```python
# 지역 컬럼의 값을 이용하여 "구" 컬럼 생성 (지역에서 구만 추출해서 파생변수컬럼 생성)
# df['지역'].apply(lambda addr : addr.split()[1])
df['구'] = df['지역'].str.split(expand=True)[1]
```


```python
df['구']
```




    0         강남구
    1         강남구
    2         강남구
    3         강남구
    4         강남구
             ... 
    164477    중랑구
    164478    중랑구
    164479    중랑구
    164480    중랑구
    164481    중랑구
    Name: 구, Length: 164482, dtype: object




```python
df.drop(columns='지역', inplace=True)
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220101</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220102</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220103</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220104</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>20220105</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 기간 컬럼을 datetime 타입으로 변경 ==> to_datetime()
### 기간: int
df['기간'] = pd.to_datetime(df['기간'], format="%Y%m%d")  # 2022: 4자리, 01: 두자리, 02: 두자리.
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-01</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-02</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-03</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-04</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-05</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 164482 entries, 0 to 164481
    Data columns (total 11 columns):
     #   Column  Non-Null Count   Dtype         
    ---  ------  --------------   -----         
     0   번호      164482 non-null  object        
     1   상호      164482 non-null  object        
     2   주소      164482 non-null  object        
     3   기간      164482 non-null  datetime64[ns]
     4   상표      164482 non-null  object        
     5   셀프여부    164482 non-null  object        
     6   고급휘발유   164482 non-null  int64         
     7   휘발유     164482 non-null  int64         
     8   경유      164482 non-null  int64         
     9   실내등유    164482 non-null  int64         
     10  구       164482 non-null  object        
    dtypes: datetime64[ns](1), int64(4), object(6)
    memory usage: 13.8+ MB



```python
# 기간 컬럼을 이용해 "월", "일", "요일" 컬럼 생성 (dt accessor 이용)
df['월'] = df['기간'].dt.month
df['일'] = df['기간'].dt.day
df['요일'] = df['기간'].dt.weekday  # 0: 월 ~ 6:일
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-01</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-02</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>2</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-03</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>3</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-04</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>4</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-05</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>5</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
"월화수목금토일"[5]
```




    '토'




```python
# 요일 - 0:월, 1:화, 2:수, 3:목, 4:금, 5:토, 6:일 로 변경
df['요일'] = df['요일'].apply(lambda x: "월화수목금토일"[x])  #+"요일")
```


```python
df.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-01</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>1</td>
      <td>토</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-02</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>2</td>
      <td>일</td>
    </tr>
    <tr>
      <th>2</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-03</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>3</td>
      <td>월</td>
    </tr>
    <tr>
      <th>3</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-04</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>4</td>
      <td>화</td>
    </tr>
    <tr>
      <th>4</th>
      <td>A0006039</td>
      <td>(유)동하석유 힐탑셀프주유소</td>
      <td>서울 강남구 논현로 640</td>
      <td>2022-01-05</td>
      <td>SK에너지</td>
      <td>셀프</td>
      <td>1887</td>
      <td>1737</td>
      <td>1587</td>
      <td>0</td>
      <td>강남구</td>
      <td>1</td>
      <td>5</td>
      <td>수</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 전처리한 DataFrame -> 저장.
df.to_csv('data/2022년_서울주유소_데이터셋.csv', index=False)
```


```python
# 휘발유 가격이 가장 비싼 5개 행 조회
df.sort_values("휘발유", ascending=False).head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78935</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-22</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>22</td>
      <td>수</td>
    </tr>
    <tr>
      <th>78939</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-26</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>26</td>
      <td>일</td>
    </tr>
    <tr>
      <th>78937</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-24</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>24</td>
      <td>금</td>
    </tr>
    <tr>
      <th>78936</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-23</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>23</td>
      <td>목</td>
    </tr>
    <tr>
      <th>78940</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-27</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>27</td>
      <td>월</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 휘발유 가격이 가장 저렴한 5개 행 조회 (단 0원인 주유소 제외)
df.query("휘발유 != 0").sort_values('휘발유').head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99498</th>
      <td>A0000519</td>
      <td>화곡역주유소</td>
      <td>서울 강서구 강서로 154 (화곡동)</td>
      <td>2022-12-27</td>
      <td>알뜰주유소</td>
      <td>셀프</td>
      <td>0</td>
      <td>1410</td>
      <td>1660</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>27</td>
      <td>화</td>
    </tr>
    <tr>
      <th>97839</th>
      <td>A0000549</td>
      <td>이케이에너지(주) 강서주유소</td>
      <td>서울 강서구 화곡로 273 (화곡동)</td>
      <td>2022-12-24</td>
      <td>현대오일뱅크</td>
      <td>셀프</td>
      <td>0</td>
      <td>1410</td>
      <td>1660</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>24</td>
      <td>토</td>
    </tr>
    <tr>
      <th>97840</th>
      <td>A0000549</td>
      <td>이케이에너지(주) 강서주유소</td>
      <td>서울 강서구 화곡로 273 (화곡동)</td>
      <td>2022-12-25</td>
      <td>현대오일뱅크</td>
      <td>셀프</td>
      <td>0</td>
      <td>1410</td>
      <td>1660</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>25</td>
      <td>일</td>
    </tr>
    <tr>
      <th>148433</th>
      <td>A0001005</td>
      <td>현대주유소</td>
      <td>서울 양천구 남부순환로 372 (신월동)</td>
      <td>2022-12-26</td>
      <td>S-OIL</td>
      <td>셀프</td>
      <td>0</td>
      <td>1410</td>
      <td>1660</td>
      <td>0</td>
      <td>양천구</td>
      <td>12</td>
      <td>26</td>
      <td>월</td>
    </tr>
    <tr>
      <th>97838</th>
      <td>A0000549</td>
      <td>이케이에너지(주) 강서주유소</td>
      <td>서울 강서구 화곡로 273 (화곡동)</td>
      <td>2022-12-23</td>
      <td>현대오일뱅크</td>
      <td>셀프</td>
      <td>0</td>
      <td>1410</td>
      <td>1660</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>23</td>
      <td>금</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 고급휘발유 가격이 가장 비싼 5개 행 조회
df.sort_values('고급휘발유', ascending=False).head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78940</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-27</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>27</td>
      <td>월</td>
    </tr>
    <tr>
      <th>78939</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-26</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>26</td>
      <td>일</td>
    </tr>
    <tr>
      <th>78938</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-25</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>25</td>
      <td>토</td>
    </tr>
    <tr>
      <th>78937</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-24</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>24</td>
      <td>금</td>
    </tr>
    <tr>
      <th>78936</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-23</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3496</td>
      <td>3096</td>
      <td>3223</td>
      <td>2719</td>
      <td>중구</td>
      <td>6</td>
      <td>23</td>
      <td>목</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 고급휘발유 가격이 가장 저렴한 5개 행 조회 (단 0원인 주유소 제외)
df.query('고급휘발유 != 0').sort_values('고급휘발유').head(5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>98571</th>
      <td>A0000520</td>
      <td>하이웨이주유소</td>
      <td>서울특별시 강서구 공항대로 432(화곡동)</td>
      <td>2022-12-20</td>
      <td>S-OIL</td>
      <td>셀프</td>
      <td>1599</td>
      <td>1527</td>
      <td>1787</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>20</td>
      <td>화</td>
    </tr>
    <tr>
      <th>98572</th>
      <td>A0000520</td>
      <td>하이웨이주유소</td>
      <td>서울특별시 강서구 공항대로 432(화곡동)</td>
      <td>2022-12-21</td>
      <td>S-OIL</td>
      <td>셀프</td>
      <td>1599</td>
      <td>1499</td>
      <td>1759</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>21</td>
      <td>수</td>
    </tr>
    <tr>
      <th>98573</th>
      <td>A0000520</td>
      <td>하이웨이주유소</td>
      <td>서울특별시 강서구 공항대로 432(화곡동)</td>
      <td>2022-12-22</td>
      <td>S-OIL</td>
      <td>셀프</td>
      <td>1599</td>
      <td>1499</td>
      <td>1759</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>22</td>
      <td>목</td>
    </tr>
    <tr>
      <th>98574</th>
      <td>A0000520</td>
      <td>하이웨이주유소</td>
      <td>서울특별시 강서구 공항대로 432(화곡동)</td>
      <td>2022-12-23</td>
      <td>S-OIL</td>
      <td>셀프</td>
      <td>1599</td>
      <td>1499</td>
      <td>1729</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>23</td>
      <td>금</td>
    </tr>
    <tr>
      <th>98575</th>
      <td>A0000520</td>
      <td>하이웨이주유소</td>
      <td>서울특별시 강서구 공항대로 432(화곡동)</td>
      <td>2022-12-24</td>
      <td>S-OIL</td>
      <td>셀프</td>
      <td>1599</td>
      <td>1499</td>
      <td>1729</td>
      <td>0</td>
      <td>강서구</td>
      <td>12</td>
      <td>24</td>
      <td>토</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 경유 가격이 가장 비싼 5개 행 조회
df.sort_values('경유', ascending=False).head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>78942</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-29</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3481</td>
      <td>3081</td>
      <td>3230</td>
      <td>2703</td>
      <td>중구</td>
      <td>6</td>
      <td>29</td>
      <td>수</td>
    </tr>
    <tr>
      <th>160618</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-07-01</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3481</td>
      <td>3081</td>
      <td>3230</td>
      <td>2703</td>
      <td>중구</td>
      <td>7</td>
      <td>1</td>
      <td>금</td>
    </tr>
    <tr>
      <th>78941</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-28</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3481</td>
      <td>3081</td>
      <td>3230</td>
      <td>2703</td>
      <td>중구</td>
      <td>6</td>
      <td>28</td>
      <td>화</td>
    </tr>
    <tr>
      <th>78943</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-06-30</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3481</td>
      <td>3081</td>
      <td>3230</td>
      <td>2703</td>
      <td>중구</td>
      <td>6</td>
      <td>30</td>
      <td>목</td>
    </tr>
    <tr>
      <th>160621</th>
      <td>A0000767</td>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>2022-07-04</td>
      <td>SK에너지</td>
      <td>일반</td>
      <td>3481</td>
      <td>3081</td>
      <td>3230</td>
      <td>2703</td>
      <td>중구</td>
      <td>7</td>
      <td>4</td>
      <td>월</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 경유 가격이 가장 저렴한 5개 행 조회 (단 0원인 주유소 제외)
df.query('경유 != 0').sort_values('경유').head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>번호</th>
      <th>상호</th>
      <th>주소</th>
      <th>기간</th>
      <th>상표</th>
      <th>셀프여부</th>
      <th>고급휘발유</th>
      <th>휘발유</th>
      <th>경유</th>
      <th>실내등유</th>
      <th>구</th>
      <th>월</th>
      <th>일</th>
      <th>요일</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45209</th>
      <td>A0011826</td>
      <td>만남의광장주유소</td>
      <td>서울 서초구 양재대로12길 73-71</td>
      <td>2022-01-16</td>
      <td>알뜰(ex)</td>
      <td>셀프</td>
      <td>0</td>
      <td>1565</td>
      <td>1367</td>
      <td>0</td>
      <td>서초구</td>
      <td>1</td>
      <td>16</td>
      <td>일</td>
    </tr>
    <tr>
      <th>12343</th>
      <td>A0004657</td>
      <td>뉴신정주유소</td>
      <td>서울 강서구 곰달래로 207 (화곡동)</td>
      <td>2022-01-11</td>
      <td>알뜰주유소</td>
      <td>일반</td>
      <td>0</td>
      <td>1547</td>
      <td>1377</td>
      <td>0</td>
      <td>강서구</td>
      <td>1</td>
      <td>11</td>
      <td>화</td>
    </tr>
    <tr>
      <th>12344</th>
      <td>A0004657</td>
      <td>뉴신정주유소</td>
      <td>서울 강서구 곰달래로 207 (화곡동)</td>
      <td>2022-01-12</td>
      <td>알뜰주유소</td>
      <td>일반</td>
      <td>0</td>
      <td>1547</td>
      <td>1377</td>
      <td>0</td>
      <td>강서구</td>
      <td>1</td>
      <td>12</td>
      <td>수</td>
    </tr>
    <tr>
      <th>12345</th>
      <td>A0004657</td>
      <td>뉴신정주유소</td>
      <td>서울 강서구 곰달래로 207 (화곡동)</td>
      <td>2022-01-13</td>
      <td>알뜰주유소</td>
      <td>일반</td>
      <td>0</td>
      <td>1547</td>
      <td>1377</td>
      <td>0</td>
      <td>강서구</td>
      <td>1</td>
      <td>13</td>
      <td>목</td>
    </tr>
    <tr>
      <th>16318</th>
      <td>A0000519</td>
      <td>화곡역주유소</td>
      <td>서울 강서구 강서로 154 (화곡동)</td>
      <td>2022-01-06</td>
      <td>알뜰주유소</td>
      <td>셀프</td>
      <td>0</td>
      <td>1547</td>
      <td>1377</td>
      <td>0</td>
      <td>강서구</td>
      <td>1</td>
      <td>6</td>
      <td>목</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 상표별 휘발유 평균가격 조회
df.groupby('상표')['휘발유'].mean()
```




    상표
    GS칼텍스     1904.899429
    S-OIL     1859.282595
    SK에너지     1908.900823
    알뜰(ex)    1759.884932
    알뜰주유소     1767.914672
    자가상표      1823.622795
    현대오일뱅크    1839.447215
    Name: 휘발유, dtype: float64




```python
### 0원인 주유소는 빼고 계산
휘발유_상표별_평균 = df.query("휘발유 != 0").groupby("상표")['휘발유'].mean()
휘발유_상표별_평균
```




    상표
    GS칼텍스     1908.343496
    S-OIL     1859.541206
    SK에너지     1910.959577
    알뜰(ex)    1759.884932
    알뜰주유소     1769.908373
    자가상표      1838.590971
    현대오일뱅크    1846.510441
    Name: 휘발유, dtype: float64




```python
# 상표별 휘발유 평균가격 시각화 -> bar plot

전체평균 = df['휘발유'].mean()

# 상표별 평균 시각화
plt.figure(figsize=(12,7))
plt.ylim(0, 2200)
휘발유_상표별_평균.sort_values(ascending=False).plot(kind='bar', rot=45)

# 전체평균 표시
plt.axhline(전체평균, color="red", linestyle=":", label=f"전체평균: {전체평균:.2f}")
plt.legend(bbox_to_anchor=(1,1), loc="upper left")
plt.show()
```


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_35_0.png)
    



```python
# 셀프주유소와 일반주유소 개수 확인
df['셀프여부'].value_counts()
df['셀프여부'].value_counts(normalize=True)
```




    셀프여부
    셀프    0.562238
    일반    0.437762
    Name: proportion, dtype: float64




```python
# 셀프 여부에 따른 휘발유 평균 가격 비교 
df.groupby("셀프여부")["휘발유"].mean()
```




    셀프여부
    셀프    1818.216376
    일반    1953.870993
    Name: 휘발유, dtype: float64




```python
df.query("휘발유 != 0").groupby("셀프여부")["휘발유"].mean()
```




    셀프여부
    셀프    1820.637908
    일반    1958.713098
    Name: 휘발유, dtype: float64




```python
# 상표별 일반/셀프 주유소의 휘발유 가격 평균 비교
df.query(" 휘발유 != 0").groupby(['상표', "셀프여부"])["휘발유"].mean()
df.query(" 휘발유 != 0").groupby(['상표', "셀프여부"])["휘발유"].mean().unstack()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>셀프여부</th>
      <th>셀프</th>
      <th>일반</th>
    </tr>
    <tr>
      <th>상표</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GS칼텍스</th>
      <td>1828.562962</td>
      <td>2005.825721</td>
    </tr>
    <tr>
      <th>S-OIL</th>
      <td>1820.122748</td>
      <td>1932.884711</td>
    </tr>
    <tr>
      <th>SK에너지</th>
      <td>1827.000349</td>
      <td>2007.517369</td>
    </tr>
    <tr>
      <th>알뜰(ex)</th>
      <td>1759.884932</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>알뜰주유소</th>
      <td>1757.196152</td>
      <td>1796.201557</td>
    </tr>
    <tr>
      <th>자가상표</th>
      <td>2017.000000</td>
      <td>1836.866022</td>
    </tr>
    <tr>
      <th>현대오일뱅크</th>
      <td>1813.739309</td>
      <td>1885.390495</td>
    </tr>
  </tbody>
</table>
</div>




```python
상표_셀프여부_휘발유_평균 = df.query("휘발유!=0").pivot_table(index="상표", columns="셀프여부", 
                                                              values="휘발유", aggfunc="mean",
                                                              margins=True)
상표_셀프여부_휘발유_평균
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>셀프여부</th>
      <th>셀프</th>
      <th>일반</th>
      <th>All</th>
    </tr>
    <tr>
      <th>상표</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>GS칼텍스</th>
      <td>1828.562962</td>
      <td>2005.825721</td>
      <td>1908.343496</td>
    </tr>
    <tr>
      <th>S-OIL</th>
      <td>1820.122748</td>
      <td>1932.884711</td>
      <td>1859.541206</td>
    </tr>
    <tr>
      <th>SK에너지</th>
      <td>1827.000349</td>
      <td>2007.517369</td>
      <td>1910.959577</td>
    </tr>
    <tr>
      <th>알뜰(ex)</th>
      <td>1759.884932</td>
      <td>NaN</td>
      <td>1759.884932</td>
    </tr>
    <tr>
      <th>알뜰주유소</th>
      <td>1757.196152</td>
      <td>1796.201557</td>
      <td>1769.908373</td>
    </tr>
    <tr>
      <th>자가상표</th>
      <td>2017.000000</td>
      <td>1836.866022</td>
      <td>1838.590971</td>
    </tr>
    <tr>
      <th>현대오일뱅크</th>
      <td>1813.739309</td>
      <td>1885.390495</td>
      <td>1846.510441</td>
    </tr>
    <tr>
      <th>All</th>
      <td>1820.637908</td>
      <td>1958.713098</td>
      <td>1881.043123</td>
    </tr>
  </tbody>
</table>
</div>




```python
### DataFrame.plot()
#### index명이 X축으로 들어오고 컬럼의 값을 이용해서 그래프를 그림.
##### 컬럼이 여러개일때는 하나의 Axes에 따로 따로 그린다.
```


```python
# 상표별 일반/셀프 주유소의 휘발유 가격 평균 비교 시각화
## 상표_셀프여부_휘발유_평균에 서 ALL을 빼고 시각화
상표_셀프여부_휘발유_평균.iloc[:-1, :-1].plot(kind='bar')
plt.legend(bbox_to_anchor=(1,1), loc='upper left')
plt.show()
```


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_42_0.png)
    



```python
## 휘발유 가격의 분포
df.query('휘발유!=0')['휘발유'].plot(kind='box');
```


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_43_0.png)
    



```python
import warnings
warnings.filterwarnings(action='ignore')
```


```python
# 상표별 휘발유 가격의 분포를 boxplot으로 시각화
#### 범주형 컬럼을 이용해 group별로 나눠서 시각화 ====> seaborn 이 편함. 
plt.figure(figsize=(10,6))
# sns.boxplot(data=df.query("휘발유!=0"), y='휘발유', x="상표")
sns.violinplot(data=df.query("휘발유!=0"), y='휘발유', x="상표")
plt.show()

```


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_45_0.png)
    



```python
# 상표별 일반/셀프 주유소의 휘발유 가격에 대한 분포 확인 - boxplot으로 시각화
plt.figure(figsize=(10,6))
# sns.boxplot(data=df.query("휘발유!=0"), y='휘발유', x="상표", hue="셀프여부")
sns.violinplot(data=df.query("휘발유!=0"), y='휘발유', x="상표", hue="셀프여부")
plt.show()
```


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_46_0.png)
    



```python
# 구별 휘발유 가격의 평균
구별_휘발유_평균 = df.query('휘발유 != 0').groupby("구")['휘발유'].mean().sort_values(ascending=False)
구별_휘발유_평균
```




    구
    용산구     2220.150152
    중구      2164.813156
    종로구     2130.644512
    강남구     2027.348234
    성동구     1927.180711
    강동구     1911.814372
    서초구     1908.632928
    마포구     1883.471491
    영등포구    1867.273173
    구로구     1866.193142
    관악구     1855.413983
    동작구     1850.987097
    송파구     1847.526087
    노원구     1846.423689
    강서구     1829.916928
    동대문구    1826.440487
    은평구     1823.821755
    광진구     1820.783333
    서대문구    1820.522224
    성북구     1807.024316
    중랑구     1805.788631
    금천구     1804.142998
    양천구     1803.676968
    도봉구     1801.099349
    강북구     1787.720341
    Name: 휘발유, dtype: float64




```python
구별_휘발유_평균.index[0]
```




    '용산구'




```python
# 평균 가격이 가장 높은 구의 상표별 휘발유 평균가격
df.query('구 == @구별_휘발유_평균.index[0]').groupby("상표")['휘발유'].mean()
```




    상표
    GS칼텍스     2386.086653
    SK에너지     2245.048402
    현대오일뱅크    2013.058905
    Name: 휘발유, dtype: float64




```python
# 월 평균 휘발유 가격
월별_휘발유_평균 = df.query('휘발유 != 0').groupby('월')["휘발유"].mean()
월별_휘발유_평균
```




    월
    1     1705.212460
    2     1782.078505
    3     2011.746876
    4     2036.850250
    5     2027.546073
    6     2151.490272
    7     2082.968590
    8     1858.737602
    9     1799.950232
    10    1737.664435
    11    1719.719665
    12    1648.983053
    Name: 휘발유, dtype: float64




```python
월별_휘발유_평균.sort_values()
```




    월
    12    1648.983053
    1     1705.212460
    11    1719.719665
    10    1737.664435
    2     1782.078505
    9     1799.950232
    8     1858.737602
    3     2011.746876
    5     2027.546073
    4     2036.850250
    7     2082.968590
    6     2151.490272
    Name: 휘발유, dtype: float64




```python
# 각 구의 월별 평균 휘발유 가격 
월_구별_휘발유_평균가격 = df.query("휘발유!=0").groupby(["구", "월"])['휘발유'].mean()
월_구별_휘발유_평균가격.unstack()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>월</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>10</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>구</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>강남구</th>
      <td>1845.037951</td>
      <td>1914.714286</td>
      <td>2113.529299</td>
      <td>2138.078788</td>
      <td>2137.114674</td>
      <td>2273.512745</td>
      <td>2223.274194</td>
      <td>2013.865275</td>
      <td>1965.875000</td>
      <td>1916.990503</td>
      <td>1912.334681</td>
      <td>1864.611718</td>
    </tr>
    <tr>
      <th>강동구</th>
      <td>1740.217391</td>
      <td>1797.400510</td>
      <td>2024.729167</td>
      <td>2075.559524</td>
      <td>2055.983871</td>
      <td>2174.080952</td>
      <td>2125.896313</td>
      <td>1910.246544</td>
      <td>1829.524038</td>
      <td>1762.182028</td>
      <td>1747.871429</td>
      <td>1693.755760</td>
    </tr>
    <tr>
      <th>강북구</th>
      <td>1599.384615</td>
      <td>1692.991758</td>
      <td>1954.910670</td>
      <td>1968.938462</td>
      <td>1946.035230</td>
      <td>2077.157576</td>
      <td>1976.936986</td>
      <td>1756.037634</td>
      <td>1692.447222</td>
      <td>1640.524194</td>
      <td>1624.188889</td>
      <td>1542.555256</td>
    </tr>
    <tr>
      <th>강서구</th>
      <td>1657.352823</td>
      <td>1744.524554</td>
      <td>1968.371976</td>
      <td>1996.155370</td>
      <td>1989.009073</td>
      <td>2118.266180</td>
      <td>2037.915992</td>
      <td>1814.660137</td>
      <td>1744.274747</td>
      <td>1679.471163</td>
      <td>1655.586869</td>
      <td>1573.269608</td>
    </tr>
    <tr>
      <th>관악구</th>
      <td>1693.370370</td>
      <td>1767.613811</td>
      <td>1992.619816</td>
      <td>2012.595238</td>
      <td>1986.184758</td>
      <td>2117.292857</td>
      <td>2061.854839</td>
      <td>1829.476959</td>
      <td>1778.404306</td>
      <td>1712.705069</td>
      <td>1686.050360</td>
      <td>1616.750588</td>
    </tr>
    <tr>
      <th>광진구</th>
      <td>1643.827586</td>
      <td>1733.171838</td>
      <td>1965.270968</td>
      <td>1975.047281</td>
      <td>1959.891705</td>
      <td>2096.482014</td>
      <td>2018.152074</td>
      <td>1785.532258</td>
      <td>1734.718670</td>
      <td>1666.218362</td>
      <td>1654.041026</td>
      <td>1589.910798</td>
    </tr>
    <tr>
      <th>구로구</th>
      <td>1679.963134</td>
      <td>1754.278912</td>
      <td>2005.556068</td>
      <td>2038.362460</td>
      <td>2015.151613</td>
      <td>2132.770000</td>
      <td>2078.689935</td>
      <td>1854.947798</td>
      <td>1786.936667</td>
      <td>1719.793548</td>
      <td>1695.270000</td>
      <td>1624.073211</td>
    </tr>
    <tr>
      <th>금천구</th>
      <td>1643.854839</td>
      <td>1718.961310</td>
      <td>1953.561404</td>
      <td>1966.767584</td>
      <td>1941.687316</td>
      <td>2081.944444</td>
      <td>1998.354839</td>
      <td>1788.944282</td>
      <td>1731.793939</td>
      <td>1664.614706</td>
      <td>1633.449541</td>
      <td>1547.234421</td>
    </tr>
    <tr>
      <th>노원구</th>
      <td>1671.234914</td>
      <td>1749.078571</td>
      <td>1981.651613</td>
      <td>2007.235556</td>
      <td>2007.703226</td>
      <td>2117.348889</td>
      <td>2070.651613</td>
      <td>1829.000000</td>
      <td>1767.555556</td>
      <td>1683.490323</td>
      <td>1666.338530</td>
      <td>1600.125270</td>
    </tr>
    <tr>
      <th>도봉구</th>
      <td>1613.964158</td>
      <td>1702.603175</td>
      <td>1964.155009</td>
      <td>1974.970894</td>
      <td>1958.483871</td>
      <td>2086.650000</td>
      <td>2002.050403</td>
      <td>1774.889113</td>
      <td>1712.797917</td>
      <td>1648.629032</td>
      <td>1630.922917</td>
      <td>1561.892495</td>
    </tr>
    <tr>
      <th>동대문구</th>
      <td>1644.443124</td>
      <td>1725.765038</td>
      <td>1973.453311</td>
      <td>1986.573975</td>
      <td>1974.711470</td>
      <td>2100.447124</td>
      <td>2036.370968</td>
      <td>1795.304659</td>
      <td>1735.963810</td>
      <td>1670.426945</td>
      <td>1651.074656</td>
      <td>1584.761905</td>
    </tr>
    <tr>
      <th>동작구</th>
      <td>1683.448387</td>
      <td>1759.792857</td>
      <td>1994.848387</td>
      <td>2012.120000</td>
      <td>1992.058632</td>
      <td>2105.007326</td>
      <td>2033.609319</td>
      <td>1814.770609</td>
      <td>1763.066667</td>
      <td>1707.279570</td>
      <td>1691.887640</td>
      <td>1606.234375</td>
    </tr>
    <tr>
      <th>마포구</th>
      <td>1730.167116</td>
      <td>1793.303303</td>
      <td>2018.032258</td>
      <td>2029.151685</td>
      <td>2036.105121</td>
      <td>2162.422222</td>
      <td>2082.368280</td>
      <td>1858.819892</td>
      <td>1804.103064</td>
      <td>1726.237197</td>
      <td>1707.264624</td>
      <td>1649.509434</td>
    </tr>
    <tr>
      <th>서대문구</th>
      <td>1640.012903</td>
      <td>1722.961905</td>
      <td>1961.000000</td>
      <td>1991.915367</td>
      <td>1973.363441</td>
      <td>2099.046667</td>
      <td>2023.470968</td>
      <td>1798.133333</td>
      <td>1743.460000</td>
      <td>1669.511879</td>
      <td>1649.049107</td>
      <td>1568.753247</td>
    </tr>
    <tr>
      <th>서초구</th>
      <td>1736.535610</td>
      <td>1810.234020</td>
      <td>2022.518738</td>
      <td>2057.168574</td>
      <td>2052.732979</td>
      <td>2169.572553</td>
      <td>2103.178649</td>
      <td>1886.698913</td>
      <td>1835.893905</td>
      <td>1780.300971</td>
      <td>1761.293258</td>
      <td>1684.103219</td>
    </tr>
    <tr>
      <th>성동구</th>
      <td>1734.804554</td>
      <td>1810.227848</td>
      <td>2042.379507</td>
      <td>2078.880392</td>
      <td>2060.633776</td>
      <td>2190.382353</td>
      <td>2143.456000</td>
      <td>1915.363071</td>
      <td>1848.378661</td>
      <td>1784.703030</td>
      <td>1767.444676</td>
      <td>1713.223140</td>
    </tr>
    <tr>
      <th>성북구</th>
      <td>1632.611559</td>
      <td>1715.837798</td>
      <td>1961.168011</td>
      <td>1978.133333</td>
      <td>1957.707586</td>
      <td>2088.650725</td>
      <td>2012.291961</td>
      <td>1772.318373</td>
      <td>1711.788099</td>
      <td>1652.308555</td>
      <td>1631.578102</td>
      <td>1560.074753</td>
    </tr>
    <tr>
      <th>송파구</th>
      <td>1678.787909</td>
      <td>1741.297991</td>
      <td>1967.725806</td>
      <td>2001.121212</td>
      <td>1991.337796</td>
      <td>2115.770721</td>
      <td>2058.980021</td>
      <td>1826.300000</td>
      <td>1758.666667</td>
      <td>1700.651238</td>
      <td>1685.222717</td>
      <td>1617.552863</td>
    </tr>
    <tr>
      <th>양천구</th>
      <td>1633.020645</td>
      <td>1711.940000</td>
      <td>1945.768734</td>
      <td>1964.691176</td>
      <td>1956.673127</td>
      <td>2084.834446</td>
      <td>2004.267097</td>
      <td>1773.624516</td>
      <td>1715.977303</td>
      <td>1650.253752</td>
      <td>1631.157163</td>
      <td>1537.569655</td>
    </tr>
    <tr>
      <th>영등포구</th>
      <td>1700.583035</td>
      <td>1777.378486</td>
      <td>2020.534296</td>
      <td>2040.609756</td>
      <td>2027.461722</td>
      <td>2143.571605</td>
      <td>2056.821983</td>
      <td>1836.010778</td>
      <td>1767.259305</td>
      <td>1717.361677</td>
      <td>1702.601978</td>
      <td>1617.949275</td>
    </tr>
    <tr>
      <th>용산구</th>
      <td>2046.389578</td>
      <td>2119.343407</td>
      <td>2323.992366</td>
      <td>2358.296000</td>
      <td>2387.131514</td>
      <td>2471.287179</td>
      <td>2381.947631</td>
      <td>2165.801489</td>
      <td>2130.389744</td>
      <td>2081.330667</td>
      <td>2087.515320</td>
      <td>2048.384393</td>
    </tr>
    <tr>
      <th>은평구</th>
      <td>1641.127016</td>
      <td>1718.214765</td>
      <td>1956.024194</td>
      <td>1988.985386</td>
      <td>1966.931452</td>
      <td>2087.960417</td>
      <td>2028.060484</td>
      <td>1804.530242</td>
      <td>1742.321503</td>
      <td>1679.393509</td>
      <td>1659.422594</td>
      <td>1592.550538</td>
    </tr>
    <tr>
      <th>종로구</th>
      <td>1924.910394</td>
      <td>1995.059524</td>
      <td>2193.612000</td>
      <td>2248.836134</td>
      <td>2252.173387</td>
      <td>2350.654167</td>
      <td>2327.391129</td>
      <td>2158.129032</td>
      <td>2110.458333</td>
      <td>2044.685484</td>
      <td>2030.666667</td>
      <td>1966.540323</td>
    </tr>
    <tr>
      <th>중구</th>
      <td>2002.511401</td>
      <td>2073.921429</td>
      <td>2279.656766</td>
      <td>2289.248252</td>
      <td>2325.951613</td>
      <td>2434.632997</td>
      <td>2331.203226</td>
      <td>2137.106452</td>
      <td>2100.513333</td>
      <td>2033.274194</td>
      <td>2018.280000</td>
      <td>1954.439344</td>
    </tr>
    <tr>
      <th>중랑구</th>
      <td>1624.843318</td>
      <td>1714.377551</td>
      <td>1948.587963</td>
      <td>1977.856802</td>
      <td>1954.359903</td>
      <td>2076.310256</td>
      <td>2022.888337</td>
      <td>1773.062035</td>
      <td>1717.466667</td>
      <td>1654.116625</td>
      <td>1629.458974</td>
      <td>1566.585608</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.options.display.max_columns = 30
```


```python
월_구별_휘발유_평균가격 = round(df.query("휘발유!=0").pivot_table(index="월", columns="구", values="휘발유", aggfunc="mean"), 2)
월_구별_휘발유_평균가격
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>구</th>
      <th>강남구</th>
      <th>강동구</th>
      <th>강북구</th>
      <th>강서구</th>
      <th>관악구</th>
      <th>광진구</th>
      <th>구로구</th>
      <th>금천구</th>
      <th>노원구</th>
      <th>도봉구</th>
      <th>동대문구</th>
      <th>동작구</th>
      <th>마포구</th>
      <th>서대문구</th>
      <th>서초구</th>
      <th>성동구</th>
      <th>성북구</th>
      <th>송파구</th>
      <th>양천구</th>
      <th>영등포구</th>
      <th>용산구</th>
      <th>은평구</th>
      <th>종로구</th>
      <th>중구</th>
      <th>중랑구</th>
    </tr>
    <tr>
      <th>월</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>1845.04</td>
      <td>1740.22</td>
      <td>1599.38</td>
      <td>1657.35</td>
      <td>1693.37</td>
      <td>1643.83</td>
      <td>1679.96</td>
      <td>1643.85</td>
      <td>1671.23</td>
      <td>1613.96</td>
      <td>1644.44</td>
      <td>1683.45</td>
      <td>1730.17</td>
      <td>1640.01</td>
      <td>1736.54</td>
      <td>1734.80</td>
      <td>1632.61</td>
      <td>1678.79</td>
      <td>1633.02</td>
      <td>1700.58</td>
      <td>2046.39</td>
      <td>1641.13</td>
      <td>1924.91</td>
      <td>2002.51</td>
      <td>1624.84</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1914.71</td>
      <td>1797.40</td>
      <td>1692.99</td>
      <td>1744.52</td>
      <td>1767.61</td>
      <td>1733.17</td>
      <td>1754.28</td>
      <td>1718.96</td>
      <td>1749.08</td>
      <td>1702.60</td>
      <td>1725.77</td>
      <td>1759.79</td>
      <td>1793.30</td>
      <td>1722.96</td>
      <td>1810.23</td>
      <td>1810.23</td>
      <td>1715.84</td>
      <td>1741.30</td>
      <td>1711.94</td>
      <td>1777.38</td>
      <td>2119.34</td>
      <td>1718.21</td>
      <td>1995.06</td>
      <td>2073.92</td>
      <td>1714.38</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2113.53</td>
      <td>2024.73</td>
      <td>1954.91</td>
      <td>1968.37</td>
      <td>1992.62</td>
      <td>1965.27</td>
      <td>2005.56</td>
      <td>1953.56</td>
      <td>1981.65</td>
      <td>1964.16</td>
      <td>1973.45</td>
      <td>1994.85</td>
      <td>2018.03</td>
      <td>1961.00</td>
      <td>2022.52</td>
      <td>2042.38</td>
      <td>1961.17</td>
      <td>1967.73</td>
      <td>1945.77</td>
      <td>2020.53</td>
      <td>2323.99</td>
      <td>1956.02</td>
      <td>2193.61</td>
      <td>2279.66</td>
      <td>1948.59</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2138.08</td>
      <td>2075.56</td>
      <td>1968.94</td>
      <td>1996.16</td>
      <td>2012.60</td>
      <td>1975.05</td>
      <td>2038.36</td>
      <td>1966.77</td>
      <td>2007.24</td>
      <td>1974.97</td>
      <td>1986.57</td>
      <td>2012.12</td>
      <td>2029.15</td>
      <td>1991.92</td>
      <td>2057.17</td>
      <td>2078.88</td>
      <td>1978.13</td>
      <td>2001.12</td>
      <td>1964.69</td>
      <td>2040.61</td>
      <td>2358.30</td>
      <td>1988.99</td>
      <td>2248.84</td>
      <td>2289.25</td>
      <td>1977.86</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2137.11</td>
      <td>2055.98</td>
      <td>1946.04</td>
      <td>1989.01</td>
      <td>1986.18</td>
      <td>1959.89</td>
      <td>2015.15</td>
      <td>1941.69</td>
      <td>2007.70</td>
      <td>1958.48</td>
      <td>1974.71</td>
      <td>1992.06</td>
      <td>2036.11</td>
      <td>1973.36</td>
      <td>2052.73</td>
      <td>2060.63</td>
      <td>1957.71</td>
      <td>1991.34</td>
      <td>1956.67</td>
      <td>2027.46</td>
      <td>2387.13</td>
      <td>1966.93</td>
      <td>2252.17</td>
      <td>2325.95</td>
      <td>1954.36</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2273.51</td>
      <td>2174.08</td>
      <td>2077.16</td>
      <td>2118.27</td>
      <td>2117.29</td>
      <td>2096.48</td>
      <td>2132.77</td>
      <td>2081.94</td>
      <td>2117.35</td>
      <td>2086.65</td>
      <td>2100.45</td>
      <td>2105.01</td>
      <td>2162.42</td>
      <td>2099.05</td>
      <td>2169.57</td>
      <td>2190.38</td>
      <td>2088.65</td>
      <td>2115.77</td>
      <td>2084.83</td>
      <td>2143.57</td>
      <td>2471.29</td>
      <td>2087.96</td>
      <td>2350.65</td>
      <td>2434.63</td>
      <td>2076.31</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2223.27</td>
      <td>2125.90</td>
      <td>1976.94</td>
      <td>2037.92</td>
      <td>2061.85</td>
      <td>2018.15</td>
      <td>2078.69</td>
      <td>1998.35</td>
      <td>2070.65</td>
      <td>2002.05</td>
      <td>2036.37</td>
      <td>2033.61</td>
      <td>2082.37</td>
      <td>2023.47</td>
      <td>2103.18</td>
      <td>2143.46</td>
      <td>2012.29</td>
      <td>2058.98</td>
      <td>2004.27</td>
      <td>2056.82</td>
      <td>2381.95</td>
      <td>2028.06</td>
      <td>2327.39</td>
      <td>2331.20</td>
      <td>2022.89</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2013.87</td>
      <td>1910.25</td>
      <td>1756.04</td>
      <td>1814.66</td>
      <td>1829.48</td>
      <td>1785.53</td>
      <td>1854.95</td>
      <td>1788.94</td>
      <td>1829.00</td>
      <td>1774.89</td>
      <td>1795.30</td>
      <td>1814.77</td>
      <td>1858.82</td>
      <td>1798.13</td>
      <td>1886.70</td>
      <td>1915.36</td>
      <td>1772.32</td>
      <td>1826.30</td>
      <td>1773.62</td>
      <td>1836.01</td>
      <td>2165.80</td>
      <td>1804.53</td>
      <td>2158.13</td>
      <td>2137.11</td>
      <td>1773.06</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1965.88</td>
      <td>1829.52</td>
      <td>1692.45</td>
      <td>1744.27</td>
      <td>1778.40</td>
      <td>1734.72</td>
      <td>1786.94</td>
      <td>1731.79</td>
      <td>1767.56</td>
      <td>1712.80</td>
      <td>1735.96</td>
      <td>1763.07</td>
      <td>1804.10</td>
      <td>1743.46</td>
      <td>1835.89</td>
      <td>1848.38</td>
      <td>1711.79</td>
      <td>1758.67</td>
      <td>1715.98</td>
      <td>1767.26</td>
      <td>2130.39</td>
      <td>1742.32</td>
      <td>2110.46</td>
      <td>2100.51</td>
      <td>1717.47</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1916.99</td>
      <td>1762.18</td>
      <td>1640.52</td>
      <td>1679.47</td>
      <td>1712.71</td>
      <td>1666.22</td>
      <td>1719.79</td>
      <td>1664.61</td>
      <td>1683.49</td>
      <td>1648.63</td>
      <td>1670.43</td>
      <td>1707.28</td>
      <td>1726.24</td>
      <td>1669.51</td>
      <td>1780.30</td>
      <td>1784.70</td>
      <td>1652.31</td>
      <td>1700.65</td>
      <td>1650.25</td>
      <td>1717.36</td>
      <td>2081.33</td>
      <td>1679.39</td>
      <td>2044.69</td>
      <td>2033.27</td>
      <td>1654.12</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1912.33</td>
      <td>1747.87</td>
      <td>1624.19</td>
      <td>1655.59</td>
      <td>1686.05</td>
      <td>1654.04</td>
      <td>1695.27</td>
      <td>1633.45</td>
      <td>1666.34</td>
      <td>1630.92</td>
      <td>1651.07</td>
      <td>1691.89</td>
      <td>1707.26</td>
      <td>1649.05</td>
      <td>1761.29</td>
      <td>1767.44</td>
      <td>1631.58</td>
      <td>1685.22</td>
      <td>1631.16</td>
      <td>1702.60</td>
      <td>2087.52</td>
      <td>1659.42</td>
      <td>2030.67</td>
      <td>2018.28</td>
      <td>1629.46</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1864.61</td>
      <td>1693.76</td>
      <td>1542.56</td>
      <td>1573.27</td>
      <td>1616.75</td>
      <td>1589.91</td>
      <td>1624.07</td>
      <td>1547.23</td>
      <td>1600.13</td>
      <td>1561.89</td>
      <td>1584.76</td>
      <td>1606.23</td>
      <td>1649.51</td>
      <td>1568.75</td>
      <td>1684.10</td>
      <td>1713.22</td>
      <td>1560.07</td>
      <td>1617.55</td>
      <td>1537.57</td>
      <td>1617.95</td>
      <td>2048.38</td>
      <td>1592.55</td>
      <td>1966.54</td>
      <td>1954.44</td>
      <td>1566.59</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 각 구의 월별 평균가격의 변화추이 시각화
##  한개 구(강남구)
월_구별_휘발유_평균가격['강남구'].plot(figsize=(10,4), marker=".");
```


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_55_0.png)
    



```python
월_구별_휘발유_평균가격.plot(figsize=(15, 5));
plt.legend(bbox_to_anchor=(1,1), 
           loc="upper left", 
           ncol=3, title="구")
```




    <matplotlib.legend.Legend at 0x1e121c5e510>


![png](/../../images/2023-10-12-00.Pandas + Matplotlib 실습예제/output_56_1.png)
    



```python
a= df.query('휘발유 != 0').groupby(["상호", "주소"])["휘발유"].max()
a.sort_values(ascending=False)
a.sort_values().head(5)
```




    상호                 주소                       
    (주)동원석유            경기도 부천시 원미구  부흥로 182 (중동)    1654
    송파알찬주유소            서울 송파구 백제고분로 229 (삼전동)       1690
    (주)명보에너지           경기도 시흥시  수인로 2186 (목감동)      1755
    정다운셀프주유소           서울 도봉구 도봉로 635               1759
    오션네트웍스(주) 서울식물원지점  서울 강서구 양천로 300               1940
    Name: 휘발유, dtype: int64




```python
# 가장 휘발유가격이 비싼 주유소 상위 5 - (같은 주유소가 여러개 나오므로 가장 비싼 가격을 기준으로 집계)
#### 주유소별로 제일 비쌀때 가격.
휘발유_비싼_주유소 = df.query('휘발유 != 0').groupby(["상호", "주소"])["휘발유"].max().sort_values(ascending=False)
휘발유_비싼_주유소.head()
```




    상호      주소                     
    서남주유소   서울 중구 통일로 30               3096
    서계주유소   서울 용산구  청파로 367 (청파동)      3050
    필동주유소   서울 중구 퇴계로 196 (필동2가)       2789
    동자동주유소  서울 용산구 한강대로104길 6 (동자동)    2690
    한석주유소   서울 용산구 이촌로 164             2681
    Name: 휘발유, dtype: int64




```python
# 가장 휘발유가격이 저렴한 주유소 상위 5 - (같은 주유소가 여러개 나오므로 가장 비싼 가격을 기준으로 집계)
휘발유_싼_주유소 = df.query('휘발유 != 0').groupby(["상호", "주소"])["휘발유"].max().sort_values()
휘발유_싼_주유소.head()
```




    상호                 주소                       
    (주)동원석유            경기도 부천시 원미구  부흥로 182 (중동)    1654
    송파알찬주유소            서울 송파구 백제고분로 229 (삼전동)       1690
    (주)명보에너지           경기도 시흥시  수인로 2186 (목감동)      1755
    정다운셀프주유소           서울 도봉구 도봉로 635               1759
    오션네트웍스(주) 서울식물원지점  서울 강서구 양천로 300               1940
    Name: 휘발유, dtype: int64




```python
# 휘발유 비싼 주유소의 상위 5개의 상호, 주소, 상표, 셀프여부,  조회 - 위에서 조회한 결과에 추가 정보(상표, 셀프여부 등) 조회 (중복제거-drop_duplicates)
휘발유_비싼_주유소.head()
```




    상호      주소                     
    서남주유소   서울 중구 통일로 30               3096
    서계주유소   서울 용산구  청파로 367 (청파동)      3050
    필동주유소   서울 중구 퇴계로 196 (필동2가)       2789
    동자동주유소  서울 용산구 한강대로104길 6 (동자동)    2690
    한석주유소   서울 용산구 이촌로 164             2681
    Name: 휘발유, dtype: int64




```python
# 휘발유_비싼_주유소.head().index
# 멀티 index에서 index명을 각각 조회.
# 휘발유_비싼_주유소.head().index.get_level_values(0) # level 지정하면 그 level의 index이름들을 묶어서 반환.
휘발유_비싼_주유소.head().index.get_level_values(1)
```




    Index(['서울 중구 통일로 30', '서울 용산구  청파로 367 (청파동)', '서울 중구 퇴계로 196 (필동2가)',
           '서울 용산구 한강대로104길 6 (동자동)', '서울 용산구 이촌로 164'],
          dtype='object', name='주소')




```python
df.query("상호 in @휘발유_비싼_주유소.head().index.get_level_values(0)  and \
          주소 in @휘발유_비싼_주유소.head().index.get_level_values(1)")[["상호", "주소", "상표", "셀프여부"]].drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>상호</th>
      <th>주소</th>
      <th>상표</th>
      <th>셀프여부</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>72190</th>
      <td>동자동주유소</td>
      <td>서울 용산구 한강대로104길 6 (동자동)</td>
      <td>SK에너지</td>
      <td>일반</td>
    </tr>
    <tr>
      <th>72371</th>
      <td>서계주유소</td>
      <td>서울 용산구  청파로 367 (청파동)</td>
      <td>GS칼텍스</td>
      <td>일반</td>
    </tr>
    <tr>
      <th>73095</th>
      <td>한석주유소</td>
      <td>서울 용산구 이촌로 164</td>
      <td>SK에너지</td>
      <td>일반</td>
    </tr>
    <tr>
      <th>78766</th>
      <td>서남주유소</td>
      <td>서울 중구 통일로 30</td>
      <td>SK에너지</td>
      <td>일반</td>
    </tr>
    <tr>
      <th>79846</th>
      <td>필동주유소</td>
      <td>서울 중구 퇴계로 196 (필동2가)</td>
      <td>GS칼텍스</td>
      <td>일반</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 휘발유 저렴한 주유소의 상위 5개의 상호, 주소, 상표, 셀프여부,  조회 - 위에서 조회한 결과에 추가 정보(상표, 셀프여부 등) 조회 (중복제거-drop_duplicates)
df.query("상호 in @휘발유_싼_주유소.head().index.get_level_values(0)  and \
          주소 in @휘발유_싼_주유소.head().index.get_level_values(1)")[["상호", "주소", "상표", "셀프여부"]].drop_duplicates()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>상호</th>
      <th>주소</th>
      <th>상표</th>
      <th>셀프여부</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>25556</th>
      <td>(주)명보에너지</td>
      <td>경기도 시흥시  수인로 2186 (목감동)</td>
      <td>알뜰주유소</td>
      <td>일반</td>
    </tr>
    <tr>
      <th>32304</th>
      <td>정다운셀프주유소</td>
      <td>서울 도봉구 도봉로 635</td>
      <td>SK에너지</td>
      <td>셀프</td>
    </tr>
    <tr>
      <th>43575</th>
      <td>(주)동원석유</td>
      <td>경기도 부천시 원미구  부흥로 182 (중동)</td>
      <td>S-OIL</td>
      <td>셀프</td>
    </tr>
    <tr>
      <th>59953</th>
      <td>송파알찬주유소</td>
      <td>서울 송파구 백제고분로 229 (삼전동)</td>
      <td>S-OIL</td>
      <td>셀프</td>
    </tr>
    <tr>
      <th>97148</th>
      <td>오션네트웍스(주) 서울식물원지점</td>
      <td>서울 강서구 양천로 300</td>
      <td>SK에너지</td>
      <td>셀프</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 고급 휘발유를 가장 많이 파는 구 조회
df.query('고급휘발유 != 0').groupby('구')['고급휘발유'].count().sort_values(ascending=False)
```




    구
    강남구     10784
    서초구      8460
    송파구      6295
    성북구      4727
    용산구      4537
    강서구      4515
    영등포구     4499
    성동구      3719
    양천구      3145
    종로구      2930
    은평구      2910
    중구       2871
    서대문구     2550
    광진구      2519
    노원구      2361
    동작구      1877
    도봉구      1838
    관악구      1822
    마포구      1819
    동대문구     1815
    금천구      1662
    구로구      1598
    강동구      1553
    중랑구      1225
    강북구      1211
    Name: 고급휘발유, dtype: int64




```python
# 고급 휘발유를 가장 많이 파는 구 조회 ==> 실제 주유소가 몇개인지.
df.query('고급휘발유!=0')[["구", "상호", "주소"]].drop_duplicates().groupby("구")['상호'].count().sort_values(ascending=False)
```




    구
    강남구     30
    서초구     26
    송파구     18
    성북구     15
    강서구     13
    용산구     13
    영등포구    13
    성동구     11
    종로구      9
    양천구      9
    은평구      8
    중구       8
    광진구      7
    노원구      7
    서대문구     7
    동작구      6
    강동구      6
    도봉구      6
    마포구      5
    동대문구     5
    금천구      5
    구로구      5
    관악구      5
    강북구      5
    중랑구      4
    Name: 상호, dtype: int64


