# 정렬
## index이름, column 이름을 기준으로 정렬

- <b style='font-size:1.2em'>sort_index(axis, ascending=True)</b>
    - axis
        - index 이름 기준 정렬(행) : 'index' 또는 0 (기본값)
        - column 이름 기준 정렬(열) : 'columns' 또는 1
    - ascending
        - 정렬방식
        - True(기본): 오름차순, False: 내림차순
    - inplace
        - 원본에 적용 여부
        - False(기본): 변경한 복사본 반환 
        - True : 원본을 변경


```python
import pandas as pd

df = pd.read_csv('data/movie.csv', index_col='movie_title')
```


```python
# 오름차순정렬
## 기본 - ascending=True
df.sort_index() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>#Horror</th>
      <td>Color</td>
      <td>Tara Subkoff</td>
      <td>35.0</td>
      <td>101.0</td>
      <td>37.0</td>
      <td>56.0</td>
      <td>Balthazar Getty</td>
      <td>501.0</td>
      <td>NaN</td>
      <td>Drama|Horror|Mystery|Thriller</td>
      <td>...</td>
      <td>42.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Not Rated</td>
      <td>1500000.0</td>
      <td>2015.0</td>
      <td>418.0</td>
      <td>3.3</td>
      <td>NaN</td>
      <td>750</td>
    </tr>
    <tr>
      <th>10 Cloverfield Lane</th>
      <td>Color</td>
      <td>Dan Trachtenberg</td>
      <td>411.0</td>
      <td>104.0</td>
      <td>16.0</td>
      <td>82.0</td>
      <td>John Gallagher Jr.</td>
      <td>14000.0</td>
      <td>71897215.0</td>
      <td>Drama|Horror|Mystery|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>440.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>15000000.0</td>
      <td>2016.0</td>
      <td>338.0</td>
      <td>7.3</td>
      <td>2.35</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>10 Days in a Madhouse</th>
      <td>Color</td>
      <td>Timothy Hines</td>
      <td>1.0</td>
      <td>111.0</td>
      <td>0.0</td>
      <td>247.0</td>
      <td>Kelly LeBrock</td>
      <td>1000.0</td>
      <td>14616.0</td>
      <td>Drama</td>
      <td>...</td>
      <td>10.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>12000000.0</td>
      <td>2015.0</td>
      <td>445.0</td>
      <td>7.5</td>
      <td>1.85</td>
      <td>26000</td>
    </tr>
    <tr>
      <th>10 Things I Hate About You</th>
      <td>Color</td>
      <td>Gil Junger</td>
      <td>133.0</td>
      <td>97.0</td>
      <td>19.0</td>
      <td>835.0</td>
      <td>Heath Ledger</td>
      <td>23000.0</td>
      <td>38176108.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>549.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>16000000.0</td>
      <td>1999.0</td>
      <td>13000.0</td>
      <td>7.2</td>
      <td>1.85</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>10,000 B.C.</th>
      <td>NaN</td>
      <td>Christopher Barnard</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>Comedy</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.2</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>[Rec] 2</th>
      <td>Color</td>
      <td>Jaume Balagueró</td>
      <td>222.0</td>
      <td>85.0</td>
      <td>57.0</td>
      <td>6.0</td>
      <td>Pablo Rosso</td>
      <td>37.0</td>
      <td>27024.0</td>
      <td>Horror</td>
      <td>...</td>
      <td>148.0</td>
      <td>Spanish</td>
      <td>Spain</td>
      <td>R</td>
      <td>5600000.0</td>
      <td>2009.0</td>
      <td>9.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>eXistenZ</th>
      <td>Color</td>
      <td>David Cronenberg</td>
      <td>196.0</td>
      <td>115.0</td>
      <td>0.0</td>
      <td>716.0</td>
      <td>Sarah Polley</td>
      <td>1000.0</td>
      <td>2840417.0</td>
      <td>Horror|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>527.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>R</td>
      <td>31000000.0</td>
      <td>1999.0</td>
      <td>900.0</td>
      <td>6.8</td>
      <td>1.85</td>
      <td>6000</td>
    </tr>
    <tr>
      <th>xXx</th>
      <td>Color</td>
      <td>Rob Cohen</td>
      <td>191.0</td>
      <td>132.0</td>
      <td>357.0</td>
      <td>212.0</td>
      <td>Eve</td>
      <td>14000.0</td>
      <td>141204016.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>737.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>70000000.0</td>
      <td>2002.0</td>
      <td>223.0</td>
      <td>5.8</td>
      <td>2.35</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>xXx: State of the Union</th>
      <td>Color</td>
      <td>Lee Tamahori</td>
      <td>77.0</td>
      <td>101.0</td>
      <td>93.0</td>
      <td>218.0</td>
      <td>Nona Gaye</td>
      <td>287.0</td>
      <td>26082914.0</td>
      <td>Action|Adventure|Crime|Thriller</td>
      <td>...</td>
      <td>213.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>87000000.0</td>
      <td>2005.0</td>
      <td>233.0</td>
      <td>4.3</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Æon Flux</th>
      <td>Color</td>
      <td>Karyn Kusama</td>
      <td>178.0</td>
      <td>93.0</td>
      <td>45.0</td>
      <td>352.0</td>
      <td>Sophie Okonedo</td>
      <td>9000.0</td>
      <td>25857987.0</td>
      <td>Action|Sci-Fi</td>
      <td>...</td>
      <td>532.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>62000000.0</td>
      <td>2005.0</td>
      <td>460.0</td>
      <td>5.5</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 27 columns</p>
</div>




```python
# 내림차순
df.sort_index(ascending=False)  
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Æon Flux</th>
      <td>Color</td>
      <td>Karyn Kusama</td>
      <td>178.0</td>
      <td>93.0</td>
      <td>45.0</td>
      <td>352.0</td>
      <td>Sophie Okonedo</td>
      <td>9000.0</td>
      <td>25857987.0</td>
      <td>Action|Sci-Fi</td>
      <td>...</td>
      <td>532.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>62000000.0</td>
      <td>2005.0</td>
      <td>460.0</td>
      <td>5.5</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>xXx: State of the Union</th>
      <td>Color</td>
      <td>Lee Tamahori</td>
      <td>77.0</td>
      <td>101.0</td>
      <td>93.0</td>
      <td>218.0</td>
      <td>Nona Gaye</td>
      <td>287.0</td>
      <td>26082914.0</td>
      <td>Action|Adventure|Crime|Thriller</td>
      <td>...</td>
      <td>213.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>87000000.0</td>
      <td>2005.0</td>
      <td>233.0</td>
      <td>4.3</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>xXx</th>
      <td>Color</td>
      <td>Rob Cohen</td>
      <td>191.0</td>
      <td>132.0</td>
      <td>357.0</td>
      <td>212.0</td>
      <td>Eve</td>
      <td>14000.0</td>
      <td>141204016.0</td>
      <td>Action|Adventure|Thriller</td>
      <td>...</td>
      <td>737.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>70000000.0</td>
      <td>2002.0</td>
      <td>223.0</td>
      <td>5.8</td>
      <td>2.35</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>eXistenZ</th>
      <td>Color</td>
      <td>David Cronenberg</td>
      <td>196.0</td>
      <td>115.0</td>
      <td>0.0</td>
      <td>716.0</td>
      <td>Sarah Polley</td>
      <td>1000.0</td>
      <td>2840417.0</td>
      <td>Horror|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>527.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>R</td>
      <td>31000000.0</td>
      <td>1999.0</td>
      <td>900.0</td>
      <td>6.8</td>
      <td>1.85</td>
      <td>6000</td>
    </tr>
    <tr>
      <th>[Rec] 2</th>
      <td>Color</td>
      <td>Jaume Balagueró</td>
      <td>222.0</td>
      <td>85.0</td>
      <td>57.0</td>
      <td>6.0</td>
      <td>Pablo Rosso</td>
      <td>37.0</td>
      <td>27024.0</td>
      <td>Horror</td>
      <td>...</td>
      <td>148.0</td>
      <td>Spanish</td>
      <td>Spain</td>
      <td>R</td>
      <td>5600000.0</td>
      <td>2009.0</td>
      <td>9.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>4000</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>10,000 B.C.</th>
      <td>NaN</td>
      <td>Christopher Barnard</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>Comedy</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.2</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>10 Things I Hate About You</th>
      <td>Color</td>
      <td>Gil Junger</td>
      <td>133.0</td>
      <td>97.0</td>
      <td>19.0</td>
      <td>835.0</td>
      <td>Heath Ledger</td>
      <td>23000.0</td>
      <td>38176108.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>549.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>16000000.0</td>
      <td>1999.0</td>
      <td>13000.0</td>
      <td>7.2</td>
      <td>1.85</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>10 Days in a Madhouse</th>
      <td>Color</td>
      <td>Timothy Hines</td>
      <td>1.0</td>
      <td>111.0</td>
      <td>0.0</td>
      <td>247.0</td>
      <td>Kelly LeBrock</td>
      <td>1000.0</td>
      <td>14616.0</td>
      <td>Drama</td>
      <td>...</td>
      <td>10.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>12000000.0</td>
      <td>2015.0</td>
      <td>445.0</td>
      <td>7.5</td>
      <td>1.85</td>
      <td>26000</td>
    </tr>
    <tr>
      <th>10 Cloverfield Lane</th>
      <td>Color</td>
      <td>Dan Trachtenberg</td>
      <td>411.0</td>
      <td>104.0</td>
      <td>16.0</td>
      <td>82.0</td>
      <td>John Gallagher Jr.</td>
      <td>14000.0</td>
      <td>71897215.0</td>
      <td>Drama|Horror|Mystery|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>440.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>15000000.0</td>
      <td>2016.0</td>
      <td>338.0</td>
      <td>7.3</td>
      <td>2.35</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>#Horror</th>
      <td>Color</td>
      <td>Tara Subkoff</td>
      <td>35.0</td>
      <td>101.0</td>
      <td>37.0</td>
      <td>56.0</td>
      <td>Balthazar Getty</td>
      <td>501.0</td>
      <td>NaN</td>
      <td>Drama|Horror|Mystery|Thriller</td>
      <td>...</td>
      <td>42.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Not Rated</td>
      <td>1500000.0</td>
      <td>2015.0</td>
      <td>418.0</td>
      <td>3.3</td>
      <td>NaN</td>
      <td>750</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 27 columns</p>
</div>




```python
# 컬럼이름을 기준으로 정렬
df.sort_index(axis=1)  
# df.sort_index(axis='columns')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>actor_1_facebook_likes</th>
      <th>actor_1_name</th>
      <th>actor_2_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_3_name</th>
      <th>aspect_ratio</th>
      <th>budget</th>
      <th>cast_total_facebook_likes</th>
      <th>color</th>
      <th>...</th>
      <th>gross</th>
      <th>imdb_score</th>
      <th>language</th>
      <th>movie_facebook_likes</th>
      <th>movie_imdb_link</th>
      <th>num_critic_for_reviews</th>
      <th>num_user_for_reviews</th>
      <th>num_voted_users</th>
      <th>plot_keywords</th>
      <th>title_year</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Avatar</th>
      <td>1000.0</td>
      <td>CCH Pounder</td>
      <td>936.0</td>
      <td>Joel David Moore</td>
      <td>855.0</td>
      <td>Wes Studi</td>
      <td>1.78</td>
      <td>237000000.0</td>
      <td>4834</td>
      <td>Color</td>
      <td>...</td>
      <td>760505847.0</td>
      <td>7.9</td>
      <td>English</td>
      <td>33000</td>
      <td>http://www.imdb.com/title/tt0499549/?ref_=fn_t...</td>
      <td>723.0</td>
      <td>3054.0</td>
      <td>886204</td>
      <td>avatar|future|marine|native|paraplegic</td>
      <td>2009.0</td>
    </tr>
    <tr>
      <th>Pirates of the Caribbean: At World's End</th>
      <td>40000.0</td>
      <td>Johnny Depp</td>
      <td>5000.0</td>
      <td>Orlando Bloom</td>
      <td>1000.0</td>
      <td>Jack Davenport</td>
      <td>2.35</td>
      <td>300000000.0</td>
      <td>48350</td>
      <td>Color</td>
      <td>...</td>
      <td>309404152.0</td>
      <td>7.1</td>
      <td>English</td>
      <td>0</td>
      <td>http://www.imdb.com/title/tt0449088/?ref_=fn_t...</td>
      <td>302.0</td>
      <td>1238.0</td>
      <td>471220</td>
      <td>goddess|marriage ceremony|marriage proposal|pi...</td>
      <td>2007.0</td>
    </tr>
    <tr>
      <th>Spectre</th>
      <td>11000.0</td>
      <td>Christoph Waltz</td>
      <td>393.0</td>
      <td>Rory Kinnear</td>
      <td>161.0</td>
      <td>Stephanie Sigman</td>
      <td>2.35</td>
      <td>245000000.0</td>
      <td>11700</td>
      <td>Color</td>
      <td>...</td>
      <td>200074175.0</td>
      <td>6.8</td>
      <td>English</td>
      <td>85000</td>
      <td>http://www.imdb.com/title/tt2379713/?ref_=fn_t...</td>
      <td>602.0</td>
      <td>994.0</td>
      <td>275868</td>
      <td>bomb|espionage|sequel|spy|terrorist</td>
      <td>2015.0</td>
    </tr>
    <tr>
      <th>The Dark Knight Rises</th>
      <td>27000.0</td>
      <td>Tom Hardy</td>
      <td>23000.0</td>
      <td>Christian Bale</td>
      <td>23000.0</td>
      <td>Joseph Gordon-Levitt</td>
      <td>2.35</td>
      <td>250000000.0</td>
      <td>106759</td>
      <td>Color</td>
      <td>...</td>
      <td>448130642.0</td>
      <td>8.5</td>
      <td>English</td>
      <td>164000</td>
      <td>http://www.imdb.com/title/tt1345836/?ref_=fn_t...</td>
      <td>813.0</td>
      <td>2701.0</td>
      <td>1144337</td>
      <td>deception|imprisonment|lawlessness|police offi...</td>
      <td>2012.0</td>
    </tr>
    <tr>
      <th>Star Wars: Episode VII - The Force Awakens</th>
      <td>131.0</td>
      <td>Doug Walker</td>
      <td>12.0</td>
      <td>Rob Walker</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>143</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>7.1</td>
      <td>NaN</td>
      <td>0</td>
      <td>http://www.imdb.com/title/tt5289954/?ref_=fn_t...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>8</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Signed Sealed Delivered</th>
      <td>637.0</td>
      <td>Eric Mabius</td>
      <td>470.0</td>
      <td>Daphne Zuniga</td>
      <td>318.0</td>
      <td>Crystal Lowe</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2283</td>
      <td>Color</td>
      <td>...</td>
      <td>NaN</td>
      <td>7.7</td>
      <td>English</td>
      <td>84</td>
      <td>http://www.imdb.com/title/tt3000844/?ref_=fn_t...</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>629</td>
      <td>fraud|postal worker|prison|theft|trial</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>The Following</th>
      <td>841.0</td>
      <td>Natalie Zea</td>
      <td>593.0</td>
      <td>Valorie Curry</td>
      <td>319.0</td>
      <td>Sam Underwood</td>
      <td>16.00</td>
      <td>NaN</td>
      <td>1753</td>
      <td>Color</td>
      <td>...</td>
      <td>NaN</td>
      <td>7.5</td>
      <td>English</td>
      <td>32000</td>
      <td>http://www.imdb.com/title/tt2071645/?ref_=fn_t...</td>
      <td>43.0</td>
      <td>359.0</td>
      <td>73839</td>
      <td>cult|fbi|hideout|prison escape|serial killer</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>A Plague So Pleasant</th>
      <td>0.0</td>
      <td>Eva Boehnke</td>
      <td>0.0</td>
      <td>Maxwell Moody</td>
      <td>0.0</td>
      <td>David Chandler</td>
      <td>NaN</td>
      <td>1400.0</td>
      <td>0</td>
      <td>Color</td>
      <td>...</td>
      <td>NaN</td>
      <td>6.3</td>
      <td>English</td>
      <td>16</td>
      <td>http://www.imdb.com/title/tt2107644/?ref_=fn_t...</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>38</td>
      <td>NaN</td>
      <td>2013.0</td>
    </tr>
    <tr>
      <th>Shanghai Calling</th>
      <td>946.0</td>
      <td>Alan Ruck</td>
      <td>719.0</td>
      <td>Daniel Henney</td>
      <td>489.0</td>
      <td>Eliza Coupe</td>
      <td>2.35</td>
      <td>NaN</td>
      <td>2386</td>
      <td>Color</td>
      <td>...</td>
      <td>10443.0</td>
      <td>6.3</td>
      <td>English</td>
      <td>660</td>
      <td>http://www.imdb.com/title/tt2070597/?ref_=fn_t...</td>
      <td>14.0</td>
      <td>9.0</td>
      <td>1255</td>
      <td>NaN</td>
      <td>2012.0</td>
    </tr>
    <tr>
      <th>My Date with Drew</th>
      <td>86.0</td>
      <td>John August</td>
      <td>23.0</td>
      <td>Brian Herzlinger</td>
      <td>16.0</td>
      <td>Jon Gunn</td>
      <td>1.85</td>
      <td>1100.0</td>
      <td>163</td>
      <td>Color</td>
      <td>...</td>
      <td>85222.0</td>
      <td>6.6</td>
      <td>English</td>
      <td>456</td>
      <td>http://www.imdb.com/title/tt0378407/?ref_=fn_t...</td>
      <td>43.0</td>
      <td>84.0</td>
      <td>4285</td>
      <td>actress name in title|crush|date|four word tit...</td>
      <td>2004.0</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 27 columns</p>
</div>




```python
df2 = df.sort_index()
```


```python
# index 이름을 정렬하고 나면 `~ 시작하는 이름`으로 조회가능.
## A로 시작하는 이름 ~ C로 시작하는 이름전까지.
df2.loc['A':'C'] # end는 포함안됨. 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A Beautiful Mind</th>
      <td>Color</td>
      <td>Ron Howard</td>
      <td>205.0</td>
      <td>135.0</td>
      <td>2000.0</td>
      <td>535.0</td>
      <td>Austin Pendleton</td>
      <td>1000.0</td>
      <td>170708996.0</td>
      <td>Biography|Drama</td>
      <td>...</td>
      <td>1171.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>58000000.0</td>
      <td>2001.0</td>
      <td>592.0</td>
      <td>8.2</td>
      <td>1.85</td>
      <td>29000</td>
    </tr>
    <tr>
      <th>A Beginner's Guide to Snuff</th>
      <td>Color</td>
      <td>Mitchell Altieri</td>
      <td>NaN</td>
      <td>87.0</td>
      <td>9.0</td>
      <td>165.0</td>
      <td>Luke Edwards</td>
      <td>467.0</td>
      <td>NaN</td>
      <td>Comedy|Horror|Thriller</td>
      <td>...</td>
      <td>NaN</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>258.0</td>
      <td>8.7</td>
      <td>NaN</td>
      <td>8</td>
    </tr>
    <tr>
      <th>A Better Life</th>
      <td>Color</td>
      <td>Chris Weitz</td>
      <td>94.0</td>
      <td>98.0</td>
      <td>129.0</td>
      <td>221.0</td>
      <td>Eddie 'Piolin' Sotelo</td>
      <td>749.0</td>
      <td>1754319.0</td>
      <td>Drama|Romance</td>
      <td>...</td>
      <td>81.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>10000000.0</td>
      <td>2011.0</td>
      <td>252.0</td>
      <td>7.2</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A Bridge Too Far</th>
      <td>Black and White</td>
      <td>Richard Attenborough</td>
      <td>56.0</td>
      <td>175.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>Dirk Bogarde</td>
      <td>385.0</td>
      <td>50800000.0</td>
      <td>Drama|History|War</td>
      <td>...</td>
      <td>210.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>26000000.0</td>
      <td>1977.0</td>
      <td>232.0</td>
      <td>7.4</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A Bug's Life</th>
      <td>Color</td>
      <td>John Lasseter</td>
      <td>117.0</td>
      <td>95.0</td>
      <td>487.0</td>
      <td>1000.0</td>
      <td>Madeline Kahn</td>
      <td>18000.0</td>
      <td>162792677.0</td>
      <td>Adventure|Animation|Comedy|Family|Fantasy</td>
      <td>...</td>
      <td>317.0</td>
      <td>English</td>
      <td>USA</td>
      <td>G</td>
      <td>120000000.0</td>
      <td>1998.0</td>
      <td>1000.0</td>
      <td>7.2</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>But I'm a Cheerleader</th>
      <td>Color</td>
      <td>Jamie Babbit</td>
      <td>99.0</td>
      <td>85.0</td>
      <td>91.0</td>
      <td>849.0</td>
      <td>Clea DuVall</td>
      <td>1000.0</td>
      <td>2199853.0</td>
      <td>Comedy|Drama</td>
      <td>...</td>
      <td>186.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>1200000.0</td>
      <td>1999.0</td>
      <td>1000.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Butch Cassidy and the Sundance Kid</th>
      <td>Color</td>
      <td>George Roy Hill</td>
      <td>130.0</td>
      <td>110.0</td>
      <td>131.0</td>
      <td>399.0</td>
      <td>Ted Cassidy</td>
      <td>640.0</td>
      <td>102308900.0</td>
      <td>Biography|Crime|Drama|Western</td>
      <td>...</td>
      <td>309.0</td>
      <td>English</td>
      <td>USA</td>
      <td>M</td>
      <td>6000000.0</td>
      <td>1969.0</td>
      <td>566.0</td>
      <td>8.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Butterfly</th>
      <td>Color</td>
      <td>Matt Cimber</td>
      <td>15.0</td>
      <td>108.0</td>
      <td>32.0</td>
      <td>180.0</td>
      <td>June Lockhart</td>
      <td>602.0</td>
      <td>NaN</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>18.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>NaN</td>
      <td>1982.0</td>
      <td>427.0</td>
      <td>4.5</td>
      <td>1.85</td>
      <td>76</td>
    </tr>
    <tr>
      <th>Butterfly Girl</th>
      <td>Color</td>
      <td>Cary Bell</td>
      <td>NaN</td>
      <td>78.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>Stacie Evans</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>Documentary</td>
      <td>...</td>
      <td>1.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>180000.0</td>
      <td>2014.0</td>
      <td>0.0</td>
      <td>8.7</td>
      <td>NaN</td>
      <td>88</td>
    </tr>
    <tr>
      <th>By the Sea</th>
      <td>Color</td>
      <td>Angelina Jolie Pitt</td>
      <td>131.0</td>
      <td>122.0</td>
      <td>11000.0</td>
      <td>188.0</td>
      <td>Angelina Jolie Pitt</td>
      <td>11000.0</td>
      <td>531009.0</td>
      <td>Drama|Romance</td>
      <td>...</td>
      <td>61.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>10000000.0</td>
      <td>2015.0</td>
      <td>11000.0</td>
      <td>5.3</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>600 rows × 27 columns</p>
</div>




```python
# A로 시작하는 영화들만 조회
## 먼저 정렬을 한후에 조회 가능
df.sort_index().loc['A':'B'] 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A Beautiful Mind</th>
      <td>Color</td>
      <td>Ron Howard</td>
      <td>205.0</td>
      <td>135.0</td>
      <td>2000.0</td>
      <td>535.0</td>
      <td>Austin Pendleton</td>
      <td>1000.0</td>
      <td>170708996.0</td>
      <td>Biography|Drama</td>
      <td>...</td>
      <td>1171.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>58000000.0</td>
      <td>2001.0</td>
      <td>592.0</td>
      <td>8.2</td>
      <td>1.85</td>
      <td>29000</td>
    </tr>
    <tr>
      <th>A Beginner's Guide to Snuff</th>
      <td>Color</td>
      <td>Mitchell Altieri</td>
      <td>NaN</td>
      <td>87.0</td>
      <td>9.0</td>
      <td>165.0</td>
      <td>Luke Edwards</td>
      <td>467.0</td>
      <td>NaN</td>
      <td>Comedy|Horror|Thriller</td>
      <td>...</td>
      <td>NaN</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>258.0</td>
      <td>8.7</td>
      <td>NaN</td>
      <td>8</td>
    </tr>
    <tr>
      <th>A Better Life</th>
      <td>Color</td>
      <td>Chris Weitz</td>
      <td>94.0</td>
      <td>98.0</td>
      <td>129.0</td>
      <td>221.0</td>
      <td>Eddie 'Piolin' Sotelo</td>
      <td>749.0</td>
      <td>1754319.0</td>
      <td>Drama|Romance</td>
      <td>...</td>
      <td>81.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>10000000.0</td>
      <td>2011.0</td>
      <td>252.0</td>
      <td>7.2</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A Bridge Too Far</th>
      <td>Black and White</td>
      <td>Richard Attenborough</td>
      <td>56.0</td>
      <td>175.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>Dirk Bogarde</td>
      <td>385.0</td>
      <td>50800000.0</td>
      <td>Drama|History|War</td>
      <td>...</td>
      <td>210.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>26000000.0</td>
      <td>1977.0</td>
      <td>232.0</td>
      <td>7.4</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A Bug's Life</th>
      <td>Color</td>
      <td>John Lasseter</td>
      <td>117.0</td>
      <td>95.0</td>
      <td>487.0</td>
      <td>1000.0</td>
      <td>Madeline Kahn</td>
      <td>18000.0</td>
      <td>162792677.0</td>
      <td>Adventure|Animation|Comedy|Family|Fantasy</td>
      <td>...</td>
      <td>317.0</td>
      <td>English</td>
      <td>USA</td>
      <td>G</td>
      <td>120000000.0</td>
      <td>1998.0</td>
      <td>1000.0</td>
      <td>7.2</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Avatar</th>
      <td>Color</td>
      <td>James Cameron</td>
      <td>723.0</td>
      <td>178.0</td>
      <td>0.0</td>
      <td>855.0</td>
      <td>Joel David Moore</td>
      <td>1000.0</td>
      <td>760505847.0</td>
      <td>Action|Adventure|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>3054.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>237000000.0</td>
      <td>2009.0</td>
      <td>936.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>33000</td>
    </tr>
    <tr>
      <th>Avengers: Age of Ultron</th>
      <td>Color</td>
      <td>Joss Whedon</td>
      <td>635.0</td>
      <td>141.0</td>
      <td>0.0</td>
      <td>19000.0</td>
      <td>Robert Downey Jr.</td>
      <td>26000.0</td>
      <td>458991599.0</td>
      <td>Action|Adventure|Sci-Fi</td>
      <td>...</td>
      <td>1117.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>250000000.0</td>
      <td>2015.0</td>
      <td>21000.0</td>
      <td>7.5</td>
      <td>2.35</td>
      <td>118000</td>
    </tr>
    <tr>
      <th>Awake</th>
      <td>Color</td>
      <td>Joby Harold</td>
      <td>133.0</td>
      <td>84.0</td>
      <td>8.0</td>
      <td>896.0</td>
      <td>Fisher Stevens</td>
      <td>4000.0</td>
      <td>14373825.0</td>
      <td>Crime|Mystery|Thriller</td>
      <td>...</td>
      <td>196.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>8600000.0</td>
      <td>2007.0</td>
      <td>922.0</td>
      <td>6.5</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Away We Go</th>
      <td>Color</td>
      <td>Sam Mendes</td>
      <td>217.0</td>
      <td>98.0</td>
      <td>0.0</td>
      <td>374.0</td>
      <td>Jim Gaffigan</td>
      <td>925.0</td>
      <td>9430988.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>115.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>17000000.0</td>
      <td>2009.0</td>
      <td>472.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>7000</td>
    </tr>
    <tr>
      <th>Ayurveda: Art of Being</th>
      <td>Color</td>
      <td>Pan Nalin</td>
      <td>15.0</td>
      <td>102.0</td>
      <td>95.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>16892.0</td>
      <td>Documentary</td>
      <td>...</td>
      <td>12.0</td>
      <td>English</td>
      <td>India</td>
      <td>NaN</td>
      <td>300000.0</td>
      <td>2001.0</td>
      <td>NaN</td>
      <td>7.6</td>
      <td>1.85</td>
      <td>379</td>
    </tr>
  </tbody>
</table>
<p>319 rows × 27 columns</p>
</div>



## 특정 컬럼(열)의 값을 기준으로 정렬
- <b style='font-size:1.2em'>sort_values(by, ascending, inplace)</b>
    - by
        - **정렬 기준 컬럼이름**을 문자열로 지정
        - 여러 컬럼에 대해 정렬할 경우 리스트에 담아 전달
    - ascending
        - 정렬방식
        - True(기본): 오름차순, False: 내림차순
        - 여러 컬럼에 대해 정렬할 경우 정렬방식도 리스트에 담아 전달
    - inplace
        - 원본에 적용 여부
        - False(기본): 변경한 복사본 반환 
        - True : 원본을 변경
    - 결측치는 방식과 상관없이 마지막에 나온다.


```python
# 문자열 정렬기준
# 특수문자 -> 숫자 -> 영문대문자 -> 영문소문자 -> 다국어문자
#  'A'  "a" , "가"
```


```python
# 행정렬. 정렬기준은 컬럼의 값
## director_name을 기준으로 오름차순 행정렬.
df.sort_values(by="director_name")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>The Helix... Loaded</th>
      <td>Color</td>
      <td>A. Raven Cruz</td>
      <td>3.0</td>
      <td>97.0</td>
      <td>0.0</td>
      <td>94.0</td>
      <td>Vanilla Ice</td>
      <td>639.0</td>
      <td>NaN</td>
      <td>Action|Adventure|Comedy|Fantasy|Sci-Fi</td>
      <td>...</td>
      <td>9.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>1000000.0</td>
      <td>2005.0</td>
      <td>361.0</td>
      <td>1.9</td>
      <td>1.78</td>
      <td>128</td>
    </tr>
    <tr>
      <th>Circle</th>
      <td>Color</td>
      <td>Aaron Hann</td>
      <td>29.0</td>
      <td>87.0</td>
      <td>0.0</td>
      <td>94.0</td>
      <td>Michael McLafferty</td>
      <td>160.0</td>
      <td>NaN</td>
      <td>Drama|Horror|Mystery|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>59.0</td>
      <td>English</td>
      <td>USA</td>
      <td>Not Rated</td>
      <td>NaN</td>
      <td>2015.0</td>
      <td>152.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Get Low</th>
      <td>Color</td>
      <td>Aaron Schneider</td>
      <td>160.0</td>
      <td>100.0</td>
      <td>11.0</td>
      <td>970.0</td>
      <td>Robert Duvall</td>
      <td>13000.0</td>
      <td>9176553.0</td>
      <td>Drama|Mystery</td>
      <td>...</td>
      <td>97.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>7500000.0</td>
      <td>2009.0</td>
      <td>3000.0</td>
      <td>7.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Date Movie</th>
      <td>Color</td>
      <td>Aaron Seltzer</td>
      <td>99.0</td>
      <td>85.0</td>
      <td>64.0</td>
      <td>729.0</td>
      <td>Carmen Electra</td>
      <td>3000.0</td>
      <td>48546578.0</td>
      <td>Comedy|Romance</td>
      <td>...</td>
      <td>613.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>20000000.0</td>
      <td>2006.0</td>
      <td>869.0</td>
      <td>2.7</td>
      <td>1.85</td>
      <td>806</td>
    </tr>
    <tr>
      <th>The Funeral</th>
      <td>Color</td>
      <td>Abel Ferrara</td>
      <td>48.0</td>
      <td>99.0</td>
      <td>220.0</td>
      <td>599.0</td>
      <td>Vincent Gallo</td>
      <td>812.0</td>
      <td>1227324.0</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>48.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>12500000.0</td>
      <td>1996.0</td>
      <td>787.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>344</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Heroes</th>
      <td>Color</td>
      <td>NaN</td>
      <td>75.0</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>833.0</td>
      <td>Masi Oka</td>
      <td>1000.0</td>
      <td>NaN</td>
      <td>Drama|Fantasy|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>379.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>923.0</td>
      <td>7.7</td>
      <td>16.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Home Movies</th>
      <td>Color</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>Ron Lynch</td>
      <td>59.0</td>
      <td>NaN</td>
      <td>Animation|Comedy|Drama</td>
      <td>...</td>
      <td>82.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-PG</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>8.2</td>
      <td>1.33</td>
      <td>526</td>
    </tr>
    <tr>
      <th>Revolution</th>
      <td>Color</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>576.0</td>
      <td>Tracy Spiridakos</td>
      <td>2000.0</td>
      <td>NaN</td>
      <td>Action|Adventure|Drama|Sci-Fi</td>
      <td>...</td>
      <td>323.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>821.0</td>
      <td>6.7</td>
      <td>16.00</td>
      <td>17000</td>
    </tr>
    <tr>
      <th>Happy Valley</th>
      <td>Color</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>58.0</td>
      <td>NaN</td>
      <td>250.0</td>
      <td>James Norton</td>
      <td>887.0</td>
      <td>NaN</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>59.0</td>
      <td>English</td>
      <td>UK</td>
      <td>TV-MA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>340.0</td>
      <td>8.5</td>
      <td>16.00</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>The Following</th>
      <td>Color</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
      <td>Valorie Curry</td>
      <td>841.0</td>
      <td>NaN</td>
      <td>Crime|Drama|Mystery|Thriller</td>
      <td>...</td>
      <td>359.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>593.0</td>
      <td>7.5</td>
      <td>16.00</td>
      <td>32000</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 27 columns</p>
</div>




```python
df.sort_values(by="director_name", ascending=False)  #내림차순
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Bizarre</th>
      <td>Color</td>
      <td>Étienne Faure</td>
      <td>9.0</td>
      <td>98.0</td>
      <td>77.0</td>
      <td>0.0</td>
      <td>Pierre Prieur</td>
      <td>19.0</td>
      <td>NaN</td>
      <td>Drama|Musical|Romance</td>
      <td>...</td>
      <td>1.0</td>
      <td>English</td>
      <td>France</td>
      <td>Unrated</td>
      <td>500000.0</td>
      <td>2015.0</td>
      <td>0.0</td>
      <td>4.3</td>
      <td>1.78</td>
      <td>114</td>
    </tr>
    <tr>
      <th>Sur le seuil</th>
      <td>Color</td>
      <td>Éric Tessier</td>
      <td>9.0</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>6.0</td>
      <td>Michel Côté</td>
      <td>50.0</td>
      <td>NaN</td>
      <td>Action|Drama|Horror|Thriller</td>
      <td>...</td>
      <td>5.0</td>
      <td>French</td>
      <td>Canada</td>
      <td>NaN</td>
      <td>3200000.0</td>
      <td>2003.0</td>
      <td>16.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>39</td>
    </tr>
    <tr>
      <th>Mambo Italiano</th>
      <td>Color</td>
      <td>Émile Gaudreault</td>
      <td>67.0</td>
      <td>92.0</td>
      <td>9.0</td>
      <td>71.0</td>
      <td>Luke Kirby</td>
      <td>636.0</td>
      <td>6239558.0</td>
      <td>Comedy|Drama</td>
      <td>...</td>
      <td>67.0</td>
      <td>English</td>
      <td>Canada</td>
      <td>R</td>
      <td>5000000.0</td>
      <td>2003.0</td>
      <td>210.0</td>
      <td>6.7</td>
      <td>1.85</td>
      <td>352</td>
    </tr>
    <tr>
      <th>The Oxford Murders</th>
      <td>Color</td>
      <td>Álex de la Iglesia</td>
      <td>71.0</td>
      <td>104.0</td>
      <td>275.0</td>
      <td>102.0</td>
      <td>Leonor Watling</td>
      <td>439.0</td>
      <td>3607.0</td>
      <td>Crime|Mystery|Thriller</td>
      <td>...</td>
      <td>94.0</td>
      <td>English</td>
      <td>Spain</td>
      <td>R</td>
      <td>10000000.0</td>
      <td>2008.0</td>
      <td>161.0</td>
      <td>6.1</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Along the Roadside</th>
      <td>Color</td>
      <td>Zoran Lisinac</td>
      <td>17.0</td>
      <td>108.0</td>
      <td>0.0</td>
      <td>142.0</td>
      <td>Brock Baker</td>
      <td>431.0</td>
      <td>NaN</td>
      <td>Comedy|Music|Romance</td>
      <td>...</td>
      <td>2.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>250000.0</td>
      <td>2013.0</td>
      <td>297.0</td>
      <td>7.1</td>
      <td>1.85</td>
      <td>231</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Heroes</th>
      <td>Color</td>
      <td>NaN</td>
      <td>75.0</td>
      <td>60.0</td>
      <td>NaN</td>
      <td>833.0</td>
      <td>Masi Oka</td>
      <td>1000.0</td>
      <td>NaN</td>
      <td>Drama|Fantasy|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>379.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>923.0</td>
      <td>7.7</td>
      <td>16.00</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Home Movies</th>
      <td>Color</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>6.0</td>
      <td>Ron Lynch</td>
      <td>59.0</td>
      <td>NaN</td>
      <td>Animation|Comedy|Drama</td>
      <td>...</td>
      <td>82.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-PG</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>8.2</td>
      <td>1.33</td>
      <td>526</td>
    </tr>
    <tr>
      <th>Revolution</th>
      <td>Color</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>576.0</td>
      <td>Tracy Spiridakos</td>
      <td>2000.0</td>
      <td>NaN</td>
      <td>Action|Adventure|Drama|Sci-Fi</td>
      <td>...</td>
      <td>323.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>821.0</td>
      <td>6.7</td>
      <td>16.00</td>
      <td>17000</td>
    </tr>
    <tr>
      <th>Happy Valley</th>
      <td>Color</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>58.0</td>
      <td>NaN</td>
      <td>250.0</td>
      <td>James Norton</td>
      <td>887.0</td>
      <td>NaN</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>59.0</td>
      <td>English</td>
      <td>UK</td>
      <td>TV-MA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>340.0</td>
      <td>8.5</td>
      <td>16.00</td>
      <td>10000</td>
    </tr>
    <tr>
      <th>The Following</th>
      <td>Color</td>
      <td>NaN</td>
      <td>43.0</td>
      <td>43.0</td>
      <td>NaN</td>
      <td>319.0</td>
      <td>Valorie Curry</td>
      <td>841.0</td>
      <td>NaN</td>
      <td>Crime|Drama|Mystery|Thriller</td>
      <td>...</td>
      <td>359.0</td>
      <td>English</td>
      <td>USA</td>
      <td>TV-14</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>593.0</td>
      <td>7.5</td>
      <td>16.00</td>
      <td>32000</td>
    </tr>
  </tbody>
</table>
<p>4916 rows × 27 columns</p>
</div>




```python
df.sort_values(['duration', 'imdb_score'])[['duration', 'imdb_score']].head(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration</th>
      <th>imdb_score</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>The Touch</th>
      <td>7.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>Shaun the Sheep</th>
      <td>7.0</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>Robot Chicken</th>
      <td>11.0</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>Vessel</th>
      <td>14.0</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>Wal-Mart: The High Cost of Low Price</th>
      <td>20.0</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>Sabrina, the Teenage Witch</th>
      <td>22.0</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>Anger Management</th>
      <td>22.0</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>10,000 B.C.</th>
      <td>22.0</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>Rules of Engagement</th>
      <td>22.0</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>Strangers with Candy</th>
      <td>22.0</td>
      <td>8.1</td>
    </tr>
    <tr>
      <th>Home Movies</th>
      <td>22.0</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>It's Always Sunny in Philadelphia</th>
      <td>22.0</td>
      <td>8.8</td>
    </tr>
    <tr>
      <th>Sonny with a Chance</th>
      <td>23.0</td>
      <td>6.1</td>
    </tr>
    <tr>
      <th>Star Wars: The Clone Wars</th>
      <td>23.0</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>Yu-Gi-Oh! Duel Monsters</th>
      <td>24.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Lovesick</th>
      <td>24.0</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>Bewitched</th>
      <td>25.0</td>
      <td>7.6</td>
    </tr>
    <tr>
      <th>The Inbetweeners</th>
      <td>25.0</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>M*A*S*H</th>
      <td>25.0</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>A Charlie Brown Christmas</th>
      <td>25.0</td>
      <td>8.4</td>
    </tr>
  </tbody>
</table>
</div>




```python
# duration: True-오름차순,  imdb_score: False-내림
df.sort_values(['duration', 'imdb_score'], ascending=[True, False]) \
[['duration', 'imdb_score']].head(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>duration</th>
      <th>imdb_score</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Shaun the Sheep</th>
      <td>7.0</td>
      <td>8.3</td>
    </tr>
    <tr>
      <th>The Touch</th>
      <td>7.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>Robot Chicken</th>
      <td>11.0</td>
      <td>7.8</td>
    </tr>
    <tr>
      <th>Vessel</th>
      <td>14.0</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>Wal-Mart: The High Cost of Low Price</th>
      <td>20.0</td>
      <td>6.8</td>
    </tr>
    <tr>
      <th>It's Always Sunny in Philadelphia</th>
      <td>22.0</td>
      <td>8.8</td>
    </tr>
    <tr>
      <th>Home Movies</th>
      <td>22.0</td>
      <td>8.2</td>
    </tr>
    <tr>
      <th>Strangers with Candy</th>
      <td>22.0</td>
      <td>8.1</td>
    </tr>
    <tr>
      <th>Rules of Engagement</th>
      <td>22.0</td>
      <td>7.3</td>
    </tr>
    <tr>
      <th>10,000 B.C.</th>
      <td>22.0</td>
      <td>7.2</td>
    </tr>
    <tr>
      <th>Anger Management</th>
      <td>22.0</td>
      <td>6.7</td>
    </tr>
    <tr>
      <th>Sabrina, the Teenage Witch</th>
      <td>22.0</td>
      <td>6.6</td>
    </tr>
    <tr>
      <th>Star Wars: The Clone Wars</th>
      <td>23.0</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>Sonny with a Chance</th>
      <td>23.0</td>
      <td>6.1</td>
    </tr>
    <tr>
      <th>Lovesick</th>
      <td>24.0</td>
      <td>7.9</td>
    </tr>
    <tr>
      <th>Yu-Gi-Oh! Duel Monsters</th>
      <td>24.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>The Inbetweeners</th>
      <td>25.0</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>M*A*S*H</th>
      <td>25.0</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>A Charlie Brown Christmas</th>
      <td>25.0</td>
      <td>8.4</td>
    </tr>
    <tr>
      <th>Bewitched</th>
      <td>25.0</td>
      <td>7.6</td>
    </tr>
  </tbody>
</table>
</div>




```python
# df 처리한 결과에대해서 정렬
result = df.query('duration > 250').sort_values("duration")

result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Cleopatra</th>
      <td>Color</td>
      <td>Joseph L. Mankiewicz</td>
      <td>72.0</td>
      <td>251.0</td>
      <td>311.0</td>
      <td>595.0</td>
      <td>Richard Burton</td>
      <td>940.0</td>
      <td>57750000.0</td>
      <td>Biography|Drama|History|Romance</td>
      <td>...</td>
      <td>192.0</td>
      <td>English</td>
      <td>UK</td>
      <td>Approved</td>
      <td>31115000.0</td>
      <td>1963.0</td>
      <td>726.0</td>
      <td>7.0</td>
      <td>2.20</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Once Upon a Time in America</th>
      <td>Color</td>
      <td>Sergio Leone</td>
      <td>111.0</td>
      <td>251.0</td>
      <td>0.0</td>
      <td>642.0</td>
      <td>Burt Young</td>
      <td>22000.0</td>
      <td>5300000.0</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>495.0</td>
      <td>English</td>
      <td>Italy</td>
      <td>R</td>
      <td>30000000.0</td>
      <td>1984.0</td>
      <td>683.0</td>
      <td>8.4</td>
      <td>1.85</td>
      <td>12000</td>
    </tr>
    <tr>
      <th>Arn: The Knight Templar</th>
      <td>Color</td>
      <td>Peter Flinth</td>
      <td>34.0</td>
      <td>270.0</td>
      <td>5.0</td>
      <td>292.0</td>
      <td>Michael Nyqvist</td>
      <td>908.0</td>
      <td>NaN</td>
      <td>Action|Adventure|Drama|Romance|War</td>
      <td>...</td>
      <td>54.0</td>
      <td>Swedish</td>
      <td>Sweden</td>
      <td>NaN</td>
      <td>25000000.0</td>
      <td>2007.0</td>
      <td>690.0</td>
      <td>6.6</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Gettysburg</th>
      <td>Color</td>
      <td>Ron Maxwell</td>
      <td>22.0</td>
      <td>271.0</td>
      <td>33.0</td>
      <td>251.0</td>
      <td>William Morgan Sheppard</td>
      <td>854.0</td>
      <td>10769960.0</td>
      <td>Drama|History|War</td>
      <td>...</td>
      <td>256.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>25000000.0</td>
      <td>1993.0</td>
      <td>702.0</td>
      <td>7.7</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Gods and Generals</th>
      <td>Color</td>
      <td>Ron Maxwell</td>
      <td>84.0</td>
      <td>280.0</td>
      <td>33.0</td>
      <td>67.0</td>
      <td>Bruce Boxleitner</td>
      <td>789.0</td>
      <td>12870569.0</td>
      <td>Drama|History|War</td>
      <td>...</td>
      <td>497.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>56000000.0</td>
      <td>2003.0</td>
      <td>640.0</td>
      <td>6.3</td>
      <td>2.35</td>
      <td>953</td>
    </tr>
    <tr>
      <th>The Company</th>
      <td>Color</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>286.0</td>
      <td>NaN</td>
      <td>527.0</td>
      <td>Tom Hollander</td>
      <td>857.0</td>
      <td>NaN</td>
      <td>Drama|History|Thriller</td>
      <td>...</td>
      <td>39.0</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>555.0</td>
      <td>7.9</td>
      <td>1.78</td>
      <td>733</td>
    </tr>
    <tr>
      <th>Apocalypse Now</th>
      <td>Color</td>
      <td>Francis Ford Coppola</td>
      <td>261.0</td>
      <td>289.0</td>
      <td>0.0</td>
      <td>3000.0</td>
      <td>Marlon Brando</td>
      <td>11000.0</td>
      <td>78800000.0</td>
      <td>Drama|War</td>
      <td>...</td>
      <td>983.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>31500000.0</td>
      <td>1979.0</td>
      <td>10000.0</td>
      <td>8.5</td>
      <td>2.35</td>
      <td>19000</td>
    </tr>
    <tr>
      <th>Das Boot</th>
      <td>Color</td>
      <td>Wolfgang Petersen</td>
      <td>96.0</td>
      <td>293.0</td>
      <td>249.0</td>
      <td>18.0</td>
      <td>Martin Semmelrogge</td>
      <td>362.0</td>
      <td>11433134.0</td>
      <td>Adventure|Drama|Thriller|War</td>
      <td>...</td>
      <td>426.0</td>
      <td>German</td>
      <td>West Germany</td>
      <td>R</td>
      <td>14000000.0</td>
      <td>1981.0</td>
      <td>21.0</td>
      <td>8.4</td>
      <td>1.85</td>
      <td>11000</td>
    </tr>
    <tr>
      <th>The Legend of Suriyothai</th>
      <td>Color</td>
      <td>Chatrichalerm Yukol</td>
      <td>31.0</td>
      <td>300.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>Chatchai Plengpanich</td>
      <td>7.0</td>
      <td>454255.0</td>
      <td>Action|Adventure|Drama|History|War</td>
      <td>...</td>
      <td>47.0</td>
      <td>Thai</td>
      <td>Thailand</td>
      <td>R</td>
      <td>400000000.0</td>
      <td>2001.0</td>
      <td>6.0</td>
      <td>6.6</td>
      <td>1.85</td>
      <td>124</td>
    </tr>
    <tr>
      <th>Heaven's Gate</th>
      <td>Color</td>
      <td>Michael Cimino</td>
      <td>102.0</td>
      <td>325.0</td>
      <td>517.0</td>
      <td>678.0</td>
      <td>Sam Waterston</td>
      <td>12000.0</td>
      <td>1500000.0</td>
      <td>Adventure|Drama|Western</td>
      <td>...</td>
      <td>189.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>44000000.0</td>
      <td>1980.0</td>
      <td>849.0</td>
      <td>6.8</td>
      <td>2.35</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>Blood In, Blood Out</th>
      <td>Color</td>
      <td>Taylor Hackford</td>
      <td>12.0</td>
      <td>330.0</td>
      <td>138.0</td>
      <td>672.0</td>
      <td>Jesse Borrego</td>
      <td>848.0</td>
      <td>4496583.0</td>
      <td>Crime|Drama</td>
      <td>...</td>
      <td>129.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>35000000.0</td>
      <td>1993.0</td>
      <td>674.0</td>
      <td>8.0</td>
      <td>1.66</td>
      <td>6000</td>
    </tr>
    <tr>
      <th>Carlos</th>
      <td>Color</td>
      <td>NaN</td>
      <td>108.0</td>
      <td>334.0</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>Nora von Waldstätten</td>
      <td>897.0</td>
      <td>145118.0</td>
      <td>Biography|Crime|Drama|Thriller</td>
      <td>...</td>
      <td>36.0</td>
      <td>English</td>
      <td>France</td>
      <td>Not Rated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>7.7</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Trapped</th>
      <td>Color</td>
      <td>NaN</td>
      <td>16.0</td>
      <td>511.0</td>
      <td>NaN</td>
      <td>51.0</td>
      <td>Ingvar Eggert Sigurðsson</td>
      <td>147.0</td>
      <td>NaN</td>
      <td>Crime|Drama|Thriller</td>
      <td>...</td>
      <td>19.0</td>
      <td>Icelandic</td>
      <td>Iceland</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>63.0</td>
      <td>8.2</td>
      <td>16.00</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>13 rows × 27 columns</p>
</div>




```python
df['color'].value_counts().sort_index()
# df['color'].value_counts().sort_values()
```




    color
    Black and White     204
    Color              4693
    Name: count, dtype: int64




```python
import pandas as pd
a = pd.read_csv('data/movie.csv')
```


```python
a.set_index('movie_title').sort_index().loc['A':'D']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>director_name</th>
      <th>num_critic_for_reviews</th>
      <th>duration</th>
      <th>director_facebook_likes</th>
      <th>actor_3_facebook_likes</th>
      <th>actor_2_name</th>
      <th>actor_1_facebook_likes</th>
      <th>gross</th>
      <th>genres</th>
      <th>...</th>
      <th>num_user_for_reviews</th>
      <th>language</th>
      <th>country</th>
      <th>content_rating</th>
      <th>budget</th>
      <th>title_year</th>
      <th>actor_2_facebook_likes</th>
      <th>imdb_score</th>
      <th>aspect_ratio</th>
      <th>movie_facebook_likes</th>
    </tr>
    <tr>
      <th>movie_title</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A Beautiful Mind</th>
      <td>Color</td>
      <td>Ron Howard</td>
      <td>205.0</td>
      <td>135.0</td>
      <td>2000.0</td>
      <td>535.0</td>
      <td>Austin Pendleton</td>
      <td>1000.0</td>
      <td>170708996.0</td>
      <td>Biography|Drama</td>
      <td>...</td>
      <td>1171.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>58000000.0</td>
      <td>2001.0</td>
      <td>592.0</td>
      <td>8.2</td>
      <td>1.85</td>
      <td>29000</td>
    </tr>
    <tr>
      <th>A Beginner's Guide to Snuff</th>
      <td>Color</td>
      <td>Mitchell Altieri</td>
      <td>NaN</td>
      <td>87.0</td>
      <td>9.0</td>
      <td>165.0</td>
      <td>Luke Edwards</td>
      <td>467.0</td>
      <td>NaN</td>
      <td>Comedy|Horror|Thriller</td>
      <td>...</td>
      <td>NaN</td>
      <td>English</td>
      <td>USA</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2016.0</td>
      <td>258.0</td>
      <td>8.7</td>
      <td>NaN</td>
      <td>8</td>
    </tr>
    <tr>
      <th>A Better Life</th>
      <td>Color</td>
      <td>Chris Weitz</td>
      <td>94.0</td>
      <td>98.0</td>
      <td>129.0</td>
      <td>221.0</td>
      <td>Eddie 'Piolin' Sotelo</td>
      <td>749.0</td>
      <td>1754319.0</td>
      <td>Drama|Romance</td>
      <td>...</td>
      <td>81.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>10000000.0</td>
      <td>2011.0</td>
      <td>252.0</td>
      <td>7.2</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A Bridge Too Far</th>
      <td>Black and White</td>
      <td>Richard Attenborough</td>
      <td>56.0</td>
      <td>175.0</td>
      <td>0.0</td>
      <td>14.0</td>
      <td>Dirk Bogarde</td>
      <td>385.0</td>
      <td>50800000.0</td>
      <td>Drama|History|War</td>
      <td>...</td>
      <td>210.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG</td>
      <td>26000000.0</td>
      <td>1977.0</td>
      <td>232.0</td>
      <td>7.4</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>A Bug's Life</th>
      <td>Color</td>
      <td>John Lasseter</td>
      <td>117.0</td>
      <td>95.0</td>
      <td>487.0</td>
      <td>1000.0</td>
      <td>Madeline Kahn</td>
      <td>18000.0</td>
      <td>162792677.0</td>
      <td>Adventure|Animation|Comedy|Family|Fantasy</td>
      <td>...</td>
      <td>317.0</td>
      <td>English</td>
      <td>USA</td>
      <td>G</td>
      <td>120000000.0</td>
      <td>1998.0</td>
      <td>1000.0</td>
      <td>7.2</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Curse of the Golden Flower</th>
      <td>Color</td>
      <td>Yimou Zhang</td>
      <td>189.0</td>
      <td>114.0</td>
      <td>611.0</td>
      <td>10.0</td>
      <td>Ye Liu</td>
      <td>879.0</td>
      <td>6565495.0</td>
      <td>Drama|Romance</td>
      <td>...</td>
      <td>229.0</td>
      <td>Mandarin</td>
      <td>China</td>
      <td>R</td>
      <td>45000000.0</td>
      <td>2006.0</td>
      <td>52.0</td>
      <td>7.0</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Cursed</th>
      <td>Color</td>
      <td>Wes Craven</td>
      <td>158.0</td>
      <td>99.0</td>
      <td>0.0</td>
      <td>520.0</td>
      <td>Portia de Rossi</td>
      <td>1000.0</td>
      <td>19294901.0</td>
      <td>Comedy|Horror</td>
      <td>...</td>
      <td>325.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>35000000.0</td>
      <td>2005.0</td>
      <td>573.0</td>
      <td>5.0</td>
      <td>2.35</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Cutthroat Island</th>
      <td>Color</td>
      <td>Renny Harlin</td>
      <td>61.0</td>
      <td>124.0</td>
      <td>212.0</td>
      <td>810.0</td>
      <td>Frank Langella</td>
      <td>1000.0</td>
      <td>11000000.0</td>
      <td>Action|Adventure|Comedy</td>
      <td>...</td>
      <td>169.0</td>
      <td>English</td>
      <td>USA</td>
      <td>PG-13</td>
      <td>98000000.0</td>
      <td>1995.0</td>
      <td>903.0</td>
      <td>5.6</td>
      <td>2.35</td>
      <td>1000</td>
    </tr>
    <tr>
      <th>Cypher</th>
      <td>Color</td>
      <td>Vincenzo Natali</td>
      <td>82.0</td>
      <td>95.0</td>
      <td>165.0</td>
      <td>280.0</td>
      <td>Jeremy Northam</td>
      <td>686.0</td>
      <td>NaN</td>
      <td>Mystery|Romance|Sci-Fi|Thriller</td>
      <td>...</td>
      <td>124.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>7500000.0</td>
      <td>2002.0</td>
      <td>327.0</td>
      <td>6.8</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
    <tr>
      <th>Cyrus</th>
      <td>Color</td>
      <td>Jay Duplass</td>
      <td>223.0</td>
      <td>91.0</td>
      <td>157.0</td>
      <td>224.0</td>
      <td>Tim Guinee</td>
      <td>490.0</td>
      <td>7455447.0</td>
      <td>Comedy|Drama|Romance</td>
      <td>...</td>
      <td>126.0</td>
      <td>English</td>
      <td>USA</td>
      <td>R</td>
      <td>7000000.0</td>
      <td>2010.0</td>
      <td>259.0</td>
      <td>6.3</td>
      <td>1.85</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>840 rows × 27 columns</p>
</div>



# flights.csv (항공기 운항 기록 데이터)
- MONTH : 비행 월
- DAY : 비행 일
- WEEKDAY : 비행 요일 - 1(월요일)~7(일요일)
- AIRLINE : 항공사 코드
     - UA:	United Air Lines Inc.
     - AA:	American Airlines Inc.
     - US:	US Airways Inc.
     - F9:	Frontier Airlines Inc.
     - B6:	JetBlue Airways
     - OO:	Skywest Airlines Inc.
     - AS:	Alaska Airlines Inc.
     - NK:	Spirit Air Lines
     - WN:	Southwest Airlines Co.
     - DL:	Delta Air Lines Inc.
     - EV:	Atlantic Southeast Airlines
     - HA:	Hawaiian Airlines Inc.
     - MQ:	American Eagle Airlines Inc.
     - VX:	Virgin America
- ORG_AIR : 출발공항
- DEST_AIR : 도착공항
- SCHED_DEP : 출발예정시각
- DEP_DELAY : 출발지연시간(분)
- AIR_TIME : 비행시간(분)
- DIST : 비행거리(마일)
- SCHED_ARR : 도착예정시각
- ARR_DELAY : 도착지연시간(분)
- DIVERTED : 회항여부(1: True, 0: False)
- CANCELLED : 취소여부(1: True, 0: False)


```python
flight = pd.read_csv("data/flights.csv")

flight.shape
```




    (58492, 14)




```python
flight.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 58492 entries, 0 to 58491
    Data columns (total 14 columns):
     #   Column     Non-Null Count  Dtype  
    ---  ------     --------------  -----  
     0   MONTH      58492 non-null  int64  
     1   DAY        58492 non-null  int64  
     2   WEEKDAY    58492 non-null  int64  
     3   AIRLINE    58492 non-null  object 
     4   ORG_AIR    58492 non-null  object 
     5   DEST_AIR   58492 non-null  object 
     6   SCHED_DEP  58492 non-null  int64  
     7   DEP_DELAY  57659 non-null  float64
     8   AIR_TIME   57474 non-null  float64
     9   DIST       58492 non-null  int64  
     10  SCHED_ARR  58492 non-null  int64  
     11  ARR_DELAY  57474 non-null  float64
     12  DIVERTED   58492 non-null  int64  
     13  CANCELLED  58492 non-null  int64  
    dtypes: float64(3), int64(8), object(3)
    memory usage: 6.2+ MB
    


```python
flight.isnull().sum()
```




    MONTH           0
    DAY             0
    WEEKDAY         0
    AIRLINE         0
    ORG_AIR         0
    DEST_AIR        0
    SCHED_DEP       0
    DEP_DELAY     833
    AIR_TIME     1018
    DIST            0
    SCHED_ARR       0
    ARR_DELAY    1018
    DIVERTED        0
    CANCELLED       0
    dtype: int64




```python
flight.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SLC</td>
      <td>1625</td>
      <td>58.0</td>
      <td>94.0</td>
      <td>590</td>
      <td>1905</td>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>IAD</td>
      <td>823</td>
      <td>7.0</td>
      <td>154.0</td>
      <td>1452</td>
      <td>1333</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>VPS</td>
      <td>1305</td>
      <td>36.0</td>
      <td>85.0</td>
      <td>641</td>
      <td>1453</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>DCA</td>
      <td>1555</td>
      <td>7.0</td>
      <td>126.0</td>
      <td>1192</td>
      <td>1935</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MCI</td>
      <td>1720</td>
      <td>48.0</td>
      <td>166.0</td>
      <td>1363</td>
      <td>2225</td>
      <td>39.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>



# 기술통계 메소드들을 이용한 데이터 집계
## 주요 기술통계 메소드

|함수|설명|
|-|-|
|**sum()**|합계|
|**mean()**|평균|
|**median()**|중위수|
|**mode()**|최빈값|
|**quantile()**|분위수|
|**std()**|표준편차|
|**var()**|분산|
|**count()**|결측치를 제외한 원소 개수|
|**min()**|최소값|
|**max()**|최대값|
|**idxmax()**|최대값 index|
|**idxmin()**|최소값 index|
|**unique()**|고유값|
|**nunique()**|고유값의 개수|

<center><b style='font-size:1.2em'>cf) value_counts()는 Series에만 사용할 수 있다.</b></center>

- DataFrame에 위의 기술 통계 메소드들을 적용할 경우 **컬럼별로 계산한다.**
- sum(), mode(), max(), min(), unique(), nunique(), count()는 **문자열에 적용가능하다.**
    - idxmax(), idxmin() 는 문자열 컬럼에 사용할 수 없다. (문자열의 경우 넘파이의 argmax(), argmin() 함수를 사용한다.)

- **공통 매개변수**
    - skipna=True(기본값)
        - 결측치(NA)를 포함해서 계산할지 여부 설정.
        - True가 기본값으로 결측치(NA)를 제외하고 처리한다. 
        - 결측치 제외하지 않으려면 skipna=False로 설정하는데 결측치가 있으면 결과는 결측치가 된다.
    - axis
        - DataFrame에 적용할 때 계산방향을 설정
            - 0 또는 'index' (기본값): 컬럼 방향으로 집계
            - 1 또는 'columns': 행 방향으로 집계


```python
# 최빈값
flight.mode()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>20</td>
      <td>1</td>
      <td>DL</td>
      <td>ATL</td>
      <td>LAX</td>
      <td>600</td>
      <td>-3.0</td>
      <td>59.0</td>
      <td>337</td>
      <td>2100</td>
      <td>-9.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 최대값
flight.max()
```




    MONTH            12
    DAY              31
    WEEKDAY           7
    AIRLINE          WN
    ORG_AIR         SFO
    DEST_AIR        YUM
    SCHED_DEP      2359
    DEP_DELAY    1194.0
    AIR_TIME      577.0
    DIST           4502
    SCHED_ARR      2359
    ARR_DELAY    1185.0
    DIVERTED          1
    CANCELLED         1
    dtype: object




```python
# 최소값
flight.min()
```




    MONTH           1
    DAY             1
    WEEKDAY         1
    AIRLINE        AA
    ORG_AIR       ATL
    DEST_AIR      ABE
    SCHED_DEP       5
    DEP_DELAY   -24.0
    AIR_TIME      8.0
    DIST           67
    SCHED_ARR       1
    ARR_DELAY   -60.0
    DIVERTED        0
    CANCELLED       0
    dtype: object




```python
# 숫자만 계산.
flight.mean(numeric_only=True)
```




    MONTH           6.220646
    DAY            15.702096
    WEEKDAY         3.926862
    SCHED_DEP    1387.984836
    DEP_DELAY      10.921192
    AIR_TIME      115.928576
    DIST          872.900072
    SCHED_ARR    1549.399832
    ARR_DELAY       5.812315
    DIVERTED        0.002342
    CANCELLED       0.015062
    dtype: float64




```python
flight.sum()
```




    MONTH                                                   363858
    DAY                                                     918447
    WEEKDAY                                                 229690
    AIRLINE      WNUAMQAAWNUAAAF9AAUAMQEVOOEVUAAAOONKMQWNWNUAOO...
    ORG_AIR      LAXDENDFWDFWLAXIAHDFWSFOORDIAHDFWORDORDORDIAHD...
    DEST_AIR     SLCIADVPSDCAMCISANMSYPHXSTLSJCDROJANMSPCMHINDD...
    SCHED_DEP                                             81186009
    DEP_DELAY                                             629705.0
    AIR_TIME                                             6662879.0
    DIST                                                  51057671
    SCHED_ARR                                             90627495
    ARR_DELAY                                             334057.0
    DIVERTED                                                   137
    CANCELLED                                                  881
    dtype: object




```python
# 숫자만 계산
flight.sum(numeric_only=True)
```




    MONTH          363858.0
    DAY            918447.0
    WEEKDAY        229690.0
    SCHED_DEP    81186009.0
    DEP_DELAY      629705.0
    AIR_TIME      6662879.0
    DIST         51057671.0
    SCHED_ARR    90627495.0
    ARR_DELAY      334057.0
    DIVERTED          137.0
    CANCELLED         881.0
    dtype: float64




```python
# 컬럼을 선택한 후에 집계.
flight[['DEP_DELAY','ARR_DELAY']].sum()  
```




    DEP_DELAY    629705.0
    ARR_DELAY    334057.0
    dtype: float64




```python
flight[['MONTH', 'DAY', 'WEEKDAY']].mode()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>7</td>
      <td>20</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight.select_dtypes(include='object').mode()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>DL</td>
      <td>ATL</td>
      <td>LAX</td>
    </tr>
  </tbody>
</table>
</div>




```python
#결측치가 있는 경우 결과는 결측치(NaN)
flight.mean(numeric_only=True, skipna=False) 
```




    MONTH          363858.0
    DAY            918447.0
    WEEKDAY        229690.0
    SCHED_DEP    81186009.0
    DEP_DELAY           NaN
    AIR_TIME            NaN
    DIST         51057671.0
    SCHED_ARR    90627495.0
    ARR_DELAY           NaN
    DIVERTED          137.0
    CANCELLED         881.0
    dtype: float64



## aggregate(func, axis=0, \*args, \*\*kwargs) 또는 agg(func, axis=0, \*args, \*\*kwargs)
- DataFrame, Series의 메소드로 **집계결과를 다양한 형태로 묶어서 볼 때** 사용한다.
    - **사용자 정의 집계메소드를 사용할 때도 편리하다.**
- **매개변수**
    - func 
        - 집계 함수 지정
            - 함수명/함수리스트 (문자열)
                - 판다스 제공 집계메소드들은 문자열로, 사용자정의 집계함수는 함수 객체로 전달
            - Dictionary : {'집계할컬럼' : 집계함수, ... }
                - 컬럼별로 다른 집계를 할 경우
    - axis
        - DataFrame에 적용할 때 0 방향으로 계산할 지 1 방향으로 계산할지 설정
            - 0 또는 'index' (기본값): 컬럼 방향으로 집계
            - 1 또는 'columns': 행 방향으로 집계
    - \*args, \*\*kwargs 
        - 함수에 전달할 매개변수. 
        - 집계함수는 첫번째 매개변수로 Series를 받는다. 그 이외의 매개변수가 있는 경우. 


```python
# 판다스가 제공하는 집계 메소드(함수)를 사용할 경우 함수명을 문자열로 지정.
flight["ARR_DELAY"].agg(["min", "max"])
```




    min     -60.0
    max    1185.0
    Name: ARR_DELAY, dtype: float64




```python
flight['ARR_DELAY'].aggregate(['mean', 'std'])
```




    mean     5.812315
    std     38.411948
    Name: ARR_DELAY, dtype: float64




```python
flight.agg(["min", "max"]).T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MONTH</th>
      <td>1</td>
      <td>12</td>
    </tr>
    <tr>
      <th>DAY</th>
      <td>1</td>
      <td>31</td>
    </tr>
    <tr>
      <th>WEEKDAY</th>
      <td>1</td>
      <td>7</td>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <td>AA</td>
      <td>WN</td>
    </tr>
    <tr>
      <th>ORG_AIR</th>
      <td>ATL</td>
      <td>SFO</td>
    </tr>
    <tr>
      <th>DEST_AIR</th>
      <td>ABE</td>
      <td>YUM</td>
    </tr>
    <tr>
      <th>SCHED_DEP</th>
      <td>5</td>
      <td>2359</td>
    </tr>
    <tr>
      <th>DEP_DELAY</th>
      <td>-24.0</td>
      <td>1194.0</td>
    </tr>
    <tr>
      <th>AIR_TIME</th>
      <td>8.0</td>
      <td>577.0</td>
    </tr>
    <tr>
      <th>DIST</th>
      <td>67</td>
      <td>4502</td>
    </tr>
    <tr>
      <th>SCHED_ARR</th>
      <td>1</td>
      <td>2359</td>
    </tr>
    <tr>
      <th>ARR_DELAY</th>
      <td>-60.0</td>
      <td>1185.0</td>
    </tr>
    <tr>
      <th>DIVERTED</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>CANCELLED</th>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight[['DEP_DELAY', 'ARR_DELAY']].agg(['mean', 'std'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>10.921192</td>
      <td>5.812315</td>
    </tr>
    <tr>
      <th>std</th>
      <td>36.146210</td>
      <td>38.411948</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 수치형 -> float, int ===> number
flight.select_dtypes(include='number').agg(['min', 'max', 'mean']).T
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>MONTH</th>
      <td>1.0</td>
      <td>12.0</td>
      <td>6.220646</td>
    </tr>
    <tr>
      <th>DAY</th>
      <td>1.0</td>
      <td>31.0</td>
      <td>15.702096</td>
    </tr>
    <tr>
      <th>WEEKDAY</th>
      <td>1.0</td>
      <td>7.0</td>
      <td>3.926862</td>
    </tr>
    <tr>
      <th>SCHED_DEP</th>
      <td>5.0</td>
      <td>2359.0</td>
      <td>1387.984836</td>
    </tr>
    <tr>
      <th>DEP_DELAY</th>
      <td>-24.0</td>
      <td>1194.0</td>
      <td>10.921192</td>
    </tr>
    <tr>
      <th>AIR_TIME</th>
      <td>8.0</td>
      <td>577.0</td>
      <td>115.928576</td>
    </tr>
    <tr>
      <th>DIST</th>
      <td>67.0</td>
      <td>4502.0</td>
      <td>872.900072</td>
    </tr>
    <tr>
      <th>SCHED_ARR</th>
      <td>1.0</td>
      <td>2359.0</td>
      <td>1549.399832</td>
    </tr>
    <tr>
      <th>ARR_DELAY</th>
      <td>-60.0</td>
      <td>1185.0</td>
      <td>5.812315</td>
    </tr>
    <tr>
      <th>DIVERTED</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.002342</td>
    </tr>
    <tr>
      <th>CANCELLED</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.015062</td>
    </tr>
  </tbody>
</table>
</div>




```python
####  컬럼별로 다른 집계를 계산
# {"컬럼명":"집계메소드이름"}
# DEP_DELAY -> 평균, ARR_DELAY: 최소/최대 값
d = {
    "DEP_DELAY":"mean",
    'ARR_DELAY':["min", "max"]
}
flight.agg(d)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>10.921192</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>-60.0</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>1185.0</td>
    </tr>
  </tbody>
</table>
</div>



# Groupby
- 특정 열을 기준으로 같은 값을 가지는 행끼리 묶어서 group화 한다.
- **~~ 별 집계를 할 때** 사용한다. (성별, 직급별, 등급별 ...)
    - Group으로 묶을 기준 열은 범주형타입(category)을 사용한다.
- **구문**
    - `DF.groupby('그룹으로묶을기준컬럼')`
        - DataFrameGroupby 객체를 반환한다.
        - DataFrameGroupby 객체는 어떤 행끼리 묶여있는지 정보를 가진다. 이 객체의 집계함수를 사용하면 그룹별 집계를 할 수 있다.
            - `DataFrameGroupby객체['집계할 컬럼'].집계함수()`
        - groupby에 여러개의 컬럼을 기준으로 나눌 경우 리스트에 묶어서 전달한다.
        - 집계할 컬럼이 여러개인 경우 리스트로 묶어준다.
    - 집계함수
        - 기술통계 함수들
        - agg()/aggregate()
            - 여러 다른 집계함수 호출시(여러 집계를 같이 볼경우)
            - 사용자정의 집계함수 호출시
            - 컬럼별로 다른 집계함수들을 호출할 경우


```python
flight['AIRLINE'].value_counts()
```




    AIRLINE
    DL    10601
    AA     8900
    WN     8418
    UA     7792
    OO     6588
    EV     5858
    MQ     3471
    US     1615
    NK     1516
    F9     1317
    VX      993
    AS      768
    B6      543
    HA      112
    Name: count, dtype: int64




```python
gb = flight.groupby("AIRLINE")
print(type(gb))
gb.groups
# {
#     'AA':[3, 6, 8, 15, 26, ...], #'AA': 고유값, [3, 6, 8, ..] : 행이름
# }
```

    <class 'pandas.core.groupby.generic.DataFrameGroupBy'>
    




    {'AA': [3, 6, 8, 15, 26, 32, 33, 36, 37, 41, 46, 47, 48, 55, 62, 66, 73, 75, 76, 87, 89, 97, 98, 107, 120, 122, 128, 131, 133, 146, 160, 171, 174, 178, 179, 188, 200, 201, 206, 221, 267, 270, 279, 305, 309, 311, 321, 330, 332, 342, 343, 347, 348, 380, 381, 382, 390, 393, 398, 402, 404, 405, 419, 427, 430, 431, 441, 449, 451, 455, 457, 466, 476, 491, 493, 497, 509, 514, 521, 527, 528, 537, 550, 551, 556, 560, 568, 572, 587, 589, 592, 612, 613, 618, 624, 626, 628, 634, 640, 652, ...], 'AS': [38, 198, 241, 277, 397, 450, 453, 500, 518, 591, 718, 737, 741, 808, 820, 867, 872, 1005, 1106, 1146, 1292, 1437, 1530, 1559, 1609, 1636, 1747, 1786, 1810, 1826, 1892, 1921, 2010, 2151, 2269, 2446, 2526, 2576, 2586, 2941, 3112, 3125, 3171, 3176, 3413, 3483, 3494, 3596, 3678, 3734, 3891, 3910, 3937, 3989, 4099, 4128, 4326, 4397, 4432, 4587, 4743, 4799, 4841, 4850, 4912, 4987, 5099, 5154, 5176, 5254, 5261, 5297, 5356, 5372, 5496, 5667, 5685, 5688, 5877, 5976, 6016, 6079, 6122, 6245, 6255, 6393, 6529, 6816, 6824, 6861, 6945, 6988, 7065, 7150, 7153, 7196, 7225, 7235, 7389, 7478, ...], 'B6': [123, 127, 239, 333, 548, 549, 696, 757, 945, 1175, 1361, 1453, 1547, 1561, 1564, 1650, 1670, 1691, 1800, 1939, 1998, 2251, 2253, 2256, 2330, 2385, 2434, 2607, 2650, 2692, 2721, 2781, 2800, 2884, 2936, 3060, 3306, 3648, 3793, 3983, 4347, 4552, 4578, 4639, 4779, 4820, 4885, 5036, 5125, 5131, 5205, 5211, 5228, 5260, 5351, 5483, 5577, 5585, 5777, 5956, 6126, 6151, 6418, 6901, 6952, 6977, 7792, 7798, 7853, 7877, 7904, 8030, 8082, 8091, 8118, 8145, 8177, 8364, 8507, 8541, 8543, 8558, 8732, 8828, 8912, 9093, 9173, 9275, 9371, 9389, 9447, 9482, 9574, 9686, 9896, 10066, 10254, 10416, 10600, 10727, ...], 'DL': [53, 57, 77, 79, 85, 90, 91, 101, 116, 117, 121, 129, 130, 137, 142, 152, 154, 155, 158, 159, 162, 165, 169, 172, 181, 182, 184, 185, 189, 190, 204, 207, 211, 215, 216, 222, 235, 238, 244, 245, 248, 249, 250, 253, 254, 258, 286, 289, 304, 307, 308, 310, 313, 323, 326, 328, 329, 336, 353, 354, 364, 373, 385, 395, 407, 411, 412, 413, 420, 433, 435, 439, 445, 456, 468, 481, 485, 490, 492, 508, 517, 526, 529, 531, 535, 543, 546, 559, 570, 579, 584, 588, 593, 602, 606, 607, 616, 617, 631, 642, ...], 'EV': [11, 13, 29, 40, 69, 100, 106, 118, 136, 143, 147, 164, 167, 170, 194, 196, 199, 205, 208, 219, 220, 225, 231, 233, 236, 251, 252, 261, 264, 265, 268, 282, 291, 293, 298, 312, 319, 337, 352, 362, 363, 369, 371, 383, 403, 414, 415, 424, 429, 437, 442, 443, 459, 460, 465, 470, 495, 499, 503, 505, 506, 522, 525, 530, 541, 567, 574, 580, 583, 632, 645, 654, 659, 677, 683, 689, 693, 695, 697, 714, 721, 723, 725, 730, 740, 742, 761, 764, 765, 768, 772, 776, 777, 778, 785, 787, 790, 791, 794, 799, ...], 'F9': [7, 93, 209, 232, 247, 290, 301, 386, 444, 483, 553, 563, 596, 598, 599, 605, 665, 685, 738, 844, 870, 948, 985, 1103, 1167, 1181, 1264, 1374, 1382, 1407, 1421, 1435, 1489, 1590, 1611, 1697, 1746, 1760, 1775, 1776, 1807, 1830, 1925, 1962, 2014, 2036, 2069, 2078, 2111, 2125, 2208, 2335, 2405, 2515, 2557, 2579, 2600, 2683, 2693, 2708, 2731, 2733, 2805, 2853, 2861, 3024, 3241, 3288, 3374, 3382, 3395, 3418, 3555, 3570, 3575, 3628, 3638, 3716, 3735, 3777, 3843, 3923, 3962, 3977, 4016, 4031, 4046, 4069, 4111, 4151, 4172, 4287, 4356, 4371, 4420, 4469, 4542, 4641, 4671, 4720, ...], 'HA': [582, 712, 878, 1053, 1269, 1345, 1544, 1864, 2316, 2644, 2681, 3002, 3165, 3227, 4359, 4414, 4926, 5187, 5281, 5320, 5363, 7267, 7372, 7744, 7808, 9360, 9761, 10163, 11119, 11626, 11743, 11809, 12275, 12752, 12780, 13466, 13755, 13956, 14566, 15064, 15316, 15959, 16501, 17632, 18467, 18720, 20461, 21558, 21761, 22454, 22584, 22592, 22618, 22858, 22892, 23177, 23374, 23773, 25763, 26127, 27745, 28864, 29608, 29762, 29875, 30610, 31164, 31505, 31530, 31675, 32030, 32037, 32987, 33311, 33747, 34884, 35959, 36068, 36319, 36425, 37119, 37128, 37664, 37983, 38440, 39475, 39482, 39625, 41664, 42165, 42485, 42846, 44068, 45330, 46713, 47772, 48279, 48722, 49667, 49782, ...], 'MQ': [2, 10, 18, 24, 50, 60, 71, 78, 81, 103, 105, 115, 125, 149, 180, 187, 210, 214, 228, 285, 296, 314, 320, 334, 335, 339, 341, 357, 458, 472, 484, 486, 488, 502, 516, 524, 534, 547, 581, 601, 622, 638, 639, 646, 661, 707, 711, 722, 727, 751, 769, 774, 802, 805, 830, 851, 854, 856, 865, 876, 915, 939, 955, 968, 977, 980, 1002, 1006, 1036, 1085, 1087, 1104, 1113, 1150, 1158, 1163, 1168, 1169, 1204, 1229, 1231, 1234, 1238, 1246, 1287, 1296, 1303, 1306, 1328, 1329, 1336, 1393, 1398, 1410, 1423, 1428, 1436, 1448, 1449, 1454, ...], 'NK': [17, 74, 95, 109, 166, 345, 358, 401, 434, 436, 446, 452, 482, 507, 510, 519, 533, 544, 610, 615, 620, 729, 735, 845, 858, 887, 898, 916, 970, 1017, 1095, 1097, 1153, 1188, 1208, 1257, 1342, 1392, 1536, 1579, 1580, 1657, 1732, 1761, 1863, 1943, 1948, 1990, 2026, 2068, 2071, 2118, 2124, 2149, 2177, 2196, 2214, 2244, 2299, 2334, 2378, 2424, 2425, 2447, 2523, 2537, 2592, 2613, 2639, 2643, 2740, 2749, 2752, 2764, 2765, 2770, 2786, 2875, 2886, 3018, 3061, 3065, 3072, 3151, 3153, 3174, 3248, 3315, 3381, 3435, 3566, 3598, 3674, 3696, 3701, 3708, 3840, 3877, 3894, 3934, ...], 'OO': [12, 16, 22, 25, 27, 34, 39, 42, 51, 52, 54, 58, 61, 63, 65, 82, 86, 99, 102, 113, 124, 126, 135, 138, 139, 151, 157, 161, 168, 175, 213, 223, 237, 240, 242, 255, 257, 278, 281, 284, 288, 297, 315, 317, 318, 322, 324, 327, 331, 359, 361, 366, 367, 370, 376, 378, 379, 387, 392, 418, 421, 447, 448, 540, 552, 554, 565, 569, 576, 590, 600, 603, 604, 609, 625, 629, 637, 649, 653, 658, 660, 663, 666, 671, 672, 673, 676, 679, 681, 682, 684, 691, 692, 708, 734, 754, 755, 762, 789, 793, ...], 'UA': [1, 5, 9, 14, 21, 44, 45, 67, 70, 72, 94, 108, 110, 134, 140, 141, 144, 145, 163, 177, 183, 192, 197, 246, 260, 262, 263, 266, 269, 273, 275, 283, 295, 325, 338, 340, 349, 368, 374, 375, 377, 389, 394, 396, 408, 423, 425, 438, 440, 462, 463, 469, 471, 474, 479, 501, 511, 512, 513, 520, 523, 536, 539, 542, 555, 557, 566, 573, 577, 586, 594, 595, 608, 621, 623, 630, 635, 636, 647, 650, 651, 667, 686, 687, 698, 699, 700, 701, 713, 717, 719, 745, 756, 773, 784, 801, 829, 836, 842, 843, ...], 'US': [31, 35, 49, 96, 104, 111, 112, 119, 148, 150, 153, 191, 202, 203, 224, 229, 355, 360, 372, 384, 391, 467, 473, 477, 478, 487, 494, 538, 545, 558, 561, 564, 575, 578, 619, 690, 715, 726, 728, 760, 795, 806, 881, 896, 901, 910, 954, 1028, 1033, 1068, 1134, 1135, 1143, 1155, 1164, 1201, 1210, 1245, 1274, 1288, 1290, 1291, 1335, 1355, 1377, 1399, 1406, 1446, 1459, 1462, 1470, 1471, 1476, 1481, 1493, 1499, 1503, 1552, 1554, 1565, 1589, 1593, 1603, 1661, 1680, 1716, 1731, 1733, 1735, 1743, 1749, 1754, 1755, 1758, 1767, 1773, 1790, 1821, 1904, 1905, ...], 'VX': [56, 227, 243, 417, 432, 464, 614, 641, 703, 759, 812, 825, 943, 1058, 1092, 1093, 1192, 1302, 1312, 1343, 1369, 1452, 1586, 1599, 1644, 1696, 1705, 1805, 1930, 1957, 2048, 2219, 2220, 2270, 2302, 2324, 2484, 2572, 2620, 2646, 2735, 2753, 2808, 2880, 2898, 2919, 3110, 3111, 3120, 3210, 3246, 3261, 3302, 3427, 3501, 3510, 3664, 3680, 3694, 3731, 3860, 3938, 3968, 4005, 4029, 4035, 4056, 4088, 4270, 4351, 4531, 4536, 4540, 4692, 4712, 4728, 4746, 4825, 4856, 4860, 4869, 4876, 4890, 4901, 4928, 4994, 5075, 5078, 5115, 5143, 5167, 5206, 5245, 5265, 5379, 5383, 5413, 5502, 5512, 5522, ...], 'WN': [0, 4, 19, 20, 23, 28, 30, 43, 59, 64, 68, 80, 83, 84, 88, 92, 114, 132, 156, 173, 176, 186, 193, 195, 212, 217, 218, 226, 230, 234, 256, 259, 271, 272, 274, 276, 280, 287, 292, 294, 299, 300, 302, 303, 306, 316, 344, 346, 350, 351, 356, 365, 388, 399, 400, 406, 409, 410, 416, 422, 426, 428, 454, 461, 475, 480, 489, 496, 498, 504, 515, 532, 562, 571, 585, 597, 611, 627, 633, 648, 657, 669, 670, 674, 678, 710, 720, 724, 731, 744, 747, 752, 753, 788, 797, 804, 807, 813, 815, 817, ...]}




```python
# 항공사별 도착지연시간의 평균?
flight.groupby("AIRLINE")["ARR_DELAY"].mean()
```




    AIRLINE
    AA     5.542661
    AS    -0.833333
    B6     8.692593
    DL     0.339691
    EV     7.034580
    F9    13.630651
    HA     4.972973
    MQ     6.860591
    NK    18.436070
    OO     7.593463
    UA     7.765755
    US     1.681105
    VX     5.348884
    WN     6.397353
    Name: ARR_DELAY, dtype: float64




```python
flight.groupby("AIRLINE").mean(numeric_only=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>6.661461</td>
      <td>15.570562</td>
      <td>3.986966</td>
      <td>1340.140449</td>
      <td>11.274057</td>
      <td>144.259404</td>
      <td>1114.347865</td>
      <td>1546.960899</td>
      <td>5.542661</td>
      <td>0.002921</td>
      <td>0.017303</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>6.197917</td>
      <td>15.247396</td>
      <td>3.941406</td>
      <td>1418.269531</td>
      <td>1.808594</td>
      <td>147.845052</td>
      <td>1065.884115</td>
      <td>1548.292969</td>
      <td>-0.833333</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>6.368324</td>
      <td>15.788214</td>
      <td>4.040516</td>
      <td>1512.924494</td>
      <td>14.287823</td>
      <td>209.412963</td>
      <td>1771.882136</td>
      <td>1432.889503</td>
      <td>8.692593</td>
      <td>0.003683</td>
      <td>0.001842</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>6.277332</td>
      <td>15.721158</td>
      <td>3.913310</td>
      <td>1426.563154</td>
      <td>7.242450</td>
      <td>115.334187</td>
      <td>866.448448</td>
      <td>1578.735402</td>
      <td>0.339691</td>
      <td>0.002264</td>
      <td>0.003585</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>6.003926</td>
      <td>15.866166</td>
      <td>3.927450</td>
      <td>1415.510413</td>
      <td>9.092625</td>
      <td>68.964016</td>
      <td>460.237453</td>
      <td>1571.798054</td>
      <td>7.034580</td>
      <td>0.002561</td>
      <td>0.024923</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>6.401670</td>
      <td>15.914958</td>
      <td>4.007593</td>
      <td>1407.121488</td>
      <td>14.310398</td>
      <td>127.592337</td>
      <td>969.593014</td>
      <td>1510.177677</td>
      <td>13.630651</td>
      <td>0.001519</td>
      <td>0.007593</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>5.508929</td>
      <td>15.526786</td>
      <td>3.750000</td>
      <td>959.419643</td>
      <td>2.571429</td>
      <td>338.288288</td>
      <td>2615.178571</td>
      <td>1280.714286</td>
      <td>4.972973</td>
      <td>0.008929</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>5.970614</td>
      <td>15.598963</td>
      <td>3.902622</td>
      <td>1432.251801</td>
      <td>11.094323</td>
      <td>61.318346</td>
      <td>404.229041</td>
      <td>1587.835494</td>
      <td>6.860591</td>
      <td>0.001441</td>
      <td>0.043791</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>6.602243</td>
      <td>15.680739</td>
      <td>4.006596</td>
      <td>1336.634565</td>
      <td>19.514401</td>
      <td>135.736878</td>
      <td>1047.428100</td>
      <td>1398.226913</td>
      <td>18.436070</td>
      <td>0.003298</td>
      <td>0.016491</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>6.134791</td>
      <td>15.651943</td>
      <td>3.923345</td>
      <td>1426.486794</td>
      <td>9.662279</td>
      <td>76.010272</td>
      <td>511.239375</td>
      <td>1573.730267</td>
      <td>7.593463</td>
      <td>0.003188</td>
      <td>0.021554</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>6.322510</td>
      <td>15.697510</td>
      <td>3.871535</td>
      <td>1357.970739</td>
      <td>16.210485</td>
      <td>155.650521</td>
      <td>1230.918891</td>
      <td>1532.871150</td>
      <td>7.765755</td>
      <td>0.002438</td>
      <td>0.011935</td>
    </tr>
    <tr>
      <th>US</th>
      <td>3.628483</td>
      <td>16.079876</td>
      <td>4.063777</td>
      <td>1289.552941</td>
      <td>4.361355</td>
      <td>147.686755</td>
      <td>1181.226625</td>
      <td>1489.131269</td>
      <td>1.681105</td>
      <td>0.000619</td>
      <td>0.013003</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>6.336354</td>
      <td>15.518630</td>
      <td>3.924471</td>
      <td>1385.110775</td>
      <td>8.918946</td>
      <td>154.864097</td>
      <td>1240.296073</td>
      <td>1581.023162</td>
      <td>5.348884</td>
      <td>0.001007</td>
      <td>0.006042</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>6.298646</td>
      <td>15.746971</td>
      <td>3.884652</td>
      <td>1370.585650</td>
      <td>12.639366</td>
      <td>107.005897</td>
      <td>809.985626</td>
      <td>1532.243407</td>
      <td>6.397353</td>
      <td>0.001782</td>
      <td>0.011048</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 항공사별 출발/도착 지연시간의 평균
### df.groupby()[집계할 컬럼].집계메소드
flight.groupby("AIRLINE")[['DEP_DELAY', 'ARR_DELAY']].mean()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>11.274057</td>
      <td>5.542661</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>1.808594</td>
      <td>-0.833333</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>14.287823</td>
      <td>8.692593</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>7.242450</td>
      <td>0.339691</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>9.092625</td>
      <td>7.034580</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>14.310398</td>
      <td>13.630651</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>2.571429</td>
      <td>4.972973</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>11.094323</td>
      <td>6.860591</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>19.514401</td>
      <td>18.436070</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>9.662279</td>
      <td>7.593463</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>16.210485</td>
      <td>7.765755</td>
    </tr>
    <tr>
      <th>US</th>
      <td>4.361355</td>
      <td>1.681105</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>8.918946</td>
      <td>5.348884</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>12.639366</td>
      <td>6.397353</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 출발 공항별 출발지연시간의 최소값, 최대값
flight.groupby("ORG_AIR")['DEP_DELAY'].agg(["min", "max", min_max_diff])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>min_max_diff</th>
    </tr>
    <tr>
      <th>ORG_AIR</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATL</th>
      <td>-18.0</td>
      <td>702.0</td>
      <td>720.0</td>
    </tr>
    <tr>
      <th>DEN</th>
      <td>-18.0</td>
      <td>1194.0</td>
      <td>1212.0</td>
    </tr>
    <tr>
      <th>DFW</th>
      <td>-16.0</td>
      <td>852.0</td>
      <td>868.0</td>
    </tr>
    <tr>
      <th>IAH</th>
      <td>-17.0</td>
      <td>835.0</td>
      <td>852.0</td>
    </tr>
    <tr>
      <th>LAS</th>
      <td>-21.0</td>
      <td>751.0</td>
      <td>772.0</td>
    </tr>
    <tr>
      <th>LAX</th>
      <td>-24.0</td>
      <td>746.0</td>
      <td>770.0</td>
    </tr>
    <tr>
      <th>MSP</th>
      <td>-17.0</td>
      <td>461.0</td>
      <td>478.0</td>
    </tr>
    <tr>
      <th>ORD</th>
      <td>-16.0</td>
      <td>511.0</td>
      <td>527.0</td>
    </tr>
    <tr>
      <th>PHX</th>
      <td>-22.0</td>
      <td>555.0</td>
      <td>577.0</td>
    </tr>
    <tr>
      <th>SFO</th>
      <td>-20.0</td>
      <td>684.0</td>
      <td>704.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight.groupby('ORG_AIR').agg({"DEP_DELAY":"mean", "ARR_DELAY":"min"})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>ORG_AIR</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATL</th>
      <td>9.267446</td>
      <td>-57.0</td>
    </tr>
    <tr>
      <th>DEN</th>
      <td>11.052586</td>
      <td>-44.0</td>
    </tr>
    <tr>
      <th>DFW</th>
      <td>11.593030</td>
      <td>-45.0</td>
    </tr>
    <tr>
      <th>IAH</th>
      <td>11.821255</td>
      <td>-47.0</td>
    </tr>
    <tr>
      <th>LAS</th>
      <td>10.792156</td>
      <td>-52.0</td>
    </tr>
    <tr>
      <th>LAX</th>
      <td>10.961690</td>
      <td>-58.0</td>
    </tr>
    <tr>
      <th>MSP</th>
      <td>7.206256</td>
      <td>-53.0</td>
    </tr>
    <tr>
      <th>ORD</th>
      <td>14.760098</td>
      <td>-52.0</td>
    </tr>
    <tr>
      <th>PHX</th>
      <td>8.502841</td>
      <td>-60.0</td>
    </tr>
    <tr>
      <th>SFO</th>
      <td>11.028730</td>
      <td>-51.0</td>
    </tr>
  </tbody>
</table>
</div>



##  복수열 기준 그룹핑
- 두개 이상의 열을 그룹으로 묶을 수 있다. 
- groupby의 매개변수에 그룹으로 묶을 컬럼들의 이름을 리스트로 전달한다.


```python
# 월, 요일별 도착지연시간의 평균 --> groupby로 묶을 기준컬럼이 2개이상.
result = flight.groupby(["MONTH", "WEEKDAY"])['ARR_DELAY'].mean()
result
```




    MONTH  WEEKDAY
    1      1          12.202723
           2           3.615756
           3           2.478328
           4           6.715006
           5           6.082635
                        ...    
    12     3          10.780822
           4           3.693069
           5           1.754947
           6           4.962775
           7           8.437898
    Name: ARR_DELAY, Length: 77, dtype: float64



## Group 별 집계결과에서 특정 조건의 항목만 조회
- Groupby 집계 후 boolean indexing 처리한다.



```python
# 결측치가 아닌 값의 개수
flight['CANCELLED'].count() 
```




    58492




```python
# 1(취소)의 합계
flight["CANCELLED"].sum()   
```




    881




```python
# 취소안된 것 건수
(flight['CANCELLED'] == 0).sum()
```




    57611




```python
# 항공사별 (출발) 취소 건수. 100 회이상인 항공사만 조회
result = flight.groupby("AIRLINE")['CANCELLED'].sum()
result[result >= 100]
```




    AIRLINE
    AA    154
    EV    146
    MQ    152
    OO    142
    Name: CANCELLED, dtype: int64



# 사용자 정의 집계함수를 만들어 적용

## 사용자 정의 집계 함수 정의
- 매개변수
    1. Series 또는 DataFrame을 받을 매개변수(필수)
    2. 필요한 값을 받을 매개변수를 선언한다. (선택)


```python
###### 사용자 정의 집계 함수.
# 컬럼의 최대값과 최소값 간의 차이
## 파라미터: 집계하려는 Series (필수) ==> 첫번째 파라미터(agg() 메소드와 연동)
def min_max_diff(column):
    """
    Series의 최소값과 최대값의 차이를 계산하는 집계함수.
    [parameter]
        column: pd.Series - 집계할 대상 Series
    [return]
        float: max - min 결과. 문자열 컬럼일 경우 None 을 반환.
    [raise]
        XXXException - 문자열컬럼일 경우 XXX Exception 발생
    """
    if column.dtype == "object" or column.dtype == "str":
        return None
    return column.max() - column.min()
```


```python
min_max_diff(flight['ARR_DELAY'])
```




    1245.0




```python
flight['ARR_DELAY'].agg(min_max_diff)
```




    1245.0




```python
flight['ARR_DELAY'].agg(["min", "max", min_max_diff])
```




    min              -60.0
    max             1185.0
    min_max_diff    1245.0
    Name: ARR_DELAY, dtype: float64



## agg() 를 사용해 사용자 정의 집계 함수 호출
- DataFrame.agg(func=None, axis=0, \*args, \*\*kwargs)
    - axis : 사용자 정의 함수에 전달할 값들(Series)의 축 지정
- Series.agg(func=None, axis=0, \*args, \*\*kwargs)
    - DataFrame의 agg와 매개변수 구조를 맞추기 위해 axis 지정한다. (kwargs를 이용해 매개변수 전달할 경우 axis는 생략해도 된다. - axis기본값 0을 그냥 쓰면 되므로. - keyword 인자 뒤에 position 인자는 안되서 *args로 값 전달시에는 axis를 지정해야 한다.)
- DataFrameGroupBy.agg(func, \*args, \*\*kwargs) 
    - axis 지정안함.
    - 사용자 함수에 Series를 group 별로 전달한다.
- SeriesGroupBy.agg(func=None,  \*args, \*\*kwargs)  
    - axis 지정안함
    - 사용자 함수에 Series를 group 별로 전달한다.
  
- \*args, \*\*kwargs는 사용자 정의 함수에 선언한 매개변수가 있을 경우 전달할 값을 전달한다.  
    - 키워드 인자를 이용해 가변인자로 전달하는 것이 편하다.


```python
# 판다스 제공 집계함수를 agg() 이용해서 호출
flight.select_dtypes(include="int64").agg("count")  #DF.agg()
```




    MONTH        58492
    DAY          58492
    WEEKDAY      58492
    SCHED_DEP    58492
    DIST         58492
    SCHED_ARR    58492
    DIVERTED     58492
    CANCELLED    58492
    dtype: int64




```python
flight['ARR_DELAY'].agg("count")  # Series.agg()
```




    57474




```python
flight.groupby('AIRLINE').agg("count") # DataFrameGroupby.agg()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>8900</td>
      <td>8900</td>
      <td>8900</td>
      <td>8900</td>
      <td>8900</td>
      <td>8900</td>
      <td>8750</td>
      <td>8720</td>
      <td>8900</td>
      <td>8900</td>
      <td>8720</td>
      <td>8900</td>
      <td>8900</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
      <td>768</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>543</td>
      <td>543</td>
      <td>543</td>
      <td>543</td>
      <td>543</td>
      <td>543</td>
      <td>542</td>
      <td>540</td>
      <td>543</td>
      <td>543</td>
      <td>540</td>
      <td>543</td>
      <td>543</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>10601</td>
      <td>10601</td>
      <td>10601</td>
      <td>10601</td>
      <td>10601</td>
      <td>10601</td>
      <td>10563</td>
      <td>10539</td>
      <td>10601</td>
      <td>10601</td>
      <td>10539</td>
      <td>10601</td>
      <td>10601</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>5858</td>
      <td>5858</td>
      <td>5858</td>
      <td>5858</td>
      <td>5858</td>
      <td>5858</td>
      <td>5722</td>
      <td>5697</td>
      <td>5858</td>
      <td>5858</td>
      <td>5697</td>
      <td>5858</td>
      <td>5858</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>1317</td>
      <td>1317</td>
      <td>1317</td>
      <td>1317</td>
      <td>1317</td>
      <td>1317</td>
      <td>1308</td>
      <td>1305</td>
      <td>1317</td>
      <td>1317</td>
      <td>1305</td>
      <td>1317</td>
      <td>1317</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>112</td>
      <td>112</td>
      <td>112</td>
      <td>112</td>
      <td>112</td>
      <td>112</td>
      <td>112</td>
      <td>111</td>
      <td>112</td>
      <td>112</td>
      <td>111</td>
      <td>112</td>
      <td>112</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>3471</td>
      <td>3471</td>
      <td>3471</td>
      <td>3471</td>
      <td>3471</td>
      <td>3471</td>
      <td>3329</td>
      <td>3314</td>
      <td>3471</td>
      <td>3471</td>
      <td>3314</td>
      <td>3471</td>
      <td>3471</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>1516</td>
      <td>1516</td>
      <td>1516</td>
      <td>1516</td>
      <td>1516</td>
      <td>1516</td>
      <td>1493</td>
      <td>1486</td>
      <td>1516</td>
      <td>1516</td>
      <td>1486</td>
      <td>1516</td>
      <td>1516</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>6588</td>
      <td>6588</td>
      <td>6588</td>
      <td>6588</td>
      <td>6588</td>
      <td>6588</td>
      <td>6458</td>
      <td>6425</td>
      <td>6588</td>
      <td>6588</td>
      <td>6425</td>
      <td>6588</td>
      <td>6588</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>7792</td>
      <td>7792</td>
      <td>7792</td>
      <td>7792</td>
      <td>7792</td>
      <td>7792</td>
      <td>7706</td>
      <td>7680</td>
      <td>7792</td>
      <td>7792</td>
      <td>7680</td>
      <td>7792</td>
      <td>7792</td>
    </tr>
    <tr>
      <th>US</th>
      <td>1615</td>
      <td>1615</td>
      <td>1615</td>
      <td>1615</td>
      <td>1615</td>
      <td>1615</td>
      <td>1594</td>
      <td>1593</td>
      <td>1615</td>
      <td>1615</td>
      <td>1593</td>
      <td>1615</td>
      <td>1615</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>993</td>
      <td>993</td>
      <td>993</td>
      <td>993</td>
      <td>993</td>
      <td>993</td>
      <td>987</td>
      <td>986</td>
      <td>993</td>
      <td>993</td>
      <td>986</td>
      <td>993</td>
      <td>993</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>8418</td>
      <td>8418</td>
      <td>8418</td>
      <td>8418</td>
      <td>8418</td>
      <td>8418</td>
      <td>8327</td>
      <td>8310</td>
      <td>8418</td>
      <td>8418</td>
      <td>8310</td>
      <td>8418</td>
      <td>8418</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight.groupby("AIRLINE")["ARR_DELAY"].agg("count")
```




    AIRLINE
    AA     8720
    AS      768
    B6      540
    DL    10539
    EV     5697
    F9     1305
    HA      111
    MQ     3314
    NK     1486
    OO     6425
    UA     7680
    US     1593
    VX      986
    WN     8310
    Name: ARR_DELAY, dtype: int64




```python
# 사용자 정의 집계함수 agg() 이용해서 호출
def iqr(src:"집계대상", q1=0.25, q3=0.75):
    """
    IQR(Inter Quartile Range) -> 4분위수에서 3분위 - 1분위
    """
    
    qt1, qt3 = src.quantile(q = [q1, q3])
    return qt3 - qt1
    
```


```python
flight.select_dtypes(include="int64")
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>SCHED_DEP</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1625</td>
      <td>590</td>
      <td>1905</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>823</td>
      <td>1452</td>
      <td>1333</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1305</td>
      <td>641</td>
      <td>1453</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1555</td>
      <td>1192</td>
      <td>1935</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>1720</td>
      <td>1363</td>
      <td>2225</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58487</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>515</td>
      <td>1464</td>
      <td>1045</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58488</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>1910</td>
      <td>414</td>
      <td>2050</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58489</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>1846</td>
      <td>262</td>
      <td>1956</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58490</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>525</td>
      <td>907</td>
      <td>855</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58491</th>
      <td>12</td>
      <td>31</td>
      <td>4</td>
      <td>859</td>
      <td>522</td>
      <td>1146</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>58492 rows × 8 columns</p>
</div>




```python
# DataFrame.agg(사용자정의)  DataFrame의 각 컬럼(Series)들을 하나씩 사용자정의 함수에 전달
flight.select_dtypes(include="int64").agg(iqr)
```




    MONTH          6.0
    DAY           15.0
    WEEKDAY        4.0
    SCHED_DEP    805.0
    DIST         808.0
    SCHED_ARR    800.0
    DIVERTED       0.0
    CANCELLED      0.0
    dtype: float64




```python
flight['ARR_DELAY'].agg(iqr)
```




    21.0




```python
# SeriesGroupby.agg(사용자정의) : Series(컬럼)을 group 별로 하나씩 사용자정의 함수에 전달
flight.groupby("AIRLINE")["ARR_DELAY"].agg(iqr)
```




    AIRLINE
    AA    23.00
    AS    18.00
    B6    28.25
    DL    18.00
    EV    21.00
    F9    27.00
    HA    21.00
    MQ    25.00
    NK    34.00
    OO    22.00
    UA    25.00
    US    19.00
    VX    19.00
    WN    23.00
    Name: ARR_DELAY, dtype: float64




```python
# 각 컬럼(Series)의 값을 group별로 하나씩 사용자 정의 함수에 전달
flight.groupby('AIRLINE')[['DEP_DELAY', 'ARR_DELAY']].agg(iqr)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>14.00</td>
      <td>23.00</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>8.00</td>
      <td>18.00</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>20.75</td>
      <td>28.25</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>8.00</td>
      <td>18.00</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>12.00</td>
      <td>21.00</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>20.00</td>
      <td>27.00</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>6.25</td>
      <td>21.00</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>16.00</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>27.00</td>
      <td>34.00</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>13.00</td>
      <td>22.00</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>18.00</td>
      <td>25.00</td>
    </tr>
    <tr>
      <th>US</th>
      <td>7.00</td>
      <td>19.00</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>9.00</td>
      <td>19.00</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>18.00</td>
      <td>23.00</td>
    </tr>
  </tbody>
</table>
</div>



# TODO


```python
# 1. data/diamonds.csv 를 읽어 DataFrame 생성
import pandas as pd
dm = pd.read_csv('data/diamonds.csv')
dm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>2757</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>2757</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>




```python
# 2. 1에서 생성한 DataFrame의 정보 조회
```


```python
# 2.1 배열의 shape조회
dm.shape
```




    (53940, 10)




```python
# 2.2 DataFrame에 대한 정보조회
dm.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 53940 entries, 0 to 53939
    Data columns (total 10 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   carat    53940 non-null  float64
     1   cut      53940 non-null  object 
     2   color    53940 non-null  object 
     3   clarity  53940 non-null  object 
     4   depth    53940 non-null  float64
     5   table    53940 non-null  float64
     6   price    53940 non-null  int64  
     7   x        53940 non-null  float64
     8   y        53940 non-null  float64
     9   z        53940 non-null  float64
    dtypes: float64(6), int64(1), object(3)
    memory usage: 4.1+ MB
    


```python
dm['cut'].value_counts()
```




    cut
    Ideal        21551
    Premium      13791
    Very Good    12082
    Good          4906
    Fair          1610
    Name: count, dtype: int64




```python
#　2.3 상위 5개 행 조회
dm.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 2.3 하위 5개 행 조회
dm.tail() 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>2757</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>2757</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 2.4 결측치 확인
dm.isnull().sum()
```




    carat      0
    cut        0
    color      0
    clarity    0
    depth      0
    table      0
    price      0
    x          0
    y          0
    z          0
    dtype: int64




```python
# 3. carat, price, depth의 합계, 평균, 최대, 최소 조회
dm[['carat', 'price', 'depth']].agg(['sum','mean','max','min'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>price</th>
      <th>depth</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sum</th>
      <td>43040.87000</td>
      <td>2.121352e+08</td>
      <td>3.330763e+06</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.79794</td>
      <td>3.932800e+03</td>
      <td>6.174940e+01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>5.01000</td>
      <td>1.882300e+04</td>
      <td>7.900000e+01</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.20000</td>
      <td>3.260000e+02</td>
      <td>4.300000e+01</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 4. price는 최대, 최소, color는 고유값의 개수를 조회
dm['color'].nunique()

d = {
    'price':['max','min'],
    'color':'nunique'
}
dm.agg(d)
dm['']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>price</th>
      <th>color</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>18823.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>326.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>nunique</th>
      <td>NaN</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 5. cut의 고유값별 개수를 조회
dm['cut'].value_counts().sort_values()
```




    cut
    Fair          1610
    Good          4906
    Very Good    12082
    Premium      13791
    Ideal        21551
    Name: count, dtype: int64




```python
# 6. cut별 가격 평균 조회
dm.groupby('cut')['price'].mean().sort_values()
```




    cut
    Ideal        3457.541970
    Good         3928.864452
    Very Good    3981.759891
    Fair         4358.757764
    Premium      4584.257704
    Name: price, dtype: float64




```python
# 7. cut별 가격 평균중 4000이상만 조회
result = dm.groupby('cut')['price'].mean()
result[result >= 4000]
```




    cut
    Fair       4358.757764
    Premium    4584.257704
    Name: price, dtype: float64




```python
# 8. clarity별 carat 평균과 표준편차 조회
dm.groupby('clarity')['carat'].agg(['mean','std']).sort_values('mean')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>std</th>
    </tr>
    <tr>
      <th>clarity</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>VVS1</th>
      <td>0.503321</td>
      <td>0.299557</td>
    </tr>
    <tr>
      <th>IF</th>
      <td>0.505123</td>
      <td>0.313433</td>
    </tr>
    <tr>
      <th>VVS2</th>
      <td>0.596202</td>
      <td>0.359697</td>
    </tr>
    <tr>
      <th>VS1</th>
      <td>0.727158</td>
      <td>0.423529</td>
    </tr>
    <tr>
      <th>VS2</th>
      <td>0.763935</td>
      <td>0.446292</td>
    </tr>
    <tr>
      <th>SI1</th>
      <td>0.850482</td>
      <td>0.449652</td>
    </tr>
    <tr>
      <th>SI2</th>
      <td>1.077648</td>
      <td>0.516653</td>
    </tr>
    <tr>
      <th>I1</th>
      <td>1.283846</td>
      <td>0.632436</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 9. cut과 color 별로 가격은 평균을 carat은 최대값을 조회 
dm.groupby(['cut','color']).agg({'price':'mean','carat':'max'}) \
                                    .rename(columns={'price':'price-평균','carat':'carat-최대'})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>price-평균</th>
      <th>carat-최대</th>
    </tr>
    <tr>
      <th>cut</th>
      <th>color</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">Fair</th>
      <th>D</th>
      <td>4291.061350</td>
      <td>3.40</td>
    </tr>
    <tr>
      <th>E</th>
      <td>3682.312500</td>
      <td>2.04</td>
    </tr>
    <tr>
      <th>F</th>
      <td>3827.003205</td>
      <td>2.58</td>
    </tr>
    <tr>
      <th>G</th>
      <td>4239.254777</td>
      <td>2.60</td>
    </tr>
    <tr>
      <th>H</th>
      <td>5135.683168</td>
      <td>4.13</td>
    </tr>
    <tr>
      <th>I</th>
      <td>4685.445714</td>
      <td>3.02</td>
    </tr>
    <tr>
      <th>J</th>
      <td>4975.655462</td>
      <td>5.01</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Good</th>
      <th>D</th>
      <td>3405.382175</td>
      <td>2.04</td>
    </tr>
    <tr>
      <th>E</th>
      <td>3423.644159</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>F</th>
      <td>3495.750275</td>
      <td>2.67</td>
    </tr>
    <tr>
      <th>G</th>
      <td>4123.482204</td>
      <td>2.80</td>
    </tr>
    <tr>
      <th>H</th>
      <td>4276.254986</td>
      <td>3.01</td>
    </tr>
    <tr>
      <th>I</th>
      <td>5078.532567</td>
      <td>3.01</td>
    </tr>
    <tr>
      <th>J</th>
      <td>4574.172638</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Ideal</th>
      <th>D</th>
      <td>2629.094566</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>E</th>
      <td>2597.550090</td>
      <td>2.28</td>
    </tr>
    <tr>
      <th>F</th>
      <td>3374.939362</td>
      <td>2.45</td>
    </tr>
    <tr>
      <th>G</th>
      <td>3720.706388</td>
      <td>2.54</td>
    </tr>
    <tr>
      <th>H</th>
      <td>3889.334831</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>I</th>
      <td>4451.970377</td>
      <td>3.22</td>
    </tr>
    <tr>
      <th>J</th>
      <td>4918.186384</td>
      <td>3.01</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Premium</th>
      <th>D</th>
      <td>3631.292576</td>
      <td>2.57</td>
    </tr>
    <tr>
      <th>E</th>
      <td>3538.914420</td>
      <td>3.05</td>
    </tr>
    <tr>
      <th>F</th>
      <td>4324.890176</td>
      <td>3.01</td>
    </tr>
    <tr>
      <th>G</th>
      <td>4500.742134</td>
      <td>3.01</td>
    </tr>
    <tr>
      <th>H</th>
      <td>5216.706780</td>
      <td>3.24</td>
    </tr>
    <tr>
      <th>I</th>
      <td>5946.180672</td>
      <td>4.01</td>
    </tr>
    <tr>
      <th>J</th>
      <td>6294.591584</td>
      <td>4.01</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">Very Good</th>
      <th>D</th>
      <td>3470.467284</td>
      <td>2.58</td>
    </tr>
    <tr>
      <th>E</th>
      <td>3214.652083</td>
      <td>2.51</td>
    </tr>
    <tr>
      <th>F</th>
      <td>3778.820240</td>
      <td>2.48</td>
    </tr>
    <tr>
      <th>G</th>
      <td>3872.753806</td>
      <td>2.52</td>
    </tr>
    <tr>
      <th>H</th>
      <td>4535.390351</td>
      <td>3.00</td>
    </tr>
    <tr>
      <th>I</th>
      <td>5255.879568</td>
      <td>4.00</td>
    </tr>
    <tr>
      <th>J</th>
      <td>5103.513274</td>
      <td>2.74</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 10. 9번 문제의 결과에서 가격의 평균이 5000이상이고 carat의 최대값이 3이상인 결과만 조회
result = dm.groupby(['cut','color']).agg({'price':'mean','carat':'max'})
result[(result['price'] >= 5000) & (result['carat'] >= 3)]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>price</th>
      <th>carat</th>
    </tr>
    <tr>
      <th>cut</th>
      <th>color</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fair</th>
      <th>H</th>
      <td>5135.683168</td>
      <td>4.13</td>
    </tr>
    <tr>
      <th>Good</th>
      <th>I</th>
      <td>5078.532567</td>
      <td>3.01</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Premium</th>
      <th>H</th>
      <td>5216.706780</td>
      <td>3.24</td>
    </tr>
    <tr>
      <th>I</th>
      <td>5946.180672</td>
      <td>4.01</td>
    </tr>
    <tr>
      <th>J</th>
      <td>6294.591584</td>
      <td>4.01</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <th>I</th>
      <td>5255.879568</td>
      <td>4.00</td>
    </tr>
  </tbody>
</table>
</div>


