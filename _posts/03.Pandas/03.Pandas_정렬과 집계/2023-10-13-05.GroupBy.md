---
layout: single
title: 'GroupBy'
typora-root-url: ../
categories: Pandas.03.정렬과집계
tag: Pandas
toc: true
---

# Groupby

- 특정 열을 기준으로 같은 값을 가지는 행끼리 묶어서 group화 한다.
- **~~ 별 집계를 할 때** 사용한다. (성별, 직급별, 등급별 ...)
- **구문**
    - `DF.groupby('그룹으로묶을기준컬럼')`
        - DataFrameGroupby 객체를 반환한다.
        - DataFrameGroupby 객체는 어떤 행끼리 묶여있는지 정보를 가진다. 이 객체의 집계함수를 사용하면 그룹별 집계를 할 수 있다.
            - `DataFrameGroupby객체['집계할 컬럼'].집계함수()`
        - groupby에 여러개의 컬럼을 기준으로 나눌 경우 리스트에 묶어서 전달한다.
        - 집계할 컬럼이 여러개인 경우 리스트로 묶어준다.
    - 집계함수
        - 기술통계 함수들
        - agg()/aggregate()
            - 여러 다른 집계함수 호출시(여러 집계를 같이 볼경우)
            - 사용자정의 집계함수 호출시
            - 컬럼별로 다른 집계함수들을 호출할 경우

```python
import pandas as pd
flight = pd.read_csv("data/flights.csv")
```




```python
flight['AIRLINE'].value_counts()
```




    AIRLINE
    DL    10601
    AA     8900
    WN     8418
    UA     7792
    OO     6588
    EV     5858
    MQ     3471
    US     1615
    NK     1516
    F9     1317
    VX      993
    AS      768
    B6      543
    HA      112
    Name: count, dtype: int64




```python
gb = flight.groupby("AIRLINE")
print(type(gb))
gb.groups
# {
#     'AA':[3, 6, 8, 15, 26, ...], #'AA': 고유값, [3, 6, 8, ..] : 행이름
# }
```

    <class 'pandas.core.groupby.generic.DataFrameGroupBy'>





    {'AA': [3, 6, 8, 15, 26, 32, 33, 36, 37, 41, 46, 47, 48, 55, 62, 66, 73, 75, 76, 87, 89, 97, 98, 107, 120, 122, 128, 131, 133, 146, 160, 171, 174, 178, 179, 188, 200, 201, 206, 221, 267, 270, 279, 305, 309, 311, 321, 330, 332, 342, 343, 347, 348, 380, 381, 382, 390, 393, 398, 402, 404, 405, 419, 427, 430, 431, 441, 449, 451, 455, 457, 466, 476, 491, 493, 497, 509, 514, 521, 527, 528, 537, 550, 551, 556, 560, 568, 572, 587, 589, 592, 612, 613, 618, 624, 626, 628, 634, 640, 652, ...], 'AS': [38, 198, 241, 277, 397, 450, 453, 500, 518, 591, 718, 737, 741, 808, 820, 867, 872, 1005, 1106, 1146, 1292, 1437, 1530, 1559, 1609, 1636, 1747, 1786, 1810, 1826, 1892, 1921, 2010, 2151, 2269, 2446, 2526, 2576, 2586, 2941, 3112, 3125, 3171, 3176, 3413, 3483, 3494, 3596, 3678, 3734, 3891, 3910, 3937, 3989, 4099, 4128, 4326, 4397, 4432, 4587, 4743, 4799, 4841, 4850, 4912, 4987, 5099, 5154, 5176, 5254, 5261, 5297, 5356, 5372, 5496, 5667, 5685, 5688, 5877, 5976, 6016, 6079, 6122, 6245, 6255, 6393, 6529, 6816, 6824, 6861, 6945, 6988, 7065, 7150, 7153, 7196, 7225, 7235, 7389, 7478, ...], 'B6': [123, 127, 239, 333, 548, 549, 696, 757, 945, 1175, 1361, 1453, 1547, 1561, 1564, 1650, 1670, 1691, 1800, 1939, 1998, 2251, 2253, 2256, 2330, 2385, 2434, 2607, 2650, 2692, 2721, 2781, 2800, 2884, 2936, 3060, 3306, 3648, 3793, 3983, 4347, 4552, 4578, 4639, 4779, 4820, 4885, 5036, 5125, 5131, 5205, 5211, 5228, 5260, 5351, 5483, 5577, 5585, 5777, 5956, 6126, 6151, 6418, 6901, 6952, 6977, 7792, 7798, 7853, 7877, 7904, 8030, 8082, 8091, 8118, 8145, 8177, 8364, 8507, 8541, 8543, 8558, 8732, 8828, 8912, 9093, 9173, 9275, 9371, 9389, 9447, 9482, 9574, 9686, 9896, 10066, 10254, 10416, 10600, 10727, ...], 'DL': [53, 57, 77, 79, 85, 90, 91, 101, 116, 117, 121, 129, 130, 137, 142, 152, 154, 155, 158, 159, 162, 165, 169, 172, 181, 182, 184, 185, 189, 190, 204, 207, 211, 215, 216, 222, 235, 238, 244, 245, 248, 249, 250, 253, 254, 258, 286, 289, 304, 307, 308, 310, 313, 323, 326, 328, 329, 336, 353, 354, 364, 373, 385, 395, 407, 411, 412, 413, 420, 433, 435, 439, 445, 456, 468, 481, 485, 490, 492, 508, 517, 526, 529, 531, 535, 543, 546, 559, 570, 579, 584, 588, 593, 602, 606, 607, 616, 617, 631, 642, ...], 'EV': [11, 13, 29, 40, 69, 100, 106, 118, 136, 143, 147, 164, 167, 170, 194, 196, 199, 205, 208, 219, 220, 225, 231, 233, 236, 251, 252, 261, 264, 265, 268, 282, 291, 293, 298, 312, 319, 337, 352, 362, 363, 369, 371, 383, 403, 414, 415, 424, 429, 437, 442, 443, 459, 460, 465, 470, 495, 499, 503, 505, 506, 522, 525, 530, 541, 567, 574, 580, 583, 632, 645, 654, 659, 677, 683, 689, 693, 695, 697, 714, 721, 723, 725, 730, 740, 742, 761, 764, 765, 768, 772, 776, 777, 778, 785, 787, 790, 791, 794, 799, ...], 'F9': [7, 93, 209, 232, 247, 290, 301, 386, 444, 483, 553, 563, 596, 598, 599, 605, 665, 685, 738, 844, 870, 948, 985, 1103, 1167, 1181, 1264, 1374, 1382, 1407, 1421, 1435, 1489, 1590, 1611, 1697, 1746, 1760, 1775, 1776, 1807, 1830, 1925, 1962, 2014, 2036, 2069, 2078, 2111, 2125, 2208, 2335, 2405, 2515, 2557, 2579, 2600, 2683, 2693, 2708, 2731, 2733, 2805, 2853, 2861, 3024, 3241, 3288, 3374, 3382, 3395, 3418, 3555, 3570, 3575, 3628, 3638, 3716, 3735, 3777, 3843, 3923, 3962, 3977, 4016, 4031, 4046, 4069, 4111, 4151, 4172, 4287, 4356, 4371, 4420, 4469, 4542, 4641, 4671, 4720, ...], 'HA': [582, 712, 878, 1053, 1269, 1345, 1544, 1864, 2316, 2644, 2681, 3002, 3165, 3227, 4359, 4414, 4926, 5187, 5281, 5320, 5363, 7267, 7372, 7744, 7808, 9360, 9761, 10163, 11119, 11626, 11743, 11809, 12275, 12752, 12780, 13466, 13755, 13956, 14566, 15064, 15316, 15959, 16501, 17632, 18467, 18720, 20461, 21558, 21761, 22454, 22584, 22592, 22618, 22858, 22892, 23177, 23374, 23773, 25763, 26127, 27745, 28864, 29608, 29762, 29875, 30610, 31164, 31505, 31530, 31675, 32030, 32037, 32987, 33311, 33747, 34884, 35959, 36068, 36319, 36425, 37119, 37128, 37664, 37983, 38440, 39475, 39482, 39625, 41664, 42165, 42485, 42846, 44068, 45330, 46713, 47772, 48279, 48722, 49667, 49782, ...], 'MQ': [2, 10, 18, 24, 50, 60, 71, 78, 81, 103, 105, 115, 125, 149, 180, 187, 210, 214, 228, 285, 296, 314, 320, 334, 335, 339, 341, 357, 458, 472, 484, 486, 488, 502, 516, 524, 534, 547, 581, 601, 622, 638, 639, 646, 661, 707, 711, 722, 727, 751, 769, 774, 802, 805, 830, 851, 854, 856, 865, 876, 915, 939, 955, 968, 977, 980, 1002, 1006, 1036, 1085, 1087, 1104, 1113, 1150, 1158, 1163, 1168, 1169, 1204, 1229, 1231, 1234, 1238, 1246, 1287, 1296, 1303, 1306, 1328, 1329, 1336, 1393, 1398, 1410, 1423, 1428, 1436, 1448, 1449, 1454, ...], 'NK': [17, 74, 95, 109, 166, 345, 358, 401, 434, 436, 446, 452, 482, 507, 510, 519, 533, 544, 610, 615, 620, 729, 735, 845, 858, 887, 898, 916, 970, 1017, 1095, 1097, 1153, 1188, 1208, 1257, 1342, 1392, 1536, 1579, 1580, 1657, 1732, 1761, 1863, 1943, 1948, 1990, 2026, 2068, 2071, 2118, 2124, 2149, 2177, 2196, 2214, 2244, 2299, 2334, 2378, 2424, 2425, 2447, 2523, 2537, 2592, 2613, 2639, 2643, 2740, 2749, 2752, 2764, 2765, 2770, 2786, 2875, 2886, 3018, 3061, 3065, 3072, 3151, 3153, 3174, 3248, 3315, 3381, 3435, 3566, 3598, 3674, 3696, 3701, 3708, 3840, 3877, 3894, 3934, ...], 'OO': [12, 16, 22, 25, 27, 34, 39, 42, 51, 52, 54, 58, 61, 63, 65, 82, 86, 99, 102, 113, 124, 126, 135, 138, 139, 151, 157, 161, 168, 175, 213, 223, 237, 240, 242, 255, 257, 278, 281, 284, 288, 297, 315, 317, 318, 322, 324, 327, 331, 359, 361, 366, 367, 370, 376, 378, 379, 387, 392, 418, 421, 447, 448, 540, 552, 554, 565, 569, 576, 590, 600, 603, 604, 609, 625, 629, 637, 649, 653, 658, 660, 663, 666, 671, 672, 673, 676, 679, 681, 682, 684, 691, 692, 708, 734, 754, 755, 762, 789, 793, ...], 'UA': [1, 5, 9, 14, 21, 44, 45, 67, 70, 72, 94, 108, 110, 134, 140, 141, 144, 145, 163, 177, 183, 192, 197, 246, 260, 262, 263, 266, 269, 273, 275, 283, 295, 325, 338, 340, 349, 368, 374, 375, 377, 389, 394, 396, 408, 423, 425, 438, 440, 462, 463, 469, 471, 474, 479, 501, 511, 512, 513, 520, 523, 536, 539, 542, 555, 557, 566, 573, 577, 586, 594, 595, 608, 621, 623, 630, 635, 636, 647, 650, 651, 667, 686, 687, 698, 699, 700, 701, 713, 717, 719, 745, 756, 773, 784, 801, 829, 836, 842, 843, ...], 'US': [31, 35, 49, 96, 104, 111, 112, 119, 148, 150, 153, 191, 202, 203, 224, 229, 355, 360, 372, 384, 391, 467, 473, 477, 478, 487, 494, 538, 545, 558, 561, 564, 575, 578, 619, 690, 715, 726, 728, 760, 795, 806, 881, 896, 901, 910, 954, 1028, 1033, 1068, 1134, 1135, 1143, 1155, 1164, 1201, 1210, 1245, 1274, 1288, 1290, 1291, 1335, 1355, 1377, 1399, 1406, 1446, 1459, 1462, 1470, 1471, 1476, 1481, 1493, 1499, 1503, 1552, 1554, 1565, 1589, 1593, 1603, 1661, 1680, 1716, 1731, 1733, 1735, 1743, 1749, 1754, 1755, 1758, 1767, 1773, 1790, 1821, 1904, 1905, ...], 'VX': [56, 227, 243, 417, 432, 464, 614, 641, 703, 759, 812, 825, 943, 1058, 1092, 1093, 1192, 1302, 1312, 1343, 1369, 1452, 1586, 1599, 1644, 1696, 1705, 1805, 1930, 1957, 2048, 2219, 2220, 2270, 2302, 2324, 2484, 2572, 2620, 2646, 2735, 2753, 2808, 2880, 2898, 2919, 3110, 3111, 3120, 3210, 3246, 3261, 3302, 3427, 3501, 3510, 3664, 3680, 3694, 3731, 3860, 3938, 3968, 4005, 4029, 4035, 4056, 4088, 4270, 4351, 4531, 4536, 4540, 4692, 4712, 4728, 4746, 4825, 4856, 4860, 4869, 4876, 4890, 4901, 4928, 4994, 5075, 5078, 5115, 5143, 5167, 5206, 5245, 5265, 5379, 5383, 5413, 5502, 5512, 5522, ...], 'WN': [0, 4, 19, 20, 23, 28, 30, 43, 59, 64, 68, 80, 83, 84, 88, 92, 114, 132, 156, 173, 176, 186, 193, 195, 212, 217, 218, 226, 230, 234, 256, 259, 271, 272, 274, 276, 280, 287, 292, 294, 299, 300, 302, 303, 306, 316, 344, 346, 350, 351, 356, 365, 388, 399, 400, 406, 409, 410, 416, 422, 426, 428, 454, 461, 475, 480, 489, 496, 498, 504, 515, 532, 562, 571, 585, 597, 611, 627, 633, 648, 657, 669, 670, 674, 678, 710, 720, 724, 731, 744, 747, 752, 753, 788, 797, 804, 807, 813, 815, 817, ...]}




```python
# 항공사별 도착지연시간의 평균?
flight.groupby("AIRLINE")["ARR_DELAY"].mean()
```




    AIRLINE
    AA     5.542661
    AS    -0.833333
    B6     8.692593
    DL     0.339691
    EV     7.034580
    F9    13.630651
    HA     4.972973
    MQ     6.860591
    NK    18.436070
    OO     7.593463
    UA     7.765755
    US     1.681105
    VX     5.348884
    WN     6.397353
    Name: ARR_DELAY, dtype: float64




```python
flight.groupby("AIRLINE").mean(numeric_only=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>6.661461</td>
      <td>15.570562</td>
      <td>3.986966</td>
      <td>1340.140449</td>
      <td>11.274057</td>
      <td>144.259404</td>
      <td>1114.347865</td>
      <td>1546.960899</td>
      <td>5.542661</td>
      <td>0.002921</td>
      <td>0.017303</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>6.197917</td>
      <td>15.247396</td>
      <td>3.941406</td>
      <td>1418.269531</td>
      <td>1.808594</td>
      <td>147.845052</td>
      <td>1065.884115</td>
      <td>1548.292969</td>
      <td>-0.833333</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>6.368324</td>
      <td>15.788214</td>
      <td>4.040516</td>
      <td>1512.924494</td>
      <td>14.287823</td>
      <td>209.412963</td>
      <td>1771.882136</td>
      <td>1432.889503</td>
      <td>8.692593</td>
      <td>0.003683</td>
      <td>0.001842</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>6.277332</td>
      <td>15.721158</td>
      <td>3.913310</td>
      <td>1426.563154</td>
      <td>7.242450</td>
      <td>115.334187</td>
      <td>866.448448</td>
      <td>1578.735402</td>
      <td>0.339691</td>
      <td>0.002264</td>
      <td>0.003585</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>6.003926</td>
      <td>15.866166</td>
      <td>3.927450</td>
      <td>1415.510413</td>
      <td>9.092625</td>
      <td>68.964016</td>
      <td>460.237453</td>
      <td>1571.798054</td>
      <td>7.034580</td>
      <td>0.002561</td>
      <td>0.024923</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>6.401670</td>
      <td>15.914958</td>
      <td>4.007593</td>
      <td>1407.121488</td>
      <td>14.310398</td>
      <td>127.592337</td>
      <td>969.593014</td>
      <td>1510.177677</td>
      <td>13.630651</td>
      <td>0.001519</td>
      <td>0.007593</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>5.508929</td>
      <td>15.526786</td>
      <td>3.750000</td>
      <td>959.419643</td>
      <td>2.571429</td>
      <td>338.288288</td>
      <td>2615.178571</td>
      <td>1280.714286</td>
      <td>4.972973</td>
      <td>0.008929</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>5.970614</td>
      <td>15.598963</td>
      <td>3.902622</td>
      <td>1432.251801</td>
      <td>11.094323</td>
      <td>61.318346</td>
      <td>404.229041</td>
      <td>1587.835494</td>
      <td>6.860591</td>
      <td>0.001441</td>
      <td>0.043791</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>6.602243</td>
      <td>15.680739</td>
      <td>4.006596</td>
      <td>1336.634565</td>
      <td>19.514401</td>
      <td>135.736878</td>
      <td>1047.428100</td>
      <td>1398.226913</td>
      <td>18.436070</td>
      <td>0.003298</td>
      <td>0.016491</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>6.134791</td>
      <td>15.651943</td>
      <td>3.923345</td>
      <td>1426.486794</td>
      <td>9.662279</td>
      <td>76.010272</td>
      <td>511.239375</td>
      <td>1573.730267</td>
      <td>7.593463</td>
      <td>0.003188</td>
      <td>0.021554</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>6.322510</td>
      <td>15.697510</td>
      <td>3.871535</td>
      <td>1357.970739</td>
      <td>16.210485</td>
      <td>155.650521</td>
      <td>1230.918891</td>
      <td>1532.871150</td>
      <td>7.765755</td>
      <td>0.002438</td>
      <td>0.011935</td>
    </tr>
    <tr>
      <th>US</th>
      <td>3.628483</td>
      <td>16.079876</td>
      <td>4.063777</td>
      <td>1289.552941</td>
      <td>4.361355</td>
      <td>147.686755</td>
      <td>1181.226625</td>
      <td>1489.131269</td>
      <td>1.681105</td>
      <td>0.000619</td>
      <td>0.013003</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>6.336354</td>
      <td>15.518630</td>
      <td>3.924471</td>
      <td>1385.110775</td>
      <td>8.918946</td>
      <td>154.864097</td>
      <td>1240.296073</td>
      <td>1581.023162</td>
      <td>5.348884</td>
      <td>0.001007</td>
      <td>0.006042</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>6.298646</td>
      <td>15.746971</td>
      <td>3.884652</td>
      <td>1370.585650</td>
      <td>12.639366</td>
      <td>107.005897</td>
      <td>809.985626</td>
      <td>1532.243407</td>
      <td>6.397353</td>
      <td>0.001782</td>
      <td>0.011048</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 항공사별 출발/도착 지연시간의 평균
### df.groupby()[집계할 컬럼].집계메소드
flight.groupby("AIRLINE")[['DEP_DELAY', 'ARR_DELAY']].mean()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>11.274057</td>
      <td>5.542661</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>1.808594</td>
      <td>-0.833333</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>14.287823</td>
      <td>8.692593</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>7.242450</td>
      <td>0.339691</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>9.092625</td>
      <td>7.034580</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>14.310398</td>
      <td>13.630651</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>2.571429</td>
      <td>4.972973</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>11.094323</td>
      <td>6.860591</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>19.514401</td>
      <td>18.436070</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>9.662279</td>
      <td>7.593463</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>16.210485</td>
      <td>7.765755</td>
    </tr>
    <tr>
      <th>US</th>
      <td>4.361355</td>
      <td>1.681105</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>8.918946</td>
      <td>5.348884</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>12.639366</td>
      <td>6.397353</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 출발 공항별 출발지연시간의 최소값, 최대값
flight.groupby("ORG_AIR")['DEP_DELAY'].agg(["min", "max", min_max_diff])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>min_max_diff</th>
    </tr>
    <tr>
      <th>ORG_AIR</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATL</th>
      <td>-18.0</td>
      <td>702.0</td>
      <td>720.0</td>
    </tr>
    <tr>
      <th>DEN</th>
      <td>-18.0</td>
      <td>1194.0</td>
      <td>1212.0</td>
    </tr>
    <tr>
      <th>DFW</th>
      <td>-16.0</td>
      <td>852.0</td>
      <td>868.0</td>
    </tr>
    <tr>
      <th>IAH</th>
      <td>-17.0</td>
      <td>835.0</td>
      <td>852.0</td>
    </tr>
    <tr>
      <th>LAS</th>
      <td>-21.0</td>
      <td>751.0</td>
      <td>772.0</td>
    </tr>
    <tr>
      <th>LAX</th>
      <td>-24.0</td>
      <td>746.0</td>
      <td>770.0</td>
    </tr>
    <tr>
      <th>MSP</th>
      <td>-17.0</td>
      <td>461.0</td>
      <td>478.0</td>
    </tr>
    <tr>
      <th>ORD</th>
      <td>-16.0</td>
      <td>511.0</td>
      <td>527.0</td>
    </tr>
    <tr>
      <th>PHX</th>
      <td>-22.0</td>
      <td>555.0</td>
      <td>577.0</td>
    </tr>
    <tr>
      <th>SFO</th>
      <td>-20.0</td>
      <td>684.0</td>
      <td>704.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight.groupby('ORG_AIR').agg({"DEP_DELAY":"mean", "ARR_DELAY":"min"})
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>DEP_DELAY</th>
      <th>ARR_DELAY</th>
    </tr>
    <tr>
      <th>ORG_AIR</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ATL</th>
      <td>9.267446</td>
      <td>-57.0</td>
    </tr>
    <tr>
      <th>DEN</th>
      <td>11.052586</td>
      <td>-44.0</td>
    </tr>
    <tr>
      <th>DFW</th>
      <td>11.593030</td>
      <td>-45.0</td>
    </tr>
    <tr>
      <th>IAH</th>
      <td>11.821255</td>
      <td>-47.0</td>
    </tr>
    <tr>
      <th>LAS</th>
      <td>10.792156</td>
      <td>-52.0</td>
    </tr>
    <tr>
      <th>LAX</th>
      <td>10.961690</td>
      <td>-58.0</td>
    </tr>
    <tr>
      <th>MSP</th>
      <td>7.206256</td>
      <td>-53.0</td>
    </tr>
    <tr>
      <th>ORD</th>
      <td>14.760098</td>
      <td>-52.0</td>
    </tr>
    <tr>
      <th>PHX</th>
      <td>8.502841</td>
      <td>-60.0</td>
    </tr>
    <tr>
      <th>SFO</th>
      <td>11.028730</td>
      <td>-51.0</td>
    </tr>
  </tbody>
</table>
</div>



##  복수열 기준 그룹핑
- 두개 이상의 열을 그룹으로 묶을 수 있다. 
- groupby의 매개변수에 그룹으로 묶을 컬럼들의 이름을 리스트로 전달한다.

```python
import pandas as pd
flight = pd.read_csv("data/flights.csv")
```




```python
# 월, 요일별 도착지연시간의 평균 --> groupby로 묶을 기준컬럼이 2개이상.
result = flight.groupby(["MONTH", "WEEKDAY"])['ARR_DELAY'].mean()
result
```




    MONTH  WEEKDAY
    1      1          12.202723
           2           3.615756
           3           2.478328
           4           6.715006
           5           6.082635
                        ...    
    12     3          10.780822
           4           3.693069
           5           1.754947
           6           4.962775
           7           8.437898
    Name: ARR_DELAY, Length: 77, dtype: float64



## Group 별 집계결과에서 특정 조건의 항목만 조회
- Groupby 집계 후 boolean indexing 처리한다.



```python
# 결측치가 아닌 값의 개수
flight['CANCELLED'].count() 
```




    58492




```python
# 1(취소)의 합계
flight["CANCELLED"].sum()   
```




    881




```python
# 취소안된 것 건수
(flight['CANCELLED'] == 0).sum()
```




    57611




```python
# 항공사별 (출발) 취소 건수. 100 회이상인 항공사만 조회
result = flight.groupby("AIRLINE")['CANCELLED'].sum()
result[result >= 100]
```




    AIRLINE
    AA    154
    EV    146
    MQ    152
    OO    142
    Name: CANCELLED, dtype: int64
