---
layout: single
title: '변수와 연산자'
typora-root-url: ../
---

# Filter()
- `DataFrameGroupBy.filter(func, dropna=True, *args, **kwargs)`
- 특정 조건을 만족하는 Group의 데이터(행)들을 조회할 때 사용한다. 주로 조건은 group별 집계결과를 이용한다.
    1. 함수에 group별 DataFrame을 argument로 전달한다.
    2. 함수는 받은 DataFrame을 이용해 집계한 값의 조건을 비교해서 반환한다.(반환타입: Bool) 
    3. 반환값이 True인 Group들의 모든 행들로 구성된 DataFrame을 반환한다.
- 매개변수
    - **func**: filtering 조건을 구현한 함수 객체
        - 첫번째 매개변수로 Group으로 묶인 DataFrame을 받는다.
        - bool type 값을 반환한다. 매개변수로 받은 DataFrame이 특정 조건을 만족하는지 여부를 반환한다.
    - **dropna=True**
        - 필터를 통과하지 못한 group의 DataFrame의 값들을 drop시킨다(기본값). False로 설정하면 NA 처리해서 반환한다.
    - **\*args, \*\*kwargs**: filter 함수의 두번째부터  선언된 매개변수에 전달할 argument 값들을 가변인자로 전달한다.


```python
import numpy as np
import pandas as pd

# cnt1 값의 범위: 사과: 10대, 귤: 20대, 배: 단단위, 딸기 30이상
data = dict(fruits=['사과', '사과','사과', '사과','사과','귤','귤','귤','귤','귤','배','배','배','배','배','딸기','딸기','딸기','딸기','딸기']
            ,cnt1=[10, 12, 13, 11, 12, 21, 22, 27, 24, 26, 7, 7, 8, 3, 2, 30, 35, 37, 41, 28]
            ,cnt2=[100,  103, 107, 107,  101,  51,  57, 58,  57, 51,  9, 9,  5,  7,  7,  208, 217, 213, 206, 204]
           )
df = pd.DataFrame(data)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
    </tr>
  </tbody>
</table>
</div>




```python
# cnt1의 값이 과일변 평균 이상인 값을 가지는 행들을 조회.
## 자기가 속한 group의 평균보다 큰값을 가지는 행들을 조회.
```


```python
df.groupby('fruits').filter(함수:조건을 체크하는 함수)
```


```python
# 조건을 체크하는 함수
## 파라미터 한개 이상을 정의 -> 첫번째 파라미터: group별 DataFrame을 받을 변수
```


```python
def check_mean(x):
    # x : DataFrame
    # 집계에대한 조건처리
    # return 값 : bool
    return x['cnt1'].mean() > 20
```


```python
# cnt1의 평균이 20 이상인(check_mean) 과일들의 행을 조회 ==> filter()
df.groupby('fruits').filter(check_mean)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.groupby('fruits')['cnt1'].mean() 
```




    fruits
    귤     24.0
    딸기    34.2
    배      5.4
    사과    11.6
    Name: cnt1, dtype: float64



 -  filter 함수
 - 1번째 파라미터(필수): DataFrame(group별), 2번째 부터는 필요한대로 선언. 반환값 : bool True가 리턴되는 DataFrame들 결과값


```python
# x ['col_name'].mean() >= threshold
def check_mean2(x, col_name, threshold):
    return x[col_name].mean() >= threshold
```


```python
df.groupby('fruits').filter(check_mean2, col_name='cnt1', threshold=5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
    </tr>
  </tbody>
</table>
</div>




```python
# dropna : 조건이 False인 행들을 결측치 처리
df.groupby('fruits').filter(lambda x: x['cnt1'].mean() >= 20, dropna=False)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22.0</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27.0</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24.0</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>14</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30.0</td>
      <td>208.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35.0</td>
      <td>217.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37.0</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41.0</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28.0</td>
      <td>204.0</td>
    </tr>
  </tbody>
</table>
</div>



# Transform
- `DataFrameGroupBy.transform(func, *args)`, `SeriesGroupBy.transform(func, *args)`
    - 함수(func)에 열의 값들을 group 별로 전달 한다. 함수는 그 값을 받아 통계량을 구해 반환한다. 반환된 통계량으로 원래 값들을 변경한 Series를 반환한다. 여러 컬럼에 대해 처리할 경우 DataFrame을 반환한다.
    - func: 함수객체
        - 매개변수
            - 그룹별 컬럼값들을 받을 변수 선언
        - return
            - 계산한 통계량.
        - DataFrameGroupBy은 모든 컬럼의 값들을 group 별 Series로 전달한다.
    - *args: 함수에 전달할 추가 인자값이 있으면 매개변수 순서에 맞게 값을 전달한다.
- transform() 함수를 groupby() 와 사용하면 컬럼의 각 원소들을 자신이 속한 그룹의 통계량으로 변환된 데이터셋을 생성할 수 있다.
- 컬럼의 값과 통계값을 비교해서 보거나 결측치 처리등에 사용할 수있다.


```python
# 판다스 제공 집계함수 : 문자열로 전달.
df.groupby('fruits')['cnt1'].transform('mean') 
```




    0     11.6
    1     11.6
    2     11.6
    3     11.6
    4     11.6
    5     24.0
    6     24.0
    7     24.0
    8     24.0
    9     24.0
    10     5.4
    11     5.4
    12     5.4
    13     5.4
    14     5.4
    15    34.2
    16    34.2
    17    34.2
    18    34.2
    19    34.2
    Name: cnt1, dtype: float64




```python
df2 = df.copy()
df2.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
    </tr>
  </tbody>
</table>
</div>



## 원본에 통계치 붙여서 비교하기


```python
result = df2.groupby('fruits')['cnt1'].transform('mean')
result
```




    0     11.6
    1     11.6
    2     11.6
    3     11.6
    4     11.6
    5     24.0
    6     24.0
    7     24.0
    8     24.0
    9     24.0
    10     5.4
    11     5.4
    12     5.4
    13     5.4
    14     5.4
    15    34.2
    16    34.2
    17    34.2
    18    34.2
    19    34.2
    Name: cnt1, dtype: float64




```python
df2.insert(2, 'cnt1 과일별 평균', result)
```


```python
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt1 과일별 평균</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>11.6</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>11.6</td>
      <td>103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>11.6</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>11.6</td>
      <td>107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>11.6</td>
      <td>101</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>24.0</td>
      <td>51</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>24.0</td>
      <td>57</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>24.0</td>
      <td>58</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>24.0</td>
      <td>57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>24.0</td>
      <td>51</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>5.4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>5.4</td>
      <td>9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5.4</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>5.4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>5.4</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>34.2</td>
      <td>208</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>34.2</td>
      <td>217</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>34.2</td>
      <td>213</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>34.2</td>
      <td>206</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>34.2</td>
      <td>204</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2['cnt2 과일별평균 '] = df2.groupby('fruits')['cnt2'].transform('mean')
```


```python
df2
```


```python
# 행 섞기
## df.sample(): DataFrame의 데이터를 sampling(표본추출) -> 일부 데이터만 추출
#         - 전체 데이터를 섞은 다음에 지정한 비율/개수 만큼 추출
#         - frac = 추출한 비율( 0 ~ 1 실수) / 개수 (정수)
df3 = df.sample(frac=1.0).reset_index(drop=True)
```


```python
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>4</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
    </tr>
    <tr>
      <th>5</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
    </tr>
    <tr>
      <th>7</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
    </tr>
    <tr>
      <th>9</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>11</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
    </tr>
    <tr>
      <th>14</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
    </tr>
    <tr>
      <th>15</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
    </tr>
    <tr>
      <th>16</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
    </tr>
    <tr>
      <th>17</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>18</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
    </tr>
  </tbody>
</table>
</div>




```python
df3['cnt2 mean'] = df3.groupby('fruits')['cnt2'].transform('mean')
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
      <th>cnt2 mean</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
      <td>54.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>2</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
      <td>209.6</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
      <td>103.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
      <td>209.6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
      <td>54.8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>8</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
      <td>209.6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
      <td>103.6</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>11</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
      <td>54.8</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
      <td>7.4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
      <td>103.6</td>
    </tr>
    <tr>
      <th>14</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
      <td>209.6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
      <td>103.6</td>
    </tr>
    <tr>
      <th>16</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
      <td>103.6</td>
    </tr>
    <tr>
      <th>17</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
      <td>54.8</td>
    </tr>
    <tr>
      <th>18</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
      <td>54.8</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
      <td>209.6</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 최대 최소 값의 차이
def min_max_diff(x):
    # transform에 전달할 함수 -> 파라미터 : Series
    # 반환값 : 처리한 값.
    return x.max() - x.min()
    
```


```python
df3.groupby('fruits')['cnt1'].agg(min_max_diff)
```




    fruits
    귤      6
    딸기    13
    배      6
    사과     3
    Name: cnt1, dtype: int64




```python
df3['min_max'] = df3.groupby('fruits')['cnt1'].transform(min_max_diff)
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
      <th>cnt2 mean</th>
      <th>min_max</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
      <td>54.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
      <td>7.4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
      <td>209.6</td>
      <td>13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
      <td>103.6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
      <td>209.6</td>
      <td>13</td>
    </tr>
    <tr>
      <th>5</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
      <td>7.4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
      <td>54.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
      <td>7.4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>8</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
      <td>209.6</td>
      <td>13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
      <td>103.6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
      <td>7.4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>11</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
      <td>54.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
      <td>7.4</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
      <td>103.6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
      <td>209.6</td>
      <td>13</td>
    </tr>
    <tr>
      <th>15</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
      <td>103.6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
      <td>103.6</td>
      <td>3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
      <td>54.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>18</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
      <td>54.8</td>
      <td>6</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
      <td>209.6</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>




```python
df3['min_max2'] = df3.groupby('fruits')['cnt1'].transform(lambda x : x.max() - x.min())
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
      <th>cnt2 mean</th>
      <th>min_max</th>
      <th>min_max2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
      <td>54.8</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
      <td>7.4</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
      <td>209.6</td>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
      <td>103.6</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
      <td>209.6</td>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <th>5</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
      <td>7.4</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
      <td>54.8</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>7</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
      <td>7.4</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>8</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
      <td>209.6</td>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <th>9</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
      <td>103.6</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
      <td>7.4</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>11</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
      <td>54.8</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
      <td>7.4</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>13</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
      <td>103.6</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>14</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
      <td>209.6</td>
      <td>13</td>
      <td>13</td>
    </tr>
    <tr>
      <th>15</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
      <td>103.6</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
      <td>103.6</td>
      <td>3</td>
      <td>3</td>
    </tr>
    <tr>
      <th>17</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
      <td>54.8</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>18</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
      <td>54.8</td>
      <td>6</td>
      <td>6</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
      <td>209.6</td>
      <td>13</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
</div>



# 결측치 처리
 - transform이용해서 결측치를 같은 과일별 평균값을 변환
   - 전체 평균보다 좀더 정확할 수 있다.


```python
import pandas as pd
s = pd.Series([10, 20, np.nan, 30, np.nan])

s
```




    0    10.0
    1    20.0
    2     NaN
    3    30.0
    4     NaN
    dtype: float64




```python
# 결측치를 제거 - dropna()
# 결측치를 다른값으로 대체 - fillna(대체할 값)
s.fillna(1000) # 모든 결측치를 1000 으로 대체
```




    0      10.0
    1      20.0
    2    1000.0
    3      30.0
    4    1000.0
    dtype: float64




```python
replace_value = pd.Series([10000,20000,30000,40000,50000])
replace_value
```




    0    10000
    1    20000
    2    30000
    3    40000
    4    50000
    dtype: int64




```python
# s의 결측치를 같은 index의 replace_value값으로 변경. 결측치가 아닌 값들은 변경안됨.
s.fillna(replace_value) 
```




    0       10.0
    1       20.0
    2    30000.0
    3       30.0
    4    50000.0
    dtype: float64




```python
# fillna() 상수 : 결측치를 상수로 변경
#          dictonary, series, dataframe(대상이 dataframe) - index별로 다른 값으로 대체.
s.fillna({2:10000, 4:50000})
```




    0       10.0
    1       20.0
    2    10000.0
    3       30.0
    4    50000.0
    dtype: float64




```python
df4 = df.copy()
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>100</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>103</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>51</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>57</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>9</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>208</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>217</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204</td>
    </tr>
  </tbody>
</table>
</div>




```python
df4.loc[[0,1,5,6,10,11,15,16], 'cnt2'] = np.nan
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 결측치 제거
## 제거: DataFrame: 행/열 단위로 제. Default: 행
df4.dropna()#(axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 다른 값으로 대체
## 컬럼과 상관없이 모든 결측치를 동일한 값으로 변경
df4.fillna(1000) 
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df4['cnt2'].median()
```




    79.5




```python
# 결측치를 대체(가장 가능성 높은값으로 변경. => 평균/중앙값, 최빈값)
## 전체 cnt2를 기준으로 평균을 게산해서 결측치를 대체. => 특정 카테고리별로(과일) 평균값의 차이가 클경우 전체평균은 유용한 결측치 대체값이 아니다.

df4['cnt2_1'] = df4['cnt2'].fillna(round(df4['cnt2'].mean()))
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
      <th>cnt2_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107.0</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107.0</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101.0</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58.0</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57.0</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51.0</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5.0</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>NaN</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213.0</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206.0</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204.0</td>
      <td>204.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df4.groupby('fruits')['cnt2'].mean()
```




    fruits
    귤      55.333333
    딸기    207.666667
    배       6.333333
    사과    105.000000
    Name: cnt2, dtype: float64




```python
# 카테고리별로 평균을 구해 그 카테고리의 결측치 대체 값으로 사용한다.
m = df4.groupby('fruits')['cnt2'].transform('mean')
df4['cnt2'] = df4['cnt2'].fillna(m)
```


```python
df4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fruits</th>
      <th>cnt1</th>
      <th>cnt2</th>
      <th>cnt2_1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>사과</td>
      <td>10</td>
      <td>105.000000</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>사과</td>
      <td>12</td>
      <td>105.000000</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>사과</td>
      <td>13</td>
      <td>107.000000</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>사과</td>
      <td>11</td>
      <td>107.000000</td>
      <td>107.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>사과</td>
      <td>12</td>
      <td>101.000000</td>
      <td>101.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>귤</td>
      <td>21</td>
      <td>55.333333</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>귤</td>
      <td>22</td>
      <td>55.333333</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>귤</td>
      <td>27</td>
      <td>58.000000</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>귤</td>
      <td>24</td>
      <td>57.000000</td>
      <td>57.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>귤</td>
      <td>26</td>
      <td>51.000000</td>
      <td>51.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>배</td>
      <td>7</td>
      <td>6.333333</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>배</td>
      <td>7</td>
      <td>6.333333</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>배</td>
      <td>8</td>
      <td>5.000000</td>
      <td>5.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>배</td>
      <td>3</td>
      <td>7.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>배</td>
      <td>2</td>
      <td>7.000000</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>딸기</td>
      <td>30</td>
      <td>207.666667</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>딸기</td>
      <td>35</td>
      <td>207.666667</td>
      <td>94.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>딸기</td>
      <td>37</td>
      <td>213.000000</td>
      <td>213.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>딸기</td>
      <td>41</td>
      <td>206.000000</td>
      <td>206.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>딸기</td>
      <td>28</td>
      <td>204.000000</td>
      <td>204.0</td>
    </tr>
  </tbody>
</table>
</div>



<b style='font-size:2em'>TODO </b>


```python
# 1.  data/diamonds.csv 조회
import pandas as pd
dia = pd.read_csv('data/diamonds.csv')

dia.shape
```




    (53940, 10)




```python
# 2.  cut 별 평균 가격이 4000 이상인 diamond 데이터들 조회 
dia.groupby('cut').filter(lambda x : x['price'].mean() > 4000)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.22</td>
      <td>Fair</td>
      <td>E</td>
      <td>VS2</td>
      <td>65.1</td>
      <td>61.0</td>
      <td>337</td>
      <td>3.87</td>
      <td>3.78</td>
      <td>2.49</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.22</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI1</td>
      <td>60.4</td>
      <td>61.0</td>
      <td>342</td>
      <td>3.88</td>
      <td>3.84</td>
      <td>2.33</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.20</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI2</td>
      <td>60.2</td>
      <td>62.0</td>
      <td>345</td>
      <td>3.79</td>
      <td>3.75</td>
      <td>2.27</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53928</th>
      <td>0.79</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.4</td>
      <td>58.0</td>
      <td>2756</td>
      <td>6.03</td>
      <td>5.96</td>
      <td>3.68</td>
    </tr>
    <tr>
      <th>53930</th>
      <td>0.71</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>60.5</td>
      <td>55.0</td>
      <td>2756</td>
      <td>5.79</td>
      <td>5.74</td>
      <td>3.49</td>
    </tr>
    <tr>
      <th>53931</th>
      <td>0.71</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>62.0</td>
      <td>2756</td>
      <td>5.74</td>
      <td>5.73</td>
      <td>3.43</td>
    </tr>
    <tr>
      <th>53934</th>
      <td>0.72</td>
      <td>Premium</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.7</td>
      <td>59.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.73</td>
      <td>3.58</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
  </tbody>
</table>
<p>15401 rows × 10 columns</p>
</div>




```python
# x <- cut별 DataFrame이 전달
result = dia.groupby('cut').filter(lambda x : x['price'].mean() > 4000)
result['cut'].unique()
```




    array(['Premium', 'Fair'], dtype=object)




```python
# 3. color 별 carat의 최대값과 최소값의 차이가 2이상 3미만인 모든 diamond 데이터들 조회
def max_min_diff(dataframe):
    min_v = dataframe['carat'].min()
    max_v = dataframe['carat'].max()
    diff = max_v - min_v
    return diff >= 2 and diff < 3

result = dia.groupby('color').filter(max_min_diff)
```


```python
# dataframe <- E, I, J, H, F, G, D 가 하나씩들어간다
dia['color'].unique()
```




    array(['E', 'I', 'J', 'H', 'F', 'G', 'D'], dtype=object)




```python
result.color.unique()
```




    array(['E', 'F', 'G'], dtype=object)




```python
dia.groupby('color')['carat'].agg(['min','max', lambda x : x.max() - x.min()])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
      <th>&lt;lambda_0&gt;</th>
    </tr>
    <tr>
      <th>color</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>D</th>
      <td>0.20</td>
      <td>3.40</td>
      <td>3.20</td>
    </tr>
    <tr>
      <th>E</th>
      <td>0.20</td>
      <td>3.05</td>
      <td>2.85</td>
    </tr>
    <tr>
      <th>F</th>
      <td>0.20</td>
      <td>3.01</td>
      <td>2.81</td>
    </tr>
    <tr>
      <th>G</th>
      <td>0.23</td>
      <td>3.01</td>
      <td>2.78</td>
    </tr>
    <tr>
      <th>H</th>
      <td>0.23</td>
      <td>4.13</td>
      <td>3.90</td>
    </tr>
    <tr>
      <th>I</th>
      <td>0.23</td>
      <td>4.01</td>
      <td>3.78</td>
    </tr>
    <tr>
      <th>J</th>
      <td>0.23</td>
      <td>5.01</td>
      <td>4.78</td>
    </tr>
  </tbody>
</table>
</div>




```python
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.22</td>
      <td>Fair</td>
      <td>E</td>
      <td>VS2</td>
      <td>65.1</td>
      <td>61.0</td>
      <td>337</td>
      <td>3.87</td>
      <td>3.78</td>
      <td>2.49</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.22</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI1</td>
      <td>60.4</td>
      <td>61.0</td>
      <td>342</td>
      <td>3.88</td>
      <td>3.84</td>
      <td>2.33</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53929</th>
      <td>0.71</td>
      <td>Ideal</td>
      <td>G</td>
      <td>VS1</td>
      <td>61.4</td>
      <td>56.0</td>
      <td>2756</td>
      <td>5.76</td>
      <td>5.73</td>
      <td>3.53</td>
    </tr>
    <tr>
      <th>53930</th>
      <td>0.71</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>60.5</td>
      <td>55.0</td>
      <td>2756</td>
      <td>5.79</td>
      <td>5.74</td>
      <td>3.49</td>
    </tr>
    <tr>
      <th>53931</th>
      <td>0.71</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>62.0</td>
      <td>2756</td>
      <td>5.74</td>
      <td>5.73</td>
      <td>3.43</td>
    </tr>
    <tr>
      <th>53932</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>E</td>
      <td>VS2</td>
      <td>60.5</td>
      <td>59.0</td>
      <td>2757</td>
      <td>5.71</td>
      <td>5.76</td>
      <td>3.47</td>
    </tr>
    <tr>
      <th>53933</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>E</td>
      <td>VS2</td>
      <td>61.2</td>
      <td>59.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.72</td>
      <td>3.49</td>
    </tr>
  </tbody>
</table>
<p>30631 rows × 10 columns</p>
</div>




```python
# 4. clarity 별 평균 가격 컬럼을 DataFrame에 추가.
```


```python
dia.columns
```




    Index(['carat', 'cut', 'color', 'clarity', 'depth', 'table', 'price', 'x', 'y',
           'z'],
          dtype='object')




```python
r = dia.groupby('clarity')['price'].transform('mean')
dia.insert(7, 'price_mean', r)
```


```python
dia.head(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>price_mean</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>5063.028606</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3996.001148</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>3839.455391</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>3924.989395</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>5063.028606</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.24</td>
      <td>Very Good</td>
      <td>J</td>
      <td>VVS2</td>
      <td>62.8</td>
      <td>57.0</td>
      <td>336</td>
      <td>3283.737071</td>
      <td>3.94</td>
      <td>3.96</td>
      <td>2.48</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.24</td>
      <td>Very Good</td>
      <td>I</td>
      <td>VVS1</td>
      <td>62.3</td>
      <td>57.0</td>
      <td>336</td>
      <td>2523.114637</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.47</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.26</td>
      <td>Very Good</td>
      <td>H</td>
      <td>SI1</td>
      <td>61.9</td>
      <td>55.0</td>
      <td>337</td>
      <td>3996.001148</td>
      <td>4.07</td>
      <td>4.11</td>
      <td>2.53</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.22</td>
      <td>Fair</td>
      <td>E</td>
      <td>VS2</td>
      <td>65.1</td>
      <td>61.0</td>
      <td>337</td>
      <td>3924.989395</td>
      <td>3.87</td>
      <td>3.78</td>
      <td>2.49</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.23</td>
      <td>Very Good</td>
      <td>H</td>
      <td>VS1</td>
      <td>59.4</td>
      <td>61.0</td>
      <td>338</td>
      <td>3839.455391</td>
      <td>4.00</td>
      <td>4.05</td>
      <td>2.39</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.30</td>
      <td>Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>64.0</td>
      <td>55.0</td>
      <td>339</td>
      <td>3996.001148</td>
      <td>4.25</td>
      <td>4.28</td>
      <td>2.73</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>J</td>
      <td>VS1</td>
      <td>62.8</td>
      <td>56.0</td>
      <td>340</td>
      <td>3839.455391</td>
      <td>3.93</td>
      <td>3.90</td>
      <td>2.46</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0.22</td>
      <td>Premium</td>
      <td>F</td>
      <td>SI1</td>
      <td>60.4</td>
      <td>61.0</td>
      <td>342</td>
      <td>3996.001148</td>
      <td>3.88</td>
      <td>3.84</td>
      <td>2.33</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.31</td>
      <td>Ideal</td>
      <td>J</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>54.0</td>
      <td>344</td>
      <td>5063.028606</td>
      <td>4.35</td>
      <td>4.37</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.20</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI2</td>
      <td>60.2</td>
      <td>62.0</td>
      <td>345</td>
      <td>5063.028606</td>
      <td>3.79</td>
      <td>3.75</td>
      <td>2.27</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.32</td>
      <td>Premium</td>
      <td>E</td>
      <td>I1</td>
      <td>60.9</td>
      <td>58.0</td>
      <td>345</td>
      <td>3924.168691</td>
      <td>4.38</td>
      <td>4.42</td>
      <td>2.68</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.30</td>
      <td>Ideal</td>
      <td>I</td>
      <td>SI2</td>
      <td>62.0</td>
      <td>54.0</td>
      <td>348</td>
      <td>5063.028606</td>
      <td>4.31</td>
      <td>4.34</td>
      <td>2.68</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.30</td>
      <td>Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>63.4</td>
      <td>54.0</td>
      <td>351</td>
      <td>3996.001148</td>
      <td>4.23</td>
      <td>4.29</td>
      <td>2.70</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.30</td>
      <td>Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>63.8</td>
      <td>56.0</td>
      <td>351</td>
      <td>3996.001148</td>
      <td>4.23</td>
      <td>4.26</td>
      <td>2.71</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.30</td>
      <td>Very Good</td>
      <td>J</td>
      <td>SI1</td>
      <td>62.7</td>
      <td>59.0</td>
      <td>351</td>
      <td>3996.001148</td>
      <td>4.21</td>
      <td>4.27</td>
      <td>2.66</td>
    </tr>
  </tbody>
</table>
</div>



# Pivot_table()
엑셀의 pivot table 기능을 제공하는 메소드.    
분류별 집계(Group으로 묶어 집계)를 처리하는 함수로 group으로 묶고자 하는 컬럼들을 행과 열로 위치시키고 집계값을 값으로 보여준다.    
역할은 `groupby()`를 이용한 집계와 같은데 **여러개 컬럼을 기준으로 groupby 를 할 경우 집계결과를 읽는 것이 더 편하다.(가독성이 좋다)**

> pivot() 함수와 역할이 다르다.   
> pivot() 은 index와 column의 형태를 바꾸는 reshape 함수.

- `DataFrame.pivot_table(values=None, index=None, columns=None, aggfunc='mean', fill_value=None, margins=False, dropna=True, margins_name='All')`
- **매개변수**
    - **index**
        - 문자열 또는 리스트. index로 올 컬럼들 => groupby였으면 묶었을 컬럼
    - **columns**
        - 문자열 또는 리스트. column으로 올 컬럼들 => groupby였으면 묶었을 컬럼 (index/columns가 묶여서 groupby에 묶을 컬럼들이 된다.)
    - **values**
        - 문자열 또는 리스트. 집계할 대상 컬럼들
    - **aggfunc**
        - 집계함수 지정. 함수, 함수이름문자열, 함수리스트(함수이름 문자열/함수객체), dict: 집계할 함수
        - 기본(생략시): 평균을 구한다. (mean이 기본값)
    - **fill_value, dropna**
        - fill_value: 집계시 NA가 나올경우 채울 값
        - dropna: boolean. 컬럼의 전체값이 NA인 경우 그 컬럼 제거(기본: True)
    - **margins/margins_name**
        - margin: boolean(기본: False). 총집계결과를 만들지 여부.
        - margin_name: margin의 이름 문자열로 지정 (생략시 All)


```python
import pandas as pd
flight = pd.read_csv('data/flights.csv')
flight.shape
```




    (58492, 14)




```python
flight.groupby('AIRLINE')['AIR_TIME'].mean()
```




    AIRLINE
    AA    144.259404
    AS    147.845052
    B6    209.412963
    DL    115.334187
    EV     68.964016
    F9    127.592337
    HA    338.288288
    MQ     61.318346
    NK    135.736878
    OO     76.010272
    UA    155.650521
    US    147.686755
    VX    154.864097
    WN    107.005897
    Name: AIR_TIME, dtype: float64




```python
# 항공사, 월별 xxxx 평균
result = flight.groupby(['AIRLINE','MONTH'])['AIR_TIME'].mean()
print(result)
```

    AIRLINE  MONTH
    AA       1        138.793103
             2        143.126560
             3        142.026163
             4        144.544267
             5        145.261538
                         ...    
    WN       7        109.377500
             8        109.173248
             9        109.842239
             11       104.704244
             12       104.136304
    Name: AIR_TIME, Length: 149, dtype: float64


## 1개의 컬럼을 grouping 해서 집계
- 항공사별 비행시간의 평균 
- 사용컬럼
    - grouping할 컬럼
        - AIRLINE: 항공사
    - 집계대상컬럼
        - AIR_TIME
- 집계: mean

```python
import pandas as pd
flight = pd.read_csv('data/flights.csv')
```




```python
flight.groupby('AIRLINE')['AIR_TIME'].mean()
```




    AIRLINE
    AA    144.259404
    AS    147.845052
    B6    209.412963
    DL    115.334187
    EV     68.964016
    F9    127.592337
    HA    338.288288
    MQ     61.318346
    NK    135.736878
    OO     76.010272
    UA    155.650521
    US    147.686755
    VX    154.864097
    WN    107.005897
    Name: AIR_TIME, dtype: float64




```python
flight.pivot_table(index='AIRLINE', values='AIR_TIME', aggfunc='mean')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>AIR_TIME</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>144.259404</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>147.845052</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>209.412963</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>115.334187</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>68.964016</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>127.592337</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>338.288288</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>61.318346</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>135.736878</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>76.010272</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>155.650521</td>
    </tr>
    <tr>
      <th>US</th>
      <td>147.686755</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>154.864097</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>107.005897</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight.pivot_table(columns='AIRLINE', values='AIR_TIME', aggfunc='mean')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>AIRLINE</th>
      <th>AA</th>
      <th>AS</th>
      <th>B6</th>
      <th>DL</th>
      <th>EV</th>
      <th>F9</th>
      <th>HA</th>
      <th>MQ</th>
      <th>NK</th>
      <th>OO</th>
      <th>UA</th>
      <th>US</th>
      <th>VX</th>
      <th>WN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AIR_TIME</th>
      <td>144.259404</td>
      <td>147.845052</td>
      <td>209.412963</td>
      <td>115.334187</td>
      <td>68.964016</td>
      <td>127.592337</td>
      <td>338.288288</td>
      <td>61.318346</td>
      <td>135.736878</td>
      <td>76.010272</td>
      <td>155.650521</td>
      <td>147.686755</td>
      <td>154.864097</td>
      <td>107.005897</td>
    </tr>
  </tbody>
</table>
</div>



## 두개의 컬럼을 grouping 해서 집계
- 항공사/출발공항코드 별 취소 총수 (1이 취소이므로 합계를 구한다.)
- 사용컬럼
    - grouping할 컬럼
        - AIRLINE: 항공사
        - ORG_AIR: 출발 공항코드
    - 집계대상컬럼
        - CANCELLED: 취소여부 - 1:취소, 0: 취소안됨
- 집계: sum

```python
import pandas as pd
flight = pd.read_csv('data/flights.csv')
```




```python
flight.groupby(['AIRLINE','ORG_AIR'])['CANCELLED'].sum()
```




    AIRLINE  ORG_AIR
    AA       ATL         3
             DEN         4
             DFW        86
             IAH         3
             LAS         3
                        ..
    WN       LAS         7
             LAX        32
             MSP         1
             PHX         6
             SFO        25
    Name: CANCELLED, Length: 114, dtype: int64




```python
flight.pivot_table(index='AIRLINE',    # 그룹을 나누는 기준 컬럼중 INDEX(행)에 놓을 컬럼
                   columns='ORG_AIR',  # 그룹을 나누는 기준 컬럼중 COLUMNS(열)에 놓을 컬럼
                   values='CANCELLED', # 집계대상 컬럼
                   aggfunc='sum',      # 집계함수
                   fill_value='-999',  # NaN을 대신할 값
                   margins=True,       # 그룹별 소집계, 총집계결과를 만듬
                   margins_name='총계' # margin 컬럼/index의 이름 지정
                  )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>ORG_AIR</th>
      <th>ATL</th>
      <th>DEN</th>
      <th>DFW</th>
      <th>IAH</th>
      <th>LAS</th>
      <th>LAX</th>
      <th>MSP</th>
      <th>ORD</th>
      <th>PHX</th>
      <th>SFO</th>
      <th>총계</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AA</th>
      <td>3</td>
      <td>4</td>
      <td>86</td>
      <td>3</td>
      <td>3</td>
      <td>11</td>
      <td>3</td>
      <td>35</td>
      <td>4</td>
      <td>2</td>
      <td>154</td>
    </tr>
    <tr>
      <th>AS</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>B6</th>
      <td>-999</td>
      <td>0</td>
      <td>0</td>
      <td>-999</td>
      <td>0</td>
      <td>0</td>
      <td>-999</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>DL</th>
      <td>28</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>38</td>
    </tr>
    <tr>
      <th>EV</th>
      <td>18</td>
      <td>6</td>
      <td>27</td>
      <td>36</td>
      <td>-999</td>
      <td>-999</td>
      <td>6</td>
      <td>53</td>
      <td>0</td>
      <td>-999</td>
      <td>146</td>
    </tr>
    <tr>
      <th>F9</th>
      <td>0</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>HA</th>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>0</td>
      <td>0</td>
      <td>-999</td>
      <td>-999</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>MQ</th>
      <td>5</td>
      <td>-999</td>
      <td>62</td>
      <td>0</td>
      <td>-999</td>
      <td>0</td>
      <td>0</td>
      <td>85</td>
      <td>-999</td>
      <td>-999</td>
      <td>152</td>
    </tr>
    <tr>
      <th>NK</th>
      <td>1</td>
      <td>1</td>
      <td>6</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>3</td>
      <td>10</td>
      <td>2</td>
      <td>-999</td>
      <td>25</td>
    </tr>
    <tr>
      <th>OO</th>
      <td>3</td>
      <td>25</td>
      <td>2</td>
      <td>10</td>
      <td>0</td>
      <td>15</td>
      <td>4</td>
      <td>41</td>
      <td>9</td>
      <td>33</td>
      <td>142</td>
    </tr>
    <tr>
      <th>UA</th>
      <td>2</td>
      <td>9</td>
      <td>1</td>
      <td>23</td>
      <td>3</td>
      <td>6</td>
      <td>2</td>
      <td>25</td>
      <td>3</td>
      <td>19</td>
      <td>93</td>
    </tr>
    <tr>
      <th>US</th>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
      <td>7</td>
      <td>3</td>
      <td>21</td>
    </tr>
    <tr>
      <th>VX</th>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>-999</td>
      <td>0</td>
      <td>3</td>
      <td>-999</td>
      <td>0</td>
      <td>-999</td>
      <td>3</td>
      <td>6</td>
    </tr>
    <tr>
      <th>WN</th>
      <td>9</td>
      <td>13</td>
      <td>-999</td>
      <td>-999</td>
      <td>7</td>
      <td>32</td>
      <td>1</td>
      <td>-999</td>
      <td>6</td>
      <td>25</td>
      <td>93</td>
    </tr>
    <tr>
      <th>총계</th>
      <td>69</td>
      <td>61</td>
      <td>187</td>
      <td>74</td>
      <td>17</td>
      <td>70</td>
      <td>24</td>
      <td>259</td>
      <td>32</td>
      <td>88</td>
      <td>881</td>
    </tr>
  </tbody>
</table>
</div>




```python
# NaN : 그룹으로 묶인 데이터가 없는 경우
flight.query('AIRLINE=="B6" and ORG_AIR=="ATL"')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div>



## 3개 이상의 컬럼을 grouping해서 집계
- 항공사/월/출발공항코드 별 취소 총수 
- grouping할 컬럼
    - AIRLINE:항공사
    - MONTH:월
    - ORG_AIR: 출발지 공항
- 집계 대상컬럼
    - CANCELLED: 취소여부
- 집계 : sum    

```python
import pandas as pd
flight = pd.read_csv('data/flights.csv')
```




```python
flight.pivot_table(columns='MONTH',
                   index=['AIRLINE', 'ORG_AIR'], # 묶을 대상이 여러개인 경우 리스토로 묶음
                   values='CANCELLED', 
                   aggfunc='sum',
                   margins=True
                  
                  )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>11</th>
      <th>12</th>
      <th>All</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>ATL</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>DEN</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>4</td>
    </tr>
    <tr>
      <th>DFW</th>
      <td>8.0</td>
      <td>33.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>86</td>
    </tr>
    <tr>
      <th>IAH</th>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>LAS</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">WN</th>
      <th>LAX</th>
      <td>3.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>32</td>
    </tr>
    <tr>
      <th>MSP</th>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>PHX</th>
      <td>0.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>SFO</th>
      <td>4.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>0.0</td>
      <td>25</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <td>104.0</td>
      <td>195.0</td>
      <td>94.0</td>
      <td>58.0</td>
      <td>81.0</td>
      <td>100.0</td>
      <td>56.0</td>
      <td>44.0</td>
      <td>17.0</td>
      <td>51.0</td>
      <td>81.0</td>
      <td>881</td>
    </tr>
  </tbody>
</table>
<p>115 rows × 12 columns</p>
</div>



## 3개 이상의 컬럼을 grouping해서 집계 2
- 항공사/월/출발공항코드 별 최대/최소 연착시간
- grouping할 컬럼
    - AIRLINE:항공사
    - MONTH:월
    - ORG_AIR: 출발지 공항
- 집계 대상컬럼
    - ARR_DELAY: 연착시간
- 집계 : min, max    

```python
import pandas as pd
flight = pd.read_csv('data/flights.csv')
```




```python
result_df = flight.pivot_table(index=['AIRLINE','ORG_AIR'], 
                               columns='MONTH', 
                               values='ARR_DELAY',
                               aggfunc=['min','max'] # 집계함수가 여러개인 경우 리스트로 묶음
                              )
```


```python
result_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead tr th {
        text-align: left;
    }
    
    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th colspan="10" halign="left">min</th>
      <th>...</th>
      <th colspan="10" halign="left">max</th>
    </tr>
    <tr>
      <th></th>
      <th>MONTH</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>11</th>
      <th>...</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">AA</th>
      <th>ATL</th>
      <td>-27.0</td>
      <td>-26.0</td>
      <td>-32.0</td>
      <td>-30.0</td>
      <td>-26.0</td>
      <td>-23.0</td>
      <td>-27.0</td>
      <td>-32.0</td>
      <td>-33.0</td>
      <td>-33.0</td>
      <td>...</td>
      <td>16.0</td>
      <td>25.0</td>
      <td>115.0</td>
      <td>25.0</td>
      <td>159.0</td>
      <td>319.0</td>
      <td>84.0</td>
      <td>196.0</td>
      <td>255.0</td>
      <td>203.0</td>
    </tr>
    <tr>
      <th>DEN</th>
      <td>-13.0</td>
      <td>-17.0</td>
      <td>-19.0</td>
      <td>-28.0</td>
      <td>-20.0</td>
      <td>-13.0</td>
      <td>-30.0</td>
      <td>-27.0</td>
      <td>-27.0</td>
      <td>-27.0</td>
      <td>...</td>
      <td>40.0</td>
      <td>53.0</td>
      <td>105.0</td>
      <td>330.0</td>
      <td>10.0</td>
      <td>67.0</td>
      <td>257.0</td>
      <td>152.0</td>
      <td>146.0</td>
      <td>106.0</td>
    </tr>
    <tr>
      <th>DFW</th>
      <td>-39.0</td>
      <td>-29.0</td>
      <td>-29.0</td>
      <td>-37.0</td>
      <td>-36.0</td>
      <td>-33.0</td>
      <td>-32.0</td>
      <td>-32.0</td>
      <td>-33.0</td>
      <td>-45.0</td>
      <td>...</td>
      <td>311.0</td>
      <td>234.0</td>
      <td>275.0</td>
      <td>285.0</td>
      <td>602.0</td>
      <td>203.0</td>
      <td>268.0</td>
      <td>241.0</td>
      <td>349.0</td>
      <td>293.0</td>
    </tr>
    <tr>
      <th>IAH</th>
      <td>-23.0</td>
      <td>-27.0</td>
      <td>-13.0</td>
      <td>-27.0</td>
      <td>-19.0</td>
      <td>-13.0</td>
      <td>-19.0</td>
      <td>-30.0</td>
      <td>-31.0</td>
      <td>-14.0</td>
      <td>...</td>
      <td>51.0</td>
      <td>97.0</td>
      <td>127.0</td>
      <td>131.0</td>
      <td>456.0</td>
      <td>858.0</td>
      <td>95.0</td>
      <td>73.0</td>
      <td>98.0</td>
      <td>103.0</td>
    </tr>
    <tr>
      <th>LAS</th>
      <td>-32.0</td>
      <td>-25.0</td>
      <td>-24.0</td>
      <td>-19.0</td>
      <td>-31.0</td>
      <td>-27.0</td>
      <td>-40.0</td>
      <td>-28.0</td>
      <td>-32.0</td>
      <td>-31.0</td>
      <td>...</td>
      <td>20.0</td>
      <td>111.0</td>
      <td>626.0</td>
      <td>54.0</td>
      <td>206.0</td>
      <td>157.0</td>
      <td>157.0</td>
      <td>36.0</td>
      <td>89.0</td>
      <td>219.0</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">WN</th>
      <th>LAS</th>
      <td>-25.0</td>
      <td>-33.0</td>
      <td>-28.0</td>
      <td>-38.0</td>
      <td>-32.0</td>
      <td>-31.0</td>
      <td>-24.0</td>
      <td>-24.0</td>
      <td>-33.0</td>
      <td>-40.0</td>
      <td>...</td>
      <td>135.0</td>
      <td>261.0</td>
      <td>163.0</td>
      <td>150.0</td>
      <td>193.0</td>
      <td>290.0</td>
      <td>284.0</td>
      <td>284.0</td>
      <td>120.0</td>
      <td>96.0</td>
    </tr>
    <tr>
      <th>LAX</th>
      <td>-25.0</td>
      <td>-27.0</td>
      <td>-25.0</td>
      <td>-37.0</td>
      <td>-26.0</td>
      <td>-30.0</td>
      <td>-25.0</td>
      <td>-20.0</td>
      <td>-30.0</td>
      <td>-28.0</td>
      <td>...</td>
      <td>190.0</td>
      <td>104.0</td>
      <td>165.0</td>
      <td>244.0</td>
      <td>244.0</td>
      <td>248.0</td>
      <td>221.0</td>
      <td>157.0</td>
      <td>87.0</td>
      <td>493.0</td>
    </tr>
    <tr>
      <th>MSP</th>
      <td>-38.0</td>
      <td>-32.0</td>
      <td>-30.0</td>
      <td>-33.0</td>
      <td>-24.0</td>
      <td>-24.0</td>
      <td>-28.0</td>
      <td>-21.0</td>
      <td>-23.0</td>
      <td>-29.0</td>
      <td>...</td>
      <td>68.0</td>
      <td>43.0</td>
      <td>64.0</td>
      <td>13.0</td>
      <td>88.0</td>
      <td>84.0</td>
      <td>45.0</td>
      <td>23.0</td>
      <td>114.0</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>PHX</th>
      <td>-38.0</td>
      <td>-45.0</td>
      <td>-24.0</td>
      <td>-43.0</td>
      <td>-27.0</td>
      <td>-25.0</td>
      <td>-29.0</td>
      <td>-24.0</td>
      <td>-25.0</td>
      <td>-41.0</td>
      <td>...</td>
      <td>159.0</td>
      <td>78.0</td>
      <td>130.0</td>
      <td>203.0</td>
      <td>168.0</td>
      <td>171.0</td>
      <td>161.0</td>
      <td>131.0</td>
      <td>244.0</td>
      <td>254.0</td>
    </tr>
    <tr>
      <th>SFO</th>
      <td>-19.0</td>
      <td>-24.0</td>
      <td>-29.0</td>
      <td>-29.0</td>
      <td>-22.0</td>
      <td>-26.0</td>
      <td>-30.0</td>
      <td>-22.0</td>
      <td>-33.0</td>
      <td>-23.0</td>
      <td>...</td>
      <td>110.0</td>
      <td>237.0</td>
      <td>72.0</td>
      <td>133.0</td>
      <td>205.0</td>
      <td>51.0</td>
      <td>65.0</td>
      <td>69.0</td>
      <td>143.0</td>
      <td>215.0</td>
    </tr>
  </tbody>
</table>
<p>114 rows × 22 columns</p>
</div>



# Apply() - Series, DataFrame의 데이터 일괄 처리

데이터프레임의 행들과 열들 또는 Series의 원소들에 공통된 처리를 할 때 apply 함수를 이용하면 반복문을 사용하지 않고 일괄 처리가 가능하다.

- DataFrame.apply(함수, axis=0, args=(), \*\*kwarg)
    - 인수로 행이나 열을 받는 함수를 apply 메서드의 인수로 넣으면 데이터프레임의 행이나 열들을 하나씩 함수에 전달한다.
    - 매개변수
        - **함수**: DataFrame의 행들 또는 열들을 전달할 함수
        - **axis**: **0-컬럼(열)을 전달, 1-행을 전달 (기본값 0)**
        - **args**: 함수에 행/열 이외에 전달할 매개변수를 위치기반(순서대로) 튜플로 전달
        - **\*\*kwarg**: 함수에 행/열 이외에 전달할 매개변수를 키워드 인자로 전달
- Series.apply(함수, args=(), \*\*kwarg)
    - 인수로 Series의 원소들을 받는 함수를 apply 메소드의 인수로 넣으면  Series의 원소들을 하나씩 함수로 전달한다.
    - 매개변수
        - **함수**: Series의 원소들을 전달할 함수
        - **args**: 함수에 원소 이외에 전달할 매개변수를 위치기반(순서대로) 튜플로 전달
        - **\*\*kwarg**: 함수에 원소 이외에 전달할 매개변수를 키워드 인자로 전달


```python
일괄처리 DF : 2차원 배열, 원소:(컬럼/행)
Series : 1차원 배열, 원소:하나씩 받음`
```


```python
flight = pd.read_csv('data/flights.csv')
```


```python
# 1: 월 ~ 7: 일
flight.WEEKDAY.value_counts().sort_index()
```




    WEEKDAY
    1    8720
    2    8535
    3    8706
    4    8659
    5    8453
    6    7052
    7    8367
    Name: count, dtype: int64




```python
# 요일 전체(일괄처리) : 정수 -> 문자열
flight.WEEKDAY
```




    0        4
    1        4
    2        4
    3        4
    4        4
            ..
    58487    4
    58488    4
    58489    4
    58490    4
    58491    4
    Name: WEEKDAY, Length: 58492, dtype: int64




```python
# Series의 원소 하는를 받아서 처리후 반환하는 함수
def change_weekday(value):
    l = list('월화수목금토일')
    v = l[value-1]
    return v+'요일'
```


```python
change_weekday(2)
```




    '화요일'




```python
flight['WEEKDAY'] = flight['WEEKDAY'].apply(change_weekday)
```


```python
flight.iloc[100:160]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>100</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>EV</td>
      <td>ORD</td>
      <td>GSO</td>
      <td>1850</td>
      <td>4.0</td>
      <td>78.0</td>
      <td>589</td>
      <td>2139</td>
      <td>-12.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>101</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>DL</td>
      <td>LAX</td>
      <td>JFK</td>
      <td>1140</td>
      <td>-1.0</td>
      <td>276.0</td>
      <td>2475</td>
      <td>2000</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>102</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>OO</td>
      <td>SFO</td>
      <td>TUS</td>
      <td>1405</td>
      <td>-3.0</td>
      <td>117.0</td>
      <td>751</td>
      <td>1710</td>
      <td>7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>103</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>GRR</td>
      <td>1510</td>
      <td>-4.0</td>
      <td>30.0</td>
      <td>137</td>
      <td>1713</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>104</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>US</td>
      <td>MSP</td>
      <td>PHX</td>
      <td>730</td>
      <td>-3.0</td>
      <td>174.0</td>
      <td>1276</td>
      <td>1010</td>
      <td>-20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>105</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>TXK</td>
      <td>1655</td>
      <td>24.0</td>
      <td>33.0</td>
      <td>181</td>
      <td>1743</td>
      <td>25.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>106</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>EV</td>
      <td>DFW</td>
      <td>LAW</td>
      <td>1130</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140</td>
      <td>1215</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>107</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>AA</td>
      <td>ORD</td>
      <td>RSW</td>
      <td>1035</td>
      <td>5.0</td>
      <td>144.0</td>
      <td>1120</td>
      <td>1415</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>108</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>UA</td>
      <td>IAH</td>
      <td>SEA</td>
      <td>2105</td>
      <td>113.0</td>
      <td>233.0</td>
      <td>1874</td>
      <td>2357</td>
      <td>69.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>109</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>NK</td>
      <td>MSP</td>
      <td>ORD</td>
      <td>616</td>
      <td>2.0</td>
      <td>49.0</td>
      <td>334</td>
      <td>745</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>110</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>UA</td>
      <td>DEN</td>
      <td>GRR</td>
      <td>1631</td>
      <td>14.0</td>
      <td>109.0</td>
      <td>1015</td>
      <td>2057</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>111</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>US</td>
      <td>DFW</td>
      <td>CLT</td>
      <td>830</td>
      <td>-3.0</td>
      <td>103.0</td>
      <td>936</td>
      <td>1158</td>
      <td>10.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>112</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>US</td>
      <td>PHX</td>
      <td>CLT</td>
      <td>1310</td>
      <td>4.0</td>
      <td>183.0</td>
      <td>1773</td>
      <td>1902</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>113</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>OO</td>
      <td>ORD</td>
      <td>LNK</td>
      <td>2005</td>
      <td>-7.0</td>
      <td>72.0</td>
      <td>466</td>
      <td>2147</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>114</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MKE</td>
      <td>1035</td>
      <td>-8.0</td>
      <td>207.0</td>
      <td>1756</td>
      <td>1625</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>115</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>LRD</td>
      <td>1255</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>396</td>
      <td>1418</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>116</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>SAT</td>
      <td>2054</td>
      <td>-3.0</td>
      <td>135.0</td>
      <td>874</td>
      <td>2238</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>117</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>MCI</td>
      <td>2032</td>
      <td>-1.0</td>
      <td>104.0</td>
      <td>692</td>
      <td>2148</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>118</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>EV</td>
      <td>ATL</td>
      <td>SCE</td>
      <td>1915</td>
      <td>-4.0</td>
      <td>92.0</td>
      <td>615</td>
      <td>2104</td>
      <td>3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>119</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>US</td>
      <td>PHX</td>
      <td>DEN</td>
      <td>1555</td>
      <td>0.0</td>
      <td>84.0</td>
      <td>602</td>
      <td>1739</td>
      <td>0.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>120</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>AA</td>
      <td>ORD</td>
      <td>BOS</td>
      <td>2055</td>
      <td>62.0</td>
      <td>100.0</td>
      <td>867</td>
      <td>2359</td>
      <td>61.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>121</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>LEX</td>
      <td>2144</td>
      <td>-5.0</td>
      <td>49.0</td>
      <td>304</td>
      <td>2258</td>
      <td>-3.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>122</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>AA</td>
      <td>DFW</td>
      <td>RDU</td>
      <td>1740</td>
      <td>1.0</td>
      <td>123.0</td>
      <td>1061</td>
      <td>2105</td>
      <td>-6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>123</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>B6</td>
      <td>LAS</td>
      <td>BOS</td>
      <td>1230</td>
      <td>0.0</td>
      <td>246.0</td>
      <td>2381</td>
      <td>2026</td>
      <td>-27.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>124</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>OO</td>
      <td>MSP</td>
      <td>SFO</td>
      <td>730</td>
      <td>-1.0</td>
      <td>201.0</td>
      <td>1589</td>
      <td>950</td>
      <td>-18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>125</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>PNS</td>
      <td>1035</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>604</td>
      <td>1213</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>126</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>OO</td>
      <td>SFO</td>
      <td>PSP</td>
      <td>1357</td>
      <td>-3.0</td>
      <td>68.0</td>
      <td>421</td>
      <td>1523</td>
      <td>-2.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>127</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>B6</td>
      <td>LAS</td>
      <td>BOS</td>
      <td>2359</td>
      <td>68.0</td>
      <td>247.0</td>
      <td>2381</td>
      <td>749</td>
      <td>46.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>128</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>AA</td>
      <td>DFW</td>
      <td>IAH</td>
      <td>1305</td>
      <td>-2.0</td>
      <td>44.0</td>
      <td>224</td>
      <td>1410</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>129</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>CLE</td>
      <td>1205</td>
      <td>-5.0</td>
      <td>76.0</td>
      <td>554</td>
      <td>1354</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>130</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>DL</td>
      <td>MSP</td>
      <td>TPA</td>
      <td>910</td>
      <td>-2.0</td>
      <td>157.0</td>
      <td>1306</td>
      <td>1327</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>131</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>AA</td>
      <td>LAS</td>
      <td>DFW</td>
      <td>1055</td>
      <td>-2.0</td>
      <td>133.0</td>
      <td>1055</td>
      <td>1535</td>
      <td>9.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>132</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>WN</td>
      <td>SFO</td>
      <td>SAN</td>
      <td>1535</td>
      <td>21.0</td>
      <td>67.0</td>
      <td>447</td>
      <td>1705</td>
      <td>18.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>133</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>AA</td>
      <td>DFW</td>
      <td>TPA</td>
      <td>1500</td>
      <td>-3.0</td>
      <td>120.0</td>
      <td>929</td>
      <td>1815</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>134</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>UA</td>
      <td>DEN</td>
      <td>PHX</td>
      <td>2207</td>
      <td>43.0</td>
      <td>85.0</td>
      <td>602</td>
      <td>4</td>
      <td>44.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>135</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>OO</td>
      <td>DEN</td>
      <td>GTF</td>
      <td>2155</td>
      <td>38.0</td>
      <td>87.0</td>
      <td>624</td>
      <td>2355</td>
      <td>37.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>EV</td>
      <td>ATL</td>
      <td>JAN</td>
      <td>1056</td>
      <td>1.0</td>
      <td>59.0</td>
      <td>341</td>
      <td>1123</td>
      <td>6.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>137</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>HSV</td>
      <td>1355</td>
      <td>0.0</td>
      <td>38.0</td>
      <td>151</td>
      <td>1351</td>
      <td>5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>138</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>OO</td>
      <td>PHX</td>
      <td>PSP</td>
      <td>2055</td>
      <td>0.0</td>
      <td>45.0</td>
      <td>261</td>
      <td>2100</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>139</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>OO</td>
      <td>LAX</td>
      <td>DFW</td>
      <td>945</td>
      <td>171.0</td>
      <td>159.0</td>
      <td>1235</td>
      <td>1454</td>
      <td>171.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>140</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>UA</td>
      <td>ORD</td>
      <td>CLT</td>
      <td>1332</td>
      <td>-6.0</td>
      <td>78.0</td>
      <td>599</td>
      <td>1625</td>
      <td>-23.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>141</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>UA</td>
      <td>IAH</td>
      <td>CLE</td>
      <td>1907</td>
      <td>30.0</td>
      <td>119.0</td>
      <td>1091</td>
      <td>2250</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>142</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>DEN</td>
      <td>ATL</td>
      <td>1420</td>
      <td>38.0</td>
      <td>148.0</td>
      <td>1199</td>
      <td>1905</td>
      <td>45.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>143</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>EV</td>
      <td>ORD</td>
      <td>RIC</td>
      <td>1930</td>
      <td>-8.0</td>
      <td>88.0</td>
      <td>642</td>
      <td>2236</td>
      <td>-25.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>144</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>UA</td>
      <td>IAH</td>
      <td>PHL</td>
      <td>1028</td>
      <td>14.0</td>
      <td>162.0</td>
      <td>1325</td>
      <td>1443</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>145</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>UA</td>
      <td>DEN</td>
      <td>SAN</td>
      <td>2200</td>
      <td>57.0</td>
      <td>106.0</td>
      <td>853</td>
      <td>2324</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>146</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>AA</td>
      <td>DFW</td>
      <td>BNA</td>
      <td>1305</td>
      <td>71.0</td>
      <td>78.0</td>
      <td>631</td>
      <td>1445</td>
      <td>68.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>147</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>EV</td>
      <td>DEN</td>
      <td>ELP</td>
      <td>1510</td>
      <td>64.0</td>
      <td>87.0</td>
      <td>563</td>
      <td>1658</td>
      <td>63.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>148</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>US</td>
      <td>PHX</td>
      <td>DCA</td>
      <td>1340</td>
      <td>-1.0</td>
      <td>216.0</td>
      <td>1979</td>
      <td>1947</td>
      <td>-14.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>149</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>MQ</td>
      <td>ORD</td>
      <td>SGF</td>
      <td>1710</td>
      <td>23.0</td>
      <td>83.0</td>
      <td>438</td>
      <td>1848</td>
      <td>25.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>150</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>US</td>
      <td>LAS</td>
      <td>PHX</td>
      <td>635</td>
      <td>-4.0</td>
      <td>44.0</td>
      <td>255</td>
      <td>846</td>
      <td>-15.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>151</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>OO</td>
      <td>IAH</td>
      <td>ASE</td>
      <td>1835</td>
      <td>39.0</td>
      <td>120.0</td>
      <td>913</td>
      <td>2027</td>
      <td>8.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>152</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>MCO</td>
      <td>655</td>
      <td>1.0</td>
      <td>59.0</td>
      <td>404</td>
      <td>822</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>153</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>US</td>
      <td>ATL</td>
      <td>CLT</td>
      <td>1959</td>
      <td>0.0</td>
      <td>41.0</td>
      <td>226</td>
      <td>2113</td>
      <td>-11.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>154</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>MSP</td>
      <td>TPA</td>
      <td>1315</td>
      <td>90.0</td>
      <td>170.0</td>
      <td>1306</td>
      <td>1721</td>
      <td>92.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>155</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>DFW</td>
      <td>ATL</td>
      <td>700</td>
      <td>-3.0</td>
      <td>95.0</td>
      <td>731</td>
      <td>1005</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>156</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>WN</td>
      <td>PHX</td>
      <td>LAX</td>
      <td>1255</td>
      <td>14.0</td>
      <td>57.0</td>
      <td>370</td>
      <td>1320</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>157</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>OO</td>
      <td>MSP</td>
      <td>DIK</td>
      <td>1955</td>
      <td>-5.0</td>
      <td>75.0</td>
      <td>481</td>
      <td>2103</td>
      <td>-16.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>158</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>ATL</td>
      <td>BHM</td>
      <td>1646</td>
      <td>9.0</td>
      <td>36.0</td>
      <td>134</td>
      <td>1640</td>
      <td>13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>159</th>
      <td>1</td>
      <td>2</td>
      <td>금요일</td>
      <td>DL</td>
      <td>MSP</td>
      <td>ATL</td>
      <td>630</td>
      <td>-3.0</td>
      <td>116.0</td>
      <td>907</td>
      <td>1006</td>
      <td>-20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 요일 : value
d = {
    v+'요일' : i for i, v in enumerate(list('월화수목금토일'), start=1)
}
d
```




    {'월요일': 1, '화요일': 2, '수요일': 3, '목요일': 4, '금요일': 5, '토요일': 6, '일요일': 7}




```python
d['월요일']
```




    1




```python
d[flight['WEEKDAY'][10]]
```




    4




```python
# WEEKDAY : 문자열 -> 정수
## x : 원소한개 -> 요일문자열.
flight.insert(3, 'WEEKDAY2', flight['WEEKDAY'].apply(lambda x : d[x]) )
```


```python
flight
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>WEEKDAY2</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SLC</td>
      <td>1625</td>
      <td>58.0</td>
      <td>94.0</td>
      <td>590</td>
      <td>1905</td>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>IAD</td>
      <td>823</td>
      <td>7.0</td>
      <td>154.0</td>
      <td>1452</td>
      <td>1333</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>VPS</td>
      <td>1305</td>
      <td>36.0</td>
      <td>85.0</td>
      <td>641</td>
      <td>1453</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>DCA</td>
      <td>1555</td>
      <td>7.0</td>
      <td>126.0</td>
      <td>1192</td>
      <td>1935</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MCI</td>
      <td>1720</td>
      <td>48.0</td>
      <td>166.0</td>
      <td>1363</td>
      <td>2225</td>
      <td>39.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58487</th>
      <td>12</td>
      <td>31</td>
      <td>목요일</td>
      <td>4</td>
      <td>AA</td>
      <td>SFO</td>
      <td>DFW</td>
      <td>515</td>
      <td>5.0</td>
      <td>166.0</td>
      <td>1464</td>
      <td>1045</td>
      <td>-19.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58488</th>
      <td>12</td>
      <td>31</td>
      <td>목요일</td>
      <td>4</td>
      <td>F9</td>
      <td>LAS</td>
      <td>SFO</td>
      <td>1910</td>
      <td>13.0</td>
      <td>71.0</td>
      <td>414</td>
      <td>2050</td>
      <td>4.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58489</th>
      <td>12</td>
      <td>31</td>
      <td>목요일</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>SBA</td>
      <td>1846</td>
      <td>-6.0</td>
      <td>46.0</td>
      <td>262</td>
      <td>1956</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58490</th>
      <td>12</td>
      <td>31</td>
      <td>목요일</td>
      <td>4</td>
      <td>WN</td>
      <td>MSP</td>
      <td>ATL</td>
      <td>525</td>
      <td>39.0</td>
      <td>124.0</td>
      <td>907</td>
      <td>855</td>
      <td>34.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58491</th>
      <td>12</td>
      <td>31</td>
      <td>목요일</td>
      <td>4</td>
      <td>OO</td>
      <td>SFO</td>
      <td>BOI</td>
      <td>859</td>
      <td>5.0</td>
      <td>73.0</td>
      <td>522</td>
      <td>1146</td>
      <td>-1.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>58492 rows × 15 columns</p>
</div>




```python
# DataFrameapply(함수)
## 함수(컬럼, 행: Series)
def func(column):
    # column : pd.Series - 개별 컬럼의 값들을 Series로 받는다.
    ## 각 컬럼의 대표값을 반환. -> 숫자형 : 평균 , 문자열: 최빈값
    if column.dtype == 'object':
        return column.mode()[0]
    else:
        return column.mean()
```


```python
flight.apply(func) # axis = 1 : 행이 전달
```




    MONTH           6.220646
    DAY            15.702096
    WEEKDAY              월요일
    WEEKDAY2        3.926862
    AIRLINE               DL
    ORG_AIR              ATL
    DEST_AIR             LAX
    SCHED_DEP    1387.984836
    DEP_DELAY      10.921192
    AIR_TIME      115.928576
    DIST          872.900072
    SCHED_ARR    1549.399832
    ARR_DELAY       5.812315
    DIVERTED        0.002342
    CANCELLED       0.015062
    dtype: object




```python
flight.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY</th>
      <th>WEEKDAY2</th>
      <th>AIRLINE</th>
      <th>ORG_AIR</th>
      <th>DEST_AIR</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>SLC</td>
      <td>1625</td>
      <td>58.0</td>
      <td>94.0</td>
      <td>590</td>
      <td>1905</td>
      <td>65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>UA</td>
      <td>DEN</td>
      <td>IAD</td>
      <td>823</td>
      <td>7.0</td>
      <td>154.0</td>
      <td>1452</td>
      <td>1333</td>
      <td>-13.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>MQ</td>
      <td>DFW</td>
      <td>VPS</td>
      <td>1305</td>
      <td>36.0</td>
      <td>85.0</td>
      <td>641</td>
      <td>1453</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>AA</td>
      <td>DFW</td>
      <td>DCA</td>
      <td>1555</td>
      <td>7.0</td>
      <td>126.0</td>
      <td>1192</td>
      <td>1935</td>
      <td>-7.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>목요일</td>
      <td>4</td>
      <td>WN</td>
      <td>LAX</td>
      <td>MCI</td>
      <td>1720</td>
      <td>48.0</td>
      <td>166.0</td>
      <td>1363</td>
      <td>2225</td>
      <td>39.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
flight.select_dtypes(include='number').apply(lambda x : x * 5)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MONTH</th>
      <th>DAY</th>
      <th>WEEKDAY2</th>
      <th>SCHED_DEP</th>
      <th>DEP_DELAY</th>
      <th>AIR_TIME</th>
      <th>DIST</th>
      <th>SCHED_ARR</th>
      <th>ARR_DELAY</th>
      <th>DIVERTED</th>
      <th>CANCELLED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5</td>
      <td>5</td>
      <td>20</td>
      <td>8125</td>
      <td>290.0</td>
      <td>470.0</td>
      <td>2950</td>
      <td>9525</td>
      <td>325.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5</td>
      <td>5</td>
      <td>20</td>
      <td>4115</td>
      <td>35.0</td>
      <td>770.0</td>
      <td>7260</td>
      <td>6665</td>
      <td>-65.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5</td>
      <td>5</td>
      <td>20</td>
      <td>6525</td>
      <td>180.0</td>
      <td>425.0</td>
      <td>3205</td>
      <td>7265</td>
      <td>175.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5</td>
      <td>5</td>
      <td>20</td>
      <td>7775</td>
      <td>35.0</td>
      <td>630.0</td>
      <td>5960</td>
      <td>9675</td>
      <td>-35.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>5</td>
      <td>20</td>
      <td>8600</td>
      <td>240.0</td>
      <td>830.0</td>
      <td>6815</td>
      <td>11125</td>
      <td>195.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58487</th>
      <td>60</td>
      <td>155</td>
      <td>20</td>
      <td>2575</td>
      <td>25.0</td>
      <td>830.0</td>
      <td>7320</td>
      <td>5225</td>
      <td>-95.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58488</th>
      <td>60</td>
      <td>155</td>
      <td>20</td>
      <td>9550</td>
      <td>65.0</td>
      <td>355.0</td>
      <td>2070</td>
      <td>10250</td>
      <td>20.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58489</th>
      <td>60</td>
      <td>155</td>
      <td>20</td>
      <td>9230</td>
      <td>-30.0</td>
      <td>230.0</td>
      <td>1310</td>
      <td>9780</td>
      <td>-25.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58490</th>
      <td>60</td>
      <td>155</td>
      <td>20</td>
      <td>2625</td>
      <td>195.0</td>
      <td>620.0</td>
      <td>4535</td>
      <td>4275</td>
      <td>170.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>58491</th>
      <td>60</td>
      <td>155</td>
      <td>20</td>
      <td>4295</td>
      <td>25.0</td>
      <td>365.0</td>
      <td>2610</td>
      <td>5730</td>
      <td>-5.0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>58492 rows × 11 columns</p>
</div>



# cut()/qcut() - 연속형(실수)을 범주형으로 변환
- cut() : 지정한 값을 기준으로 구간을 나눠 그룹으로 묶는다.
    - `pd.cut(x, bins,right=True, labels=None)`
    - 매개변수
        - **x**: 범주형으로 바꿀 대상. 1차원 배열형태(Series, 리스트, ndarray)의 자료구조
        - **bins**: 범주로 나눌때의 기준값(구간경계)들을 리스트로 묶어서 전달한다.
        - **right**: 구간경계의 오른쪽(True-기본)을 포함할지 왼쪽(False)을 포함할지
        - **labels**: 각 구간(범주)의 label을 리스트로 전달
            - 생략하면 범위를 범주명으로 사용한다. (ex: (10, 20], ()-포함안함, []-포함)
- qcut() :  대상배열의 최대값 ~ 최소값을 지정한 개수의 동등한 size(**원소의개수**)가 되도록 나눈다.
    - `pd.qcut(x, q, labels)`
    - 매개변수
        - **x**: 나눌 대상. 1차원 배열형태의 자료구조
        - **q**: 나눌 개수
        - **labels**: 각 구간(범주)의 label을 리스트로 전달


```python
import numpy as np
np.random.seed(0)
# 1 ~ 100사이 정수를 랜덤하게 생성
age = np.random.randint(1,100, 30 ) 
tall = np.round(np.random.normal(170, 10, 30), 2)
```


```python
# 평균 : 170, 표준편차: 10인 정규분포를 따르는 실수를 랜덤하게 30 생성
# 생성되는 값의 95는 150 ~ 190 사이의 실수
## 2표준편차 : 150 170 190 +- 20
np.random.normal(170, 10, 30)
```




    array([172.48530627, 169.68754665, 168.60526038, 168.09344021,
           174.48637527, 160.07570228, 167.74060344, 153.45429233,
           163.60277362, 165.20580199, 173.11363503, 162.23979533,
           166.9263519 , 166.33476059, 181.19711962, 165.4207758 ,
           174.25393398, 169.72028817, 184.75989832, 176.46780097,
           166.35665688, 163.21222611, 166.46372144, 162.59252529,
           163.24978168, 168.67215744, 176.19801063, 187.91168461,
           171.71000438, 152.74328648])




```python
df = pd.DataFrame({
        '나이':age,
        '키':tall
})
```


```python
df.나이.value_counts()
```




    나이
    89    3
    68    2
    10    2
    88    2
    45    1
    47    1
    70    1
    81    1
    21    1
    73    1
    78    1
    26    1
    38    1
    82    1
    59    1
    40    1
    66    1
    48    1
    13    1
    71    1
    37    1
    22    1
    84    1
    65    1
    80    1
    Name: count, dtype: int64




```python
df.키.value_counts()
```




    키
    168.18    1
    184.10    1
    179.96    1
    162.24    1
    166.14    1
    176.40    1
    159.14    1
    165.37    1
    171.75    1
    164.30    1
    187.87    1
    183.95    1
    159.22    1
    171.49    1
    175.66    1
    185.35    1
    184.63    1
    170.47    1
    166.67    1
    185.14    1
    167.58    1
    164.33    1
    154.37    1
    176.81    1
    170.33    1
    173.77    1
    160.39    1
    172.75    1
    166.26    1
    150.67    1
    Name: count, dtype: int64




```python
df.키.mean()
```




    170.843




```python
# cut <- 함수, bins : 몇등분 지정
result = pd.cut(df.나이, bins=3)
# 지정한대로 그룹을 만든 다음에 개별값들을 그룹값으로 모두 처리한 결과를 반환.
result.value_counts()
```




    나이
    (62.667, 89.0]      17
    (36.333, 62.667]     7
    (9.921, 36.333]      6
    Name: count, dtype: int64




```python
# 범위 표시할 떄
## (시작, 끝) : 불포함 (시작, 끝) ==> opend
## [시작, 끝] : 포함(시작, 끝) ==> closed
### (62.667, 89.0] : 62.667 < 범위 <= 89.0
```


```python
result.head()
```




    0    (36.333, 62.667]
    1    (36.333, 62.667]
    2      (62.667, 89.0]
    3      (62.667, 89.0]
    4      (62.667, 89.0]
    Name: 나이, dtype: category
    Categories (3, interval[float64, right]): [(9.921, 36.333] < (36.333, 62.667] < (62.667, 89.0]]




```python
df.나이.head()
```




    0    45
    1    48
    2    65
    3    68
    4    68
    Name: 나이, dtype: int32




```python
# right=False 분위값을 왼쪽(시작쪽) 포함 => Default : 오른쪽(시작쪽) 포함
result2 = pd.cut(df.나이, bins=3, right=False)
result2.value_counts()
```




    나이
    [62.667, 89.079)    17
    [36.333, 62.667)     7
    [10.0, 36.333)       6
    Name: count, dtype: int64




```python
# labels : 나눈 그룹에 이름들을 지정
result3 = pd.cut(df.나이, bins=3, right=False, labels=['나이대1','나이대2','나이대3'])
result3.value_counts()
```




    나이
    나이대3    17
    나이대2     7
    나이대1     6
    Name: count, dtype: int64




```python
df2 = df.copy()
```


```python
df2['나이대'] = pd.cut(df['나이'], bins=3, labels=['나이대1','나이대2','나이대3'])
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>나이</th>
      <th>키</th>
      <th>나이대</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>45</td>
      <td>168.18</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>48</td>
      <td>184.10</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>65</td>
      <td>166.26</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>68</td>
      <td>172.75</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>68</td>
      <td>160.39</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10</td>
      <td>173.77</td>
      <td>나이대1</td>
    </tr>
    <tr>
      <th>6</th>
      <td>84</td>
      <td>170.33</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>7</th>
      <td>22</td>
      <td>176.81</td>
      <td>나이대1</td>
    </tr>
    <tr>
      <th>8</th>
      <td>37</td>
      <td>154.37</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>9</th>
      <td>88</td>
      <td>164.33</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>10</th>
      <td>71</td>
      <td>167.58</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>11</th>
      <td>89</td>
      <td>185.14</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>12</th>
      <td>89</td>
      <td>166.67</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>170.47</td>
      <td>나이대1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>59</td>
      <td>184.63</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>66</td>
      <td>185.35</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>40</td>
      <td>175.66</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>88</td>
      <td>171.49</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>18</th>
      <td>47</td>
      <td>159.22</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>89</td>
      <td>183.95</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>20</th>
      <td>82</td>
      <td>187.87</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>21</th>
      <td>38</td>
      <td>164.30</td>
      <td>나이대2</td>
    </tr>
    <tr>
      <th>22</th>
      <td>26</td>
      <td>171.75</td>
      <td>나이대1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>78</td>
      <td>165.37</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>24</th>
      <td>73</td>
      <td>159.14</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>25</th>
      <td>10</td>
      <td>176.40</td>
      <td>나이대1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>21</td>
      <td>166.14</td>
      <td>나이대1</td>
    </tr>
    <tr>
      <th>27</th>
      <td>81</td>
      <td>162.24</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>28</th>
      <td>70</td>
      <td>179.96</td>
      <td>나이대3</td>
    </tr>
    <tr>
      <th>29</th>
      <td>80</td>
      <td>150.67</td>
      <td>나이대3</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2.groupby('나이대')['키'].mean()
```

    C:\Users\world\AppData\Local\Temp\ipykernel_9060\3004925517.py:1: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
      df2.groupby('나이대')['키'].mean()





    나이대
    나이대1    172.556667
    나이대2    170.065714
    나이대3    170.558235
    Name: 키, dtype: float64




```python
df2['나이대'].value_counts().to_frame()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>나이대</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>나이대3</th>
      <td>17</td>
    </tr>
    <tr>
      <th>나이대2</th>
      <td>7</td>
    </tr>
    <tr>
      <th>나이대1</th>
      <td>6</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 원하는 범위(기준)로 그룹을 나누기
```


```python
# 0 ~ 20, 20 ~ 40, 40 ~ 60, 60 ~ 100
l = [0, 20, 40, 60, 100]
result4 = pd.cut(df2['나이'], bins=l)

result4.value_counts().sort_index()
```




    나이
    (0, 20]       3
    (20, 40]      6
    (40, 60]      4
    (60, 100]    17
    Name: count, dtype: int64




```python
result5 = pd.cut(df2['나이'], bins=l, labels=['청소년','청년','장년','노년'] )

result5.value_counts().sort_index()
```




    나이
    청소년     3
    청년      6
    장년      4
    노년     17
    Name: count, dtype: int64




```python
df2['나이대2'] = result5
df2.groupby('나이대2')['키'].agg(['min','max'])
```

    C:\Users\world\AppData\Local\Temp\ipykernel_9060\4131622824.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
      df2.groupby('나이대2')['키'].agg(['min','max'])





<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min</th>
      <th>max</th>
    </tr>
    <tr>
      <th>나이대2</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>청소년</th>
      <td>170.47</td>
      <td>176.40</td>
    </tr>
    <tr>
      <th>청년</th>
      <td>154.37</td>
      <td>176.81</td>
    </tr>
    <tr>
      <th>장년</th>
      <td>159.22</td>
      <td>184.63</td>
    </tr>
    <tr>
      <th>노년</th>
      <td>150.67</td>
      <td>187.87</td>
    </tr>
  </tbody>
</table>
</div>




```python
# pd.cut() => 동일한 원소의 개수가 되도록 그룹을 나눈다.
## q: 몇개로 나눌지
result = pd.qcut(df['나이'], q=2)
result.value_counts()
```




    나이
    (9.999, 67.0]    15
    (67.0, 89.0]     15
    Name: count, dtype: int64




```python
result = pd.qcut(df['나이'], q=4, labels=['A','B','C','D'])
result.value_counts()
```




    나이
    A    8
    D    8
    B    7
    C    7
    Name: count, dtype: int64



<b style='font-size:2em'>TODO </b>


```python
# 1: data/diamonds.csv 를 읽어 DataFrame으로 만든다.
import pandas as pd
dia = pd.read_csv('data/diamonds.csv')
dia
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>53935</th>
      <td>0.72</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI1</td>
      <td>60.8</td>
      <td>57.0</td>
      <td>2757</td>
      <td>5.75</td>
      <td>5.76</td>
      <td>3.50</td>
    </tr>
    <tr>
      <th>53936</th>
      <td>0.72</td>
      <td>Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>63.1</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.69</td>
      <td>5.75</td>
      <td>3.61</td>
    </tr>
    <tr>
      <th>53937</th>
      <td>0.70</td>
      <td>Very Good</td>
      <td>D</td>
      <td>SI1</td>
      <td>62.8</td>
      <td>60.0</td>
      <td>2757</td>
      <td>5.66</td>
      <td>5.68</td>
      <td>3.56</td>
    </tr>
    <tr>
      <th>53938</th>
      <td>0.86</td>
      <td>Premium</td>
      <td>H</td>
      <td>SI2</td>
      <td>61.0</td>
      <td>58.0</td>
      <td>2757</td>
      <td>6.15</td>
      <td>6.12</td>
      <td>3.74</td>
    </tr>
    <tr>
      <th>53939</th>
      <td>0.75</td>
      <td>Ideal</td>
      <td>D</td>
      <td>SI2</td>
      <td>62.2</td>
      <td>55.0</td>
      <td>2757</td>
      <td>5.83</td>
      <td>5.87</td>
      <td>3.64</td>
    </tr>
  </tbody>
</table>
<p>53940 rows × 10 columns</p>
</div>




```python
dia.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 53940 entries, 0 to 53939
    Data columns (total 10 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   carat    53940 non-null  float64
     1   cut      53940 non-null  object 
     2   color    53940 non-null  object 
     3   clarity  53940 non-null  object 
     4   depth    53940 non-null  float64
     5   table    53940 non-null  float64
     6   price    53940 non-null  int64  
     7   x        53940 non-null  float64
     8   y        53940 non-null  float64
     9   z        53940 non-null  float64
    dtypes: float64(6), int64(1), object(3)
    memory usage: 4.1+ MB



```python
dia['price'].nunique()
```




    11602




```python
# 2: price 컬럼을 '고가', '중가', '저가' 세개의 범주값을 가지는 "price_cate" 컬럼을 생성한다.
```


```python
# price을 3등분을 나눔
price_cate1 = pd.cut(dia['price'], bins=3, labels=['저가','중가','고가'])
price_cate1.value_counts()
```




    price
    저가    43591
    중가     7347
    고가     3002
    Name: count, dtype: int64




```python
# min, max 값을 조회후 범위를 지정
dia['price'].agg(['min','max'])
```




    min      326
    max    18823
    Name: price, dtype: int64




```python
# 300 ~ 1000: 저가, 1000 ~ 10000: 중가, 10000 ~ 20000: 고가
price_range = [300,1000, 15000, 20000]
price_range
```




    [300, 1000, 15000, 20000]




```python
price_cate2 = pd.cut(dia.price, bins=price_range, labels=['저가','중가','고가'])
price_cate2.value_counts()
```




    price
    중가    37761
    저가    14524
    고가     1655
    Name: count, dtype: int64




```python
# 개수로 나눔
price_cate3 = pd.qcut(dia.price, q=3, labels=['저가','중가','고가'])
price_cate3.value_counts()
```




    price
    저가    17996
    고가    17980
    중가    17964
    Name: count, dtype: int64




```python
## 가격대 컬럼추가
dia['price_cate'] = price_cate1
dia.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>carat</th>
      <th>cut</th>
      <th>color</th>
      <th>clarity</th>
      <th>depth</th>
      <th>table</th>
      <th>price</th>
      <th>x</th>
      <th>y</th>
      <th>z</th>
      <th>price_cate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.23</td>
      <td>Ideal</td>
      <td>E</td>
      <td>SI2</td>
      <td>61.5</td>
      <td>55.0</td>
      <td>326</td>
      <td>3.95</td>
      <td>3.98</td>
      <td>2.43</td>
      <td>저가</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.21</td>
      <td>Premium</td>
      <td>E</td>
      <td>SI1</td>
      <td>59.8</td>
      <td>61.0</td>
      <td>326</td>
      <td>3.89</td>
      <td>3.84</td>
      <td>2.31</td>
      <td>저가</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.23</td>
      <td>Good</td>
      <td>E</td>
      <td>VS1</td>
      <td>56.9</td>
      <td>65.0</td>
      <td>327</td>
      <td>4.05</td>
      <td>4.07</td>
      <td>2.31</td>
      <td>저가</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.29</td>
      <td>Premium</td>
      <td>I</td>
      <td>VS2</td>
      <td>62.4</td>
      <td>58.0</td>
      <td>334</td>
      <td>4.20</td>
      <td>4.23</td>
      <td>2.63</td>
      <td>저가</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.31</td>
      <td>Good</td>
      <td>J</td>
      <td>SI2</td>
      <td>63.3</td>
      <td>58.0</td>
      <td>335</td>
      <td>4.34</td>
      <td>4.35</td>
      <td>2.75</td>
      <td>저가</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 3 가격대(price_cate) 별 carat의 평균을 조회
dia.groupby('price_cate')['carat'].mean()
```

    C:\Users\world\AppData\Local\Temp\ipykernel_9060\202613706.py:2: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.
      dia.groupby('price_cate')['carat'].mean()





    price_cate
    저가    0.627943
    중가    1.362280
    고가    1.885256
    Name: carat, dtype: float64




```python
# 4 가격대(price_cate)와 cut별 평균 가격(price)를 피봇테이블로 조회
dia.pivot_table(index='cut',columns='price_cate', values='price', aggfunc='mean')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>price_cate</th>
      <th>저가</th>
      <th>중가</th>
      <th>고가</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fair</th>
      <td>2976.492819</td>
      <td>8891.044335</td>
      <td>15176.404762</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>2589.423161</td>
      <td>8744.889273</td>
      <td>15412.570213</td>
    </tr>
    <tr>
      <th>Ideal</th>
      <td>1991.838539</td>
      <td>9019.390308</td>
      <td>15422.528676</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>2513.585759</td>
      <td>9045.209888</td>
      <td>15391.247016</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>2383.723178</td>
      <td>8921.683740</td>
      <td>15502.217323</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 5 cut, color, price_cate 별 carat의 평균을 피봇테이블로 조회
dia.pivot_table(index=['cut','price_cate'],columns='color', values='carat', aggfunc='mean')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
    </tr>
    <tr>
      <th>cut</th>
      <th>price_cate</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Fair</th>
      <th>저가</th>
      <td>0.807122</td>
      <td>0.767424</td>
      <td>0.791801</td>
      <td>0.849462</td>
      <td>0.977699</td>
      <td>0.988750</td>
      <td>1.067717</td>
    </tr>
    <tr>
      <th>중가</th>
      <td>1.339412</td>
      <td>1.443500</td>
      <td>1.564483</td>
      <td>1.807895</td>
      <td>1.796226</td>
      <td>1.784000</td>
      <td>1.985000</td>
    </tr>
    <tr>
      <th>고가</th>
      <td>2.145714</td>
      <td>1.843333</td>
      <td>1.957273</td>
      <td>1.995000</td>
      <td>2.218750</td>
      <td>2.407778</td>
      <td>2.691818</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Good</th>
      <th>저가</th>
      <td>0.670725</td>
      <td>0.651305</td>
      <td>0.689913</td>
      <td>0.708228</td>
      <td>0.730387</td>
      <td>0.764122</td>
      <td>0.854693</td>
    </tr>
    <tr>
      <th>중가</th>
      <td>1.277551</td>
      <td>1.256889</td>
      <td>1.298312</td>
      <td>1.349915</td>
      <td>1.523187</td>
      <td>1.630000</td>
      <td>1.695397</td>
    </tr>
    <tr>
      <th>고가</th>
      <td>1.626500</td>
      <td>1.717097</td>
      <td>1.809286</td>
      <td>1.864048</td>
      <td>2.093810</td>
      <td>2.104643</td>
      <td>2.242500</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Ideal</th>
      <th>저가</th>
      <td>0.502135</td>
      <td>0.511158</td>
      <td>0.529869</td>
      <td>0.528951</td>
      <td>0.617462</td>
      <td>0.669981</td>
      <td>0.792335</td>
    </tr>
    <tr>
      <th>중가</th>
      <td>1.170843</td>
      <td>1.198333</td>
      <td>1.189853</td>
      <td>1.193722</td>
      <td>1.398540</td>
      <td>1.533642</td>
      <td>1.645655</td>
    </tr>
    <tr>
      <th>고가</th>
      <td>1.430909</td>
      <td>1.501395</td>
      <td>1.609551</td>
      <td>1.694875</td>
      <td>1.947143</td>
      <td>2.097365</td>
      <td>2.229880</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Premium</th>
      <th>저가</th>
      <td>0.599525</td>
      <td>0.591792</td>
      <td>0.666792</td>
      <td>0.629871</td>
      <td>0.765683</td>
      <td>0.794620</td>
      <td>0.901903</td>
    </tr>
    <tr>
      <th>중가</th>
      <td>1.264649</td>
      <td>1.260486</td>
      <td>1.268342</td>
      <td>1.300076</td>
      <td>1.525855</td>
      <td>1.610519</td>
      <td>1.716263</td>
    </tr>
    <tr>
      <th>고가</th>
      <td>1.636000</td>
      <td>1.715130</td>
      <td>1.705594</td>
      <td>1.793261</td>
      <td>2.069171</td>
      <td>2.127762</td>
      <td>2.236724</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Very Good</th>
      <th>저가</th>
      <td>0.599320</td>
      <td>0.577348</td>
      <td>0.619161</td>
      <td>0.614364</td>
      <td>0.712640</td>
      <td>0.760677</td>
      <td>0.832754</td>
    </tr>
    <tr>
      <th>중가</th>
      <td>1.226980</td>
      <td>1.212459</td>
      <td>1.193546</td>
      <td>1.244620</td>
      <td>1.489892</td>
      <td>1.551324</td>
      <td>1.707778</td>
    </tr>
    <tr>
      <th>고가</th>
      <td>1.552857</td>
      <td>1.740141</td>
      <td>1.688632</td>
      <td>1.735664</td>
      <td>2.019664</td>
      <td>2.100703</td>
      <td>2.150377</td>
    </tr>
  </tbody>
</table>
</div>

