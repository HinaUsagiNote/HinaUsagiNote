---
layout: single
title: '변수와 연산자'
typora-root-url: ../
---

# 데이터프레임 합치기
- 두개 이상의 DataFrame을 합쳐 하나의 DataFrame으로 만든다.

![image.png](image.png)

- **수직결합**
    - 단순결합으로 여러개의 DataFrame들의 같은 컬럼끼리 수직으로 합친다.
- **수평결합**
    - 연관성 있는 여러 데이터를 하나로 합쳐서 조회하는 JOIN 처리를 한다.
    - JOIN은 합치려는 DataFrame들의 index 나 특정 컬럼의 값이 같은 행 끼리 합친다.

## 데이터셋 읽기
- stocks_2016.csv, stocks_2017.csv, stocks_2018.csv : 년도별 보유 주식
- stocks_info.csv : 주식 정보


```python
import pandas as pd
```


```python
pd.read_csv('data/stocks_2016.csv')
pd.read_csv('data/stocks_2017.csv')
pd.read_csv('data/stocks_2018.csv')
pd.read_csv('data/stocks_info.csv')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GE</td>
      <td>General Electric</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IBM</td>
      <td>IBM(International Business Machines Co)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SLB</td>
      <td>Schlumberger Limited.</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TXN</td>
      <td>Texas Instruments Incorporated</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AMZN</td>
      <td>Amazon.com, Inc</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 파일명이 다 제각각 다른경우(패턴이 없는 경우)는 리스트 전체 경로를 다 넣는다
['data/stocks_2016.csv', 'data/stocks_2017.csv', 'data/stocks_2018.csv', 'data/stocks_info.csv']
```




    ['data/stocks_2016.csv',
     'data/stocks_2017.csv',
     'data/stocks_2018.csv',
     'data/stocks_info.csv']




```python
# List 컴프레이션 대입 
files = ['2016', '2017', '2018', 'info']
stock_2016, stock_2017, stock_2018, stock_info = [pd.read_csv(f'data/stocks_{file}.csv') for file in files]
```


```python
stock_2016.shape, stock_2017.shape, stock_2018.shape, stock_info.shape
```




    ((3, 4), (6, 4), (3, 4), (8, 2))




```python
# 특정 디렉토리안의 파일들의 경로를 지정 = 파일다룰때 많이 사용
from glob import glob 
```


```python
## 파일명 : * : 0개 이상의 모든 글자
## 디렉토리 : ** : 모든 하위 디렉토리.
glob('data/*.csv')
```




    ['data\\customer.csv',
     'data\\diamonds.csv',
     'data\\flights.csv',
     'data\\movie.csv',
     'data\\order.csv',
     'data\\qna.csv',
     'data\\state_fruit.csv',
     'data\\stocks_2016.csv',
     'data\\stocks_2017.csv',
     'data\\stocks_2018.csv',
     'data\\stocks_info.csv',
     'data\\walmart_stock.csv']




```python
# data 디렉토리 바로 아래 있는 파일들중 확장자가 csv인 파일들의 경로
'data/*.csv'
```


```python
# data 디렉토리 + 그 하위 디렉토리에 있는 모든 csv파일
'data/**/*.csv'
```


```python
[pd.read_csv(file) for file in glob('data/stock*.csv')]
```




    [  Symbol  Shares  Low  High
     0   AAPL      80   95   110
     1   TSLA      50   80   130
     2    WMT      40   55    70,
       Symbol  Shares  Low  High
     0   AAPL      50  120   140
     1     GE     100   30    40
     2    IBM      87   75    95
     3    SLB      20   55    85
     4    TXN     500   15    23
     5   TSLA     100  100   300,
       Symbol  Shares  Low  High
     0   AAPL      40  135   170
     1   AMZN       8  900  1125
     2   TSLA      50  220   400,
       Symbol                                     Name
     0   AAPL                                Apple Inc
     1   TSLA                                Tesla Inc
     2    WMT                              Walmart Inc
     3     GE                         General Electric
     4    IBM  IBM(International Business Machines Co)
     5    SLB                    Schlumberger Limited.
     6    TXN           Texas Instruments Incorporated
     7   AMZN                          Amazon.com, Inc]




```python
stock_2016
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_info
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GE</td>
      <td>General Electric</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IBM</td>
      <td>IBM(International Business Machines Co)</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SLB</td>
      <td>Schlumberger Limited.</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TXN</td>
      <td>Texas Instruments Incorporated</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AMZN</td>
      <td>Amazon.com, Inc</td>
    </tr>
  </tbody>
</table>
</div>



## concat() 이용
- 수직, 수평 결합 모두 지원한다.
- 하나의 데이터셋을 여러 DataFrame으로 나눈 것을 하나의 DataFrame으로 합칠 때 사용한다.

- **수직 결합** (행이 늘어나도록 합친다.)
    - **컬럼명이 같은 열끼리 합친다.**
    - 같은 column 명이 없는 열들도 결과 DataFrame에 들어간다.(default)
        - full outer join개념
- **수평결합** (열이 늘어나도록 합친다.)
    - **index명이 같은 행 끼리 합친다.** (equi-join)
    - 같은 index명이 없는 행들도 결과 DataFrame에 들어간다.(default)
        - full outer join

- pd.concat(objs,  [, key=리스트]), axis=0, join='outer' )
    - 매개변수
        - objs: 합칠 DataFrame들을 리스트로 전달
        - keys=[] 를 이용해 합친 행들을 구분하기 위한 다중 인덱스 처리
        - axis
            - 0 또는 index : 수직결합
            - 1 또는 columns : 수평결합
        - join: 
            - 합치는 방식으로 다음 문자열을 값으로 설정한다.
                - 'outer'(기본값): full outer join
                - 'inner': inner join (동일한 index명, column명 끼리 합친다.)

> ### 조인(join)
> - 여러 데이터프레임에 흩어져 있는 정보 중 필요한 정보만 모아서 결합하기 위한 것.
> - 두개 이상의 데이터프레임을 특정 컬럼(열)의 값이 같은 행 끼리 수평 결합하는 것.
> - Inner Join, Left Outer Join, Right Outer Join, Full Outer Join


```python
# Default 방향: 0 -> 수직 결합 => 같은 컬럼들끼리 합친다.
stocks = pd.concat([stock_2016, stock_2017, stock_2018])
stocks.shape
```




    (12, 4)




```python
stocks2 = stocks.copy()
```


```python
# ignore_index : index이름은 합칠때 무시.(버린다.)
stocks2 = pd.concat([stock_2016,stock_2017,stock_2018], ignore_index=True)
stocks2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th>3</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>4</th>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>5</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>6</th>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>7</th>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>8</th>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th>9</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>10</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>11</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
# keys : multi index => 컬럼명, index명을 여러개의 값으로 구성된것
stocks3 = pd.concat([stock_2016,stock_2017,stock_2018], keys=['2016년','2017년','2018년'])
```


```python
# Level : 컬럼을 구성하는 값들의 단위를 Level => 밖에서 안으로 들어오는 방향으로 0, 1, 2 Level이 됨 (반대방향 : 음수 index)
## Level_0 | Level_1 |
##  2016       0
stocks3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2016년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">2017년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
    <tr>
      <th>3</th>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
    </tr>
    <tr>
      <th>4</th>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
    </tr>
    <tr>
      <th>5</th>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2018년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Multi index -> Level 0 기준 조회
stocks3.loc['2016년']
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Level 1 묶어서 조회 -> 튜플로 묶어서 전달
stocks3.loc[('2016년',0)]
```




    Symbol    AAPL
    Shares      80
    Low         95
    High       110
    Name: (2016년, 0), dtype: object




```python
# penshing index 
stocks3.loc[['2016년','2018년']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2016년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">2018년</th>
      <th>0</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Multi index 행/컬럼을 조회하는 메소드 
## 0 : 조회할 컬럼/행이름 / axis: 0: 행, 1: 열 / level: 조회할 이름의 level 위치
stocks3.xs(0, axis=0, level=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2016년</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>2017년</th>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>2018년</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 행기준(수평)으로 합치기 -> index name이 같은 행끼리
stocks4 = pd.concat([stock_2016, stock_2017, stock_2018], axis=1)
stocks4
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80.0</td>
      <td>95.0</td>
      <td>110.0</td>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
      <td>AAPL</td>
      <td>40.0</td>
      <td>135.0</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50.0</td>
      <td>80.0</td>
      <td>130.0</td>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
      <td>AMZN</td>
      <td>8.0</td>
      <td>900.0</td>
      <td>1125.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40.0</td>
      <td>55.0</td>
      <td>70.0</td>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
      <td>TSLA</td>
      <td>50.0</td>
      <td>220.0</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>SLB</td>
      <td>20</td>
      <td>55</td>
      <td>85</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TXN</td>
      <td>500</td>
      <td>15</td>
      <td>23</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>TSLA</td>
      <td>100</td>
      <td>100</td>
      <td>300</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2016 # 0, 1, 2
stock_2017 # 0, 1, 2, 3, 4, 5
stock_2018 # 0, 1, 2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 수평방향으로 합치기, inner join => 같은 index이름끼리 합친다.
## ignore_index => 수평 => 컬럼명 무시, keys: 컬럼: multi index
stock5 = pd.concat([stock_2016, stock_2017, stock_2018], axis=1, join='inner', keys=['2016년','2017년','2018년'])

stock5
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">2016년</th>
      <th colspan="4" halign="left">2017년</th>
      <th colspan="4" halign="left">2018년</th>
    </tr>
    <tr>
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock5['2016년']
stock5[['2016년','2017년']]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="4" halign="left">2016년</th>
      <th colspan="4" halign="left">2017년</th>
    </tr>
    <tr>
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>AAPL</td>
      <td>50</td>
      <td>120</td>
      <td>140</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>GE</td>
      <td>100</td>
      <td>30</td>
      <td>40</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
      <td>IBM</td>
      <td>87</td>
      <td>75</td>
      <td>95</td>
    </tr>
  </tbody>
</table>
</div>




```python
# (Level0, Level1) -> tuple로 묶는다
stock5[('2016년','Shares')]
```




    0    80
    1    50
    2    40
    Name: (2016년, Shares), dtype: int64




```python
stock5.xs('Shares', level=-1, axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2016년</th>
      <th>2017년</th>
      <th>2018년</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80</td>
      <td>50</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50</td>
      <td>100</td>
      <td>8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>40</td>
      <td>87</td>
      <td>50</td>
    </tr>
  </tbody>
</table>
</div>



## 조인을 통한 DataFrame 합치기
- 연관성있는 둘 이상의 DataFrame을 하나로 합친다.
    - ex) 고객과 주문정보, 교수와 수업정보, 직원과 부서정보
- **join()**
    - **2개 이상**의 DataFrame을 조인할 때 사용
- **merge()**
    - **2개의** DataFrame의 조인만 지원

### join()
- dataframe객체.join(others, how='left', lsuffix='', rsuffix='') 
- `df_A.join(df_b)`, `df_A.join([df_b, df_c, df_d])`
- 두개 이상의 DataFrame들을 조인 할 수 있다.
    - **조인 기준**: index가 같은 값인 행끼리 합친다. (equi-join)
    - **조인 기본 방식**: Left Outer Join
- 매개변수
    - lsuffix, rsuffix
        - 조인 대상 DataFrame에 같은 이름의 컬럼이 있으면 에러 발생.
        - 같은 이름이 있는 경우 붙일 접미어 지정
    - how :조인방식. 'left', 'right', 'outer', 'inner'. left가 기본
        


```python
# stock_info : Symbol
# stock_2018 : Symbol
## Symbol => index로 변경
result1= stock_info.set_index('Symbol').join(stock_2018.set_index('Symbol'))
result1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>Apple Inc</td>
      <td>40.0</td>
      <td>135.0</td>
      <td>170.0</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>Tesla Inc</td>
      <td>50.0</td>
      <td>220.0</td>
      <td>400.0</td>
    </tr>
    <tr>
      <th>WMT</th>
      <td>Walmart Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>GE</th>
      <td>General Electric</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>IBM</th>
      <td>IBM(International Business Machines Co)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>SLB</th>
      <td>Schlumberger Limited.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>TXN</th>
      <td>Texas Instruments Incorporated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>AMZN</th>
      <td>Amazon.com, Inc</td>
      <td>8.0</td>
      <td>900.0</td>
      <td>1125.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
# how:right -> stock_2018 index같은 행만, inner: symbol 같은 행만
result2= stock_info.set_index('Symbol').join(stock_2018.set_index('Symbol'), how='right')
result2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>Apple Inc</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>AMZN</th>
      <td>Amazon.com, Inc</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>Tesla Inc</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 동일한 컬럼명 => 컬럼명을 바꿔줘야한다. Error
# stock_info.set_index('Symbol').join([stock_2016.set_index('Symbol'), stock_2017.set_index('Symbol')] )
```


```python
stock_info.set_index('Symbol').join([stock_2016.set_index('Symbol').add_suffix('2016'), 
                                     stock_2017.set_index('Symbol').add_suffix('2017')])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Shares2016</th>
      <th>Low2016</th>
      <th>High2016</th>
      <th>Shares2017</th>
      <th>Low2017</th>
      <th>High2017</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>Apple Inc</td>
      <td>80.0</td>
      <td>95.0</td>
      <td>110.0</td>
      <td>50.0</td>
      <td>120.0</td>
      <td>140.0</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>Tesla Inc</td>
      <td>50.0</td>
      <td>80.0</td>
      <td>130.0</td>
      <td>100.0</td>
      <td>100.0</td>
      <td>300.0</td>
    </tr>
    <tr>
      <th>WMT</th>
      <td>Walmart Inc</td>
      <td>40.0</td>
      <td>55.0</td>
      <td>70.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>GE</th>
      <td>General Electric</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>100.0</td>
      <td>30.0</td>
      <td>40.0</td>
    </tr>
    <tr>
      <th>IBM</th>
      <td>IBM(International Business Machines Co)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>87.0</td>
      <td>75.0</td>
      <td>95.0</td>
    </tr>
    <tr>
      <th>SLB</th>
      <td>Schlumberger Limited.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>20.0</td>
      <td>55.0</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>TXN</th>
      <td>Texas Instruments Incorporated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>500.0</td>
      <td>15.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>AMZN</th>
      <td>Amazon.com, Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 컬럼명 뒤에 접미어 붙여준다.
stock_2016.set_index('Symbol').add_suffix('2016')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol2016</th>
      <th>Shares2016</th>
      <th>Low2016</th>
      <th>High2016</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 컬럼명 뒤에 접두어 붙여준다.
stock_2016.add_prefix('2016')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>2016Symbol</th>
      <th>2016Shares</th>
      <th>2016Low</th>
      <th>2016High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>



### merge()
- `df_a.merge(df_b)`
- 두개의 DataFrame간의 조인만 가능하다.
    - **조인 기준**
        - **같은 컬럼명**을 기준으로 equi-join을 하는 것이 기본이다.
        - **조인기준을 다양하게 정할 수 있다.**
            - 컬럼, index등을 기준으로 같은 행끼리 join 하도록 설정할 수 있다.
    - **조인 기본 방식**
        - inner join
        - how 매개변수를 이용해 변경이 가능하다.
- `dataframe.merge(합칠dataframe, how='inner', on=None, left_on=None, right_on=None, left_index=False, right_index=False)`  
- 매개변수
    - on : 같은 컬럼명이 여러개일때 join 대상 컬럼을 선택
    - right_on, left_on : 조인할 때 사용할 왼쪽,오른쪽 Dataframe의 컬럼명. 
    - left_index, right_index: 조인 할때 index를 사용할 경우 True로 지정 
    - how : 조인 방식.  'left', 'right', 'outer', 'inner'. 기본: inner 
    - suffixes: 두 DataFrame에 같은 이름의 컬럼명이 있을 경우 구분을 위해 붙인 접미어를 리스트로 설정
        - 생략시 x, y를 붙인다.       


```python
# Default: 같은이름의 컬럼명을 기준으로 join
## how Default => inner
stock_info.merge(stock_2016, how='left')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
      <td>80.0</td>
      <td>95.0</td>
      <td>110.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
      <td>50.0</td>
      <td>80.0</td>
      <td>130.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
      <td>40.0</td>
      <td>55.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>GE</td>
      <td>General Electric</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>IBM</td>
      <td>IBM(International Business Machines Co)</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>5</th>
      <td>SLB</td>
      <td>Schlumberger Limited.</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>TXN</td>
      <td>Texas Instruments Incorporated</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>7</th>
      <td>AMZN</td>
      <td>Amazon.com, Inc</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock2016 = stock_2016.set_index('Symbol')
stock2016
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
    <tr>
      <th>Symbol</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AAPL</th>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>TSLA</th>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>WMT</th>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
# stock_info : Symbol - 컬럼, stock2016: Symbol - index
## left_on='Symbol' => 왼쪽 DF(stock_info)의 join 컬럼 지정
## right_index='True' => 오른쪽 DF (stock2016)의 index를 join 기준으로 사용
stock_info.merge(stock2016, left_on='Symbol', right_index=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Name</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>Apple Inc</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>Tesla Inc</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
    </tr>
    <tr>
      <th>2</th>
      <td>WMT</td>
      <td>Walmart Inc</td>
      <td>40</td>
      <td>55</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 동일한 이름의 컬럼이 여러개이고 이중 join 기준컬럼은 일부를 사용할 경우
## on : join 컬럼명 지정, suffixes : 접미어를 지정 => Default: x, y
stock_2016.merge(stock_2018, on='Symbol', suffixes=['2016','2018'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares2016</th>
      <th>Low2016</th>
      <th>High2016</th>
      <th>Shares2018</th>
      <th>Low2018</th>
      <th>High2018</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>80</td>
      <td>95</td>
      <td>110</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>TSLA</td>
      <td>50</td>
      <td>80</td>
      <td>130</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
stock_2018
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Symbol</th>
      <th>Shares</th>
      <th>Low</th>
      <th>High</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>AAPL</td>
      <td>40</td>
      <td>135</td>
      <td>170</td>
    </tr>
    <tr>
      <th>1</th>
      <td>AMZN</td>
      <td>8</td>
      <td>900</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>TSLA</td>
      <td>50</td>
      <td>220</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>



- 하나의 데이터셋을 어떤 특정행 또튼 특정열을 기준으로 단순해 분리 한 경우를 합치는 경우 concat() 사용
    - 수직 결합일 경우는 concat()을 사용해야 한다. 
- 서로 연관성 있는 다른 데이터셋을 결합해서 보는 경우 join(), merge()를 사용한다. (Join)
    - **두 개 이상의** DataFrame을 조인할 때는 하는 경우 : join() 사용
    - 두개의 DataFrame을 조인할 때는 **merge()** 를 사용한다. => 컨트롤이 편하다.

<b style='font-size:2em'>TODO</b>


```python
# 1 data/customer.csv, data/order.csv, data/qna.csv 를 DataFrame으로 읽으시오.

files = ['customer','order','qna']
customer, order, qna = [pd.read_csv(f'data/{file}.csv') for file in files]
customer.shape, order.shape, qna.shape
```




    ((5, 3), (6, 3), (3, 3))




```python
# 2 TODO1에서 읽은 세개의 데이터셋의 정보를 확인하세요. 
print(customer.columns)
print(order.columns)
print(qna.columns)
```

    Index(['id', 'name', 'age'], dtype='object')
    Index(['order_id', 'cust_id', 'total_price'], dtype='object')
    Index(['qna_no', 'cust_id', 'txt'], dtype='object')
    


```python
# 3 customer DataFrame과 order DataFrame을 고객정보는 모두 나오도록 join 하세요.

# on : customer:cust_id을 조인, how : customer 정보 모두나옴
result = customer.merge(order, left_on='id', right_on='cust_id', how='left').drop(columns='cust_id')
result
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>name</th>
      <th>age</th>
      <th>order_id</th>
      <th>total_price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>id-1</td>
      <td>김영수</td>
      <td>33</td>
      <td>1.0</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>id-1</td>
      <td>김영수</td>
      <td>33</td>
      <td>2.0</td>
      <td>250000.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
      <td>3.0</td>
      <td>300000.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
      <td>4.0</td>
      <td>15000.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>id-2</td>
      <td>박선영</td>
      <td>23</td>
      <td>5.0</td>
      <td>51000.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>id-3</td>
      <td>오정현</td>
      <td>21</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>6</th>
      <td>id-4</td>
      <td>박명수</td>
      <td>40</td>
      <td>6.0</td>
      <td>32000.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>id-5</td>
      <td>이철기</td>
      <td>17</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 4 customer DataFrame의 index를 id컬럼으로 변경.
customer.set_index('id', inplace=True)
```


```python
customer
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
    </tr>
    <tr>
      <th>id</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>김영수</td>
      <td>33</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>오정현</td>
      <td>21</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>이철기</td>
      <td>17</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 5 4에서 만든 customer DataFrame과 qna DataFrame을 inner join 하세요.
## join() - index name 기준
customer.join(qna.set_index('cust_id'), how='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>qna_no</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>1</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>2</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>이철기</td>
      <td>17</td>
      <td>3</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>




```python
# merge()
customer.merge(qna, left_index=True, right_on='cust_id', how='inner')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>qna_no</th>
      <th>cust_id</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>박명수</td>
      <td>40</td>
      <td>1</td>
      <td>id-4</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>1</th>
      <td>박명수</td>
      <td>40</td>
      <td>2</td>
      <td>id-4</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>2</th>
      <td>이철기</td>
      <td>17</td>
      <td>3</td>
      <td>id-5</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 6. 세개의 DataFrame을 고객정보는 모두 나오도록 join 하세요.
customer.join([order.set_index('cust_id'), qna.set_index('cust_id')], how='left')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>age</th>
      <th>order_id</th>
      <th>total_price</th>
      <th>qna_no</th>
      <th>txt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>id-1</th>
      <td>김영수</td>
      <td>33</td>
      <td>1.0</td>
      <td>100000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-1</th>
      <td>김영수</td>
      <td>33</td>
      <td>2.0</td>
      <td>250000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
      <td>3.0</td>
      <td>300000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
      <td>4.0</td>
      <td>15000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-2</th>
      <td>박선영</td>
      <td>23</td>
      <td>5.0</td>
      <td>51000.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-3</th>
      <td>오정현</td>
      <td>21</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>6.0</td>
      <td>32000.0</td>
      <td>1.0</td>
      <td>물건있나요?</td>
    </tr>
    <tr>
      <th>id-4</th>
      <td>박명수</td>
      <td>40</td>
      <td>6.0</td>
      <td>32000.0</td>
      <td>2.0</td>
      <td>얼마에요</td>
    </tr>
    <tr>
      <th>id-5</th>
      <td>이철기</td>
      <td>17</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>반품은 어떻게 해요?</td>
    </tr>
  </tbody>
</table>
</div>


