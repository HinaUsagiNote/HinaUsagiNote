---
layout: single
title: '변수와 연산자'
typora-root-url: ../
---

# 정돈된 데이터 (Tidy data) 개요
대부분 실행환경에서의 많은 데이터 셋은 세부적 분석을 작업을 하기 전에 상당한 양의 데이터 재구성을 할 필요가 있다. 경우에 따라서는 전체 프로젝트 자체가 오로지 다른 사람들이 사용하기 쉬운 형태로 데이터를 재구성하는 일일 경우도 있다.

데이터 재구성의 목적은 **정돈된 데이터(tidy data)** 를 만드는 것이다.     
Tidy data란 용어는 해들리 위컴이 **분석이 용이한 형태로 구성되 있는 데이터셋**을 설명하기 위해 만든 용어이다. [논문 링크](http://vita.had.co.nz/papers/tidy-data.pdf)

## 정돈된 데이터란?
- 각 **변수**(데이터의 속성)는 열을 형성한다.
- 각 **관측값**(하나의 데이터)은 행을 형성한다.
- 각 **관측 단위별**로 별도의 테이블(표)을 구성한다. 
    - 단일 관측

### 변수, 관측값, 관측단위
- **변수**
    - Feature, 컬럼, 속성
    - 데이터를 구성하는 요소들
    - **변수 이름**
        - 성별, 인종, 연봉, 직위 같은 레이블
    - **변수 값** 
        - 관측 때마다 달라지는 값
            - 각 변수가 가질 수 있는 값
        - 예
            - 성: 남성/여성 - 범주형
            - 인종: 황인/흑인/백인 - 범주형
            - 연봉: 삼천만원, 사천만원... - 연속형
            - 키: 100.0 ~ 250.0 - 연속형

- **단일 관측**
    - 하나의 관측단위, 하나의 데이터를 말한다.
        - DataFrame(Pandas), Table(데이터베이스), Table(엑셀)로 표현된다.
    - 단일 관측 대상은 여러개의 속성들로 구성되며 그 속성을 변수라고 한다.
        - 단일 관측은 하나의 데이터 대한 모든 변수(속성)들의 모음
    - 예)
        - 고객, 제품, 계좌
    - **종업원정보(근무시간같은)와 고객정보(구매 액수)를 같은 테이블에 병합하는 것은 단일 관측이라 할수 없다.** -> **정돈된 데이터의 원칙에 위배된다.**
    

## 정돈되지 않은 데이터의 가장 흔한 형태
1. 열 이름이 변수 이름이 아니라 값인 경우
1. 열 이름에 복수 개의 변수가 저장된 경우
1. 변수가 행과 열에 모두 저장된 경우
1. 같은 테이블에 복수의 관측단위가 저장된 경우
    - 하나의 테이블에 여러 데이터(관측단위)가 병합된 것
1. 단일 관측 단위가 복수 테이블에 저장된 경우
    - 하나의 데이터의 변수들이 여러 테이블에 나눠 저장된 경우

    
### 데이터를 정돈한다의 의미
단순히 데이터셋의 값을 바꾸거나 결측치를 채운다는 것만을 말하지 않는다. 데이터를 정돈하는 것은 데이터의 형태나 구조를 정돈 원칙에 맞게 변형시키는 것이다. 
- **데이터가 올바른 형태로 주어진다면 분석이 쉬워진다.**
- 다양한 형태의 조회에 적용할 수 있도록 데이터셋을 만들어 준다.

# [DataFrame의 구조 변경을 위한 메소드](https://pandas.pydata.org/pandas-docs/stable/user_guide/reshaping.html)
- stack()
- melt()
- unstack()
- pivot()
- pivot_table()
- crosstab()
- 텍스트 분해를 위한 str accessor
- 정돈된 데이터를 다듬는 메소드
    - rename()
    - rename_axis()
    - reset_index()
    - set_index() 

## [stack()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.stack.html)
- 컬럼명을 index(행명)으로 전환
    - 기존 index가 있으면 하위 레벨로 들어간다. (기존 것이 상위 레벨)
- 컬럼명을 컬럼의 값으로 전치시킬때도 사용할 수 있다.
- 매개변수
    - dropna=False : 처리 시 생성되는 NA(결측치)는 제거되지 않게 한다. (default: True => 제거)



```python
import pandas as pd
import numpy as np
```


```python
pd.read_csv('data/state_fruit.csv')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>Apple</th>
      <th>Orange</th>
      <th>Banana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>12</td>
      <td>10</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>9</td>
      <td>7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>0</td>
      <td>14</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
# index_col : index column drop
df = pd.read_csv('data/state_fruit.csv', index_col=0)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Apple</th>
      <th>Orange</th>
      <th>Banana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Texas</th>
      <td>12</td>
      <td>10</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Arizona</th>
      <td>9</td>
      <td>7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>0</td>
      <td>14</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
# column -> index
s1 = df.stack()
s1
```




    Texas    Apple      12
             Orange     10
             Banana     40
    Arizona  Apple       9
             Orange      7
             Banana     12
    Florida  Apple       0
             Orange     14
             Banana    190
    dtype: int64




```python
# Series -> DataFrame (Series의 index-DF index, value-column) 
s1.to_frame()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Texas</th>
      <th>Apple</th>
      <td>12</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>10</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>40</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Arizona</th>
      <th>Apple</th>
      <td>9</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>12</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Florida</th>
      <th>Apple</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
# Args로 문자열 -> 컬럼명 (생략 : 0)
s1 = s1.to_frame('Count')
s1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Texas</th>
      <th>Apple</th>
      <td>12</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>10</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>40</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Arizona</th>
      <th>Apple</th>
      <td>9</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>12</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Florida</th>
      <th>Apple</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
# index name -> 컬럼으로 변경
tidy_df = s1.reset_index()
tidy_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>level_0</th>
      <th>level_1</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
tidy_df.columns = ['state','fruit','count']
tidy_df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>fruit</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.stack()
```




    Texas    Apple      12
             Orange     10
             Banana     40
    Arizona  Apple       9
             Orange      7
             Banana     12
    Florida  Apple       0
             Orange     14
             Banana    190
    dtype: int64




```python
# series/dataframe.rename_axis() => index 축 이름, column 축 이름을 변경. (index/column 이름의 이름)
df.stack().rename_axis(['state','fruit'])
```




    state    fruit 
    Texas    Apple      12
             Orange     10
             Banana     40
    Arizona  Apple       9
             Orange      7
             Banana     12
    Florida  Apple       0
             Orange     14
             Banana    190
    dtype: int64




```python
df.stack().rename_axis(['state','fruit']).reset_index(name='count')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>fruit</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>



## unstack()
- stack() 반대로 index를 컬럼으로 변환한다.
- 매개변수 
    - level: multi-index일 경우 컬럼으로 만들 레벨을 지정한다. 기본값은 -1 로 가장 안쪽의 index를 이동시킨다.


```python
s = tidy_df.set_index(['state','fruit'])
s
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
    </tr>
    <tr>
      <th>state</th>
      <th>fruit</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Texas</th>
      <th>Apple</th>
      <td>12</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>10</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>40</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Arizona</th>
      <th>Apple</th>
      <td>9</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>7</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>12</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Florida</th>
      <th>Apple</th>
      <td>0</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>14</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
s.unstack()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">count</th>
    </tr>
    <tr>
      <th>fruit</th>
      <th>Apple</th>
      <th>Banana</th>
      <th>Orange</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Arizona</th>
      <td>9</td>
      <td>12</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>0</td>
      <td>190</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>12</td>
      <td>40</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
# level 가장안쪽 index를 이동 (생략 : -1)
s.unstack(level=0)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="3" halign="left">count</th>
    </tr>
    <tr>
      <th>state</th>
      <th>Arizona</th>
      <th>Florida</th>
      <th>Texas</th>
    </tr>
    <tr>
      <th>fruit</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Apple</th>
      <td>9</td>
      <td>0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>Banana</th>
      <td>12</td>
      <td>190</td>
      <td>40</td>
    </tr>
    <tr>
      <th>Orange</th>
      <td>7</td>
      <td>14</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
# droplevel(level, index) => 컬럼, index명이 multi index일때 특정 level의 것을 제거 메소드.
## axis : 0 열, 1 행
s.unstack().droplevel(level=0, axis=1)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>fruit</th>
      <th>Apple</th>
      <th>Banana</th>
      <th>Orange</th>
    </tr>
    <tr>
      <th>state</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Arizona</th>
      <td>9</td>
      <td>12</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>0</td>
      <td>190</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>12</td>
      <td>40</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>



## [melt()](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.melt.html) - 컬럼명을 컬럼의 값으로 변환한다.

- 컬럼 명을 단일 컬럼의 값으로 변환한다.
- 변환할 컬럼들을 지정할 수 있어 stack()보다 더 유연하다.


### 매개변수
- **id_vars**: 값으로 변환하지 않고 그대로 유지하고자 하는 컬럼명(열이름)들의 리스트
    - *식별변수*라고도 한다.
    - 지정한 변수(컬럼)은 같은 열에 남게 되지만, value_vars에 전달된 각 열에 대해 반복적으로 나타난다.
- **value_vars**: 단일 컬럼의 값으로 변경하고자 하는 컬럼명 리스트
    - value_vars에 지정한 컬럼이 value가 되고 그 컬럼의 값들은 다른 컬럼으로 생성된다.
    - id_vars를 지정하지 않고 value_vars만 지정하면 value_vars에 **지정 안된** 컬럼은 제거된다.
        - 제거 되지 않고 **단독 컬럼으로 유지되길 바라는 컬럼은 id_vars**로 지정한다.
- **var_name**: value_vars로 단일열이 된 열의 이름 지정(지정 안하면 컬럼명은 **variable**)
- **value_name**: value_vars에 지정된 열들의 값들이 변환된 컬럼의 이름 지정(지정안하면 컬럼명은 **value**)


>
> - melt 한 경우 **index명은 무시된다.** => RangeIndex로 대체된다.
>    - index를 유지하려면 **reset_index**를 이용해 value로 뺀 뒤 해야 한다.
> - stack은 열이름을 index명으로 정돈(변경) 한다.
        


```python
df2 = df.rename_axis(index='State').reset_index()
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Apple</th>
      <th>Orange</th>
      <th>Banana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>12</td>
      <td>10</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>9</td>
      <td>7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>0</td>
      <td>14</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
# State : 유지 
df2.melt(id_vars=['State'], # 컬럼으로 그대로 유지
         value_vars=['Apple','Orange','Banana'], # 컬럼의 값으로 내릴 컬럼명들 지정
        )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2.melt(id_vars=['State'], # 컬럼으로 그대로 유지
         value_vars=['Apple','Orange','Banana'], # 컬럼의 값으로 내릴 컬럼명들 지정
         var_name='fruits', # 컬럼명을 값으로 가지는 컬럼 이름지정 -> Default : variable 
         value_name='count' # 값들을 값으로 가지는 컬럼 이름지정 -> Default : value
        )
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>fruits</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
df2
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Apple</th>
      <th>Orange</th>
      <th>Banana</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>12</td>
      <td>10</td>
      <td>40</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>9</td>
      <td>7</td>
      <td>12</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>0</td>
      <td>14</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
# id_vars를 생략하면 value_vars에 지정한 컬럼들 이외는 제거 (State, Banana)
df2.melt(value_vars=['Apple','Orange'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Orange</td>
      <td>14</td>
    </tr>
  </tbody>
</table>
</div>




```python
# id_vars만 설정. id_vars에 지정안된 모든 컬럼들이 variable의 값으로 들어간다.
df2.melt(id_vars=['State'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>



## pivot - index, column, value가 될 컬럼들을 지정해 재구조화
- 데이터프레임 재구조화가 목적
- 데이터 프레임에서 두개이상의 범주형 변수를 그룹으로 묶어 특정 값을 보려고 할때 사용할 수 있다.
    - pivot_table은 그룹으로 묶은 뒤 특정 변수의 통계량을 본다면 pivot은 그 값을 그대로 본다.
- melt()된 것을 원상복구 시킬때도 사용할 수 있다.

### pivot 매개변수
- **index**: 문자열. 행이름으로 사용할 컬럼 -> 열이 index로 이동하는 형태가 된다.
- **columns**: 문자열. 컬럼명으로 사용할 컬럼
- **values** : Value에 올 컬럼명


```python
df3.columns=['State','Fruit','Count']
df3
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>State</th>
      <th>Fruit</th>
      <th>Count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Texas</td>
      <td>Apple</td>
      <td>12</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Arizona</td>
      <td>Apple</td>
      <td>9</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Florida</td>
      <td>Apple</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Texas</td>
      <td>Orange</td>
      <td>10</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Arizona</td>
      <td>Orange</td>
      <td>7</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Florida</td>
      <td>Orange</td>
      <td>14</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Texas</td>
      <td>Banana</td>
      <td>40</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Arizona</td>
      <td>Banana</td>
      <td>12</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Florida</td>
      <td>Banana</td>
      <td>190</td>
    </tr>
  </tbody>
</table>
</div>




```python
df3.pivot_table(index='State',columns='Fruit',values='Count')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Fruit</th>
      <th>Apple</th>
      <th>Banana</th>
      <th>Orange</th>
    </tr>
    <tr>
      <th>State</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Arizona</th>
      <td>9.0</td>
      <td>12.0</td>
      <td>7.0</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>0.0</td>
      <td>190.0</td>
      <td>14.0</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>12.0</td>
      <td>40.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df3.pivot(index='State',columns='Fruit',values='Count')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Fruit</th>
      <th>Apple</th>
      <th>Banana</th>
      <th>Orange</th>
    </tr>
    <tr>
      <th>State</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Arizona</th>
      <td>9</td>
      <td>12</td>
      <td>7</td>
    </tr>
    <tr>
      <th>Florida</th>
      <td>0</td>
      <td>190</td>
      <td>14</td>
    </tr>
    <tr>
      <th>Texas</th>
      <td>12</td>
      <td>40</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>



## crosstab()
- 범주형 값들 고유값 별 빈도표를 만든다.

### 매개변수
- **index**: 행에 들어올 1차원 배열
- **columns**: 열에 들어올 1차원 배열
- **rownames**: index 이름 지정. 생략하면 index의 고유값들로 설정된다.
- **colnames**: column 이름 지정. 생략하면 columns의 고유값들로 설정된다.
- **margins**: 총합계 행과 열을 추가할지 여부. True-추가, False-추가안함(기본값)
- **normalize**: 빈도수를 비율로 나타낸다.


```python
# 10: 학생, 자영업, 회사원
Job = ['학생','회사원','자영업','회사원','회사원','학생','학생','자영업','자영업','회사원']
```


```python
# 10 : pass, fail
Pass = ['pass','pass','pass','fail','pass','fail','pass','pass','fail','fail']
```


```python
df = pd.DataFrame({
    'Job':Job,
    'Pass': Pass
})
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Job</th>
      <th>Pass</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>학생</td>
      <td>pass</td>
    </tr>
    <tr>
      <th>1</th>
      <td>회사원</td>
      <td>pass</td>
    </tr>
    <tr>
      <th>2</th>
      <td>자영업</td>
      <td>pass</td>
    </tr>
    <tr>
      <th>3</th>
      <td>회사원</td>
      <td>fail</td>
    </tr>
    <tr>
      <th>4</th>
      <td>회사원</td>
      <td>pass</td>
    </tr>
    <tr>
      <th>5</th>
      <td>학생</td>
      <td>fail</td>
    </tr>
    <tr>
      <th>6</th>
      <td>학생</td>
      <td>pass</td>
    </tr>
    <tr>
      <th>7</th>
      <td>자영업</td>
      <td>pass</td>
    </tr>
    <tr>
      <th>8</th>
      <td>자영업</td>
      <td>fail</td>
    </tr>
    <tr>
      <th>9</th>
      <td>회사원</td>
      <td>fail</td>
    </tr>
  </tbody>
</table>
</div>




```python
df['Job'].value_counts()
```




    Job
    회사원    4
    학생     3
    자영업    3
    Name: count, dtype: int64




```python
df['Pass'].value_counts()
```




    Pass
    pass    6
    fail    4
    Name: count, dtype: int64




```python
df.groupby(['Job','Pass'])['Job'].count()
```




    Job  Pass
    자영업  fail    1
         pass    2
    학생   fail    1
         pass    2
    회사원  fail    2
         pass    2
    Name: Job, dtype: int64




```python
pd.crosstab(index=df['Job'],columns=df['Pass'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pass</th>
      <th>fail</th>
      <th>pass</th>
    </tr>
    <tr>
      <th>Job</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>자영업</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>학생</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>회사원</th>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
# 총집계
pd.crosstab(index=df['Job'],columns=df['Pass'], margins=True, margins_name='명')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pass</th>
      <th>fail</th>
      <th>pass</th>
      <th>명</th>
    </tr>
    <tr>
      <th>Job</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>자영업</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>학생</th>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <th>회사원</th>
      <td>2</td>
      <td>2</td>
      <td>4</td>
    </tr>
    <tr>
      <th>명</th>
      <td>4</td>
      <td>6</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
# normalize : 비율
pd.crosstab(index=df['Job'],columns=df['Pass'], normalize=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pass</th>
      <th>fail</th>
      <th>pass</th>
    </tr>
    <tr>
      <th>Job</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>자영업</th>
      <td>0.1</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>학생</th>
      <td>0.1</td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>회사원</th>
      <td>0.2</td>
      <td>0.2</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(index=df['Job'],columns=df['Pass'], margins=True, normalize=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Pass</th>
      <th>fail</th>
      <th>pass</th>
      <th>All</th>
    </tr>
    <tr>
      <th>Job</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>자영업</th>
      <td>0.1</td>
      <td>0.2</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>학생</th>
      <td>0.1</td>
      <td>0.2</td>
      <td>0.3</td>
    </tr>
    <tr>
      <th>회사원</th>
      <td>0.2</td>
      <td>0.2</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.4</td>
      <td>0.6</td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab(Job, Pass, colnames=['통과여부'], rownames=['직업'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>통과여부</th>
      <th>fail</th>
      <th>pass</th>
    </tr>
    <tr>
      <th>직업</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>자영업</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>학생</th>
      <td>1</td>
      <td>2</td>
    </tr>
    <tr>
      <th>회사원</th>
      <td>2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
dia = pd.read_csv('data/diamonds.csv')
dia.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 53940 entries, 0 to 53939
    Data columns (total 10 columns):
     #   Column   Non-Null Count  Dtype  
    ---  ------   --------------  -----  
     0   carat    53940 non-null  float64
     1   cut      53940 non-null  object 
     2   color    53940 non-null  object 
     3   clarity  53940 non-null  object 
     4   depth    53940 non-null  float64
     5   table    53940 non-null  float64
     6   price    53940 non-null  int64  
     7   x        53940 non-null  float64
     8   y        53940 non-null  float64
     9   z        53940 non-null  float64
    dtypes: float64(6), int64(1), object(3)
    memory usage: 4.1+ MB
    


```python
pd.crosstab(dia['cut'], dia['color'], margins=True, normalize=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>All</th>
    </tr>
    <tr>
      <th>cut</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Fair</th>
      <td>0.003022</td>
      <td>0.004153</td>
      <td>0.005784</td>
      <td>0.005821</td>
      <td>0.005617</td>
      <td>0.003244</td>
      <td>0.002206</td>
      <td>0.029848</td>
    </tr>
    <tr>
      <th>Good</th>
      <td>0.012273</td>
      <td>0.017297</td>
      <td>0.016852</td>
      <td>0.016148</td>
      <td>0.013014</td>
      <td>0.009677</td>
      <td>0.005692</td>
      <td>0.090953</td>
    </tr>
    <tr>
      <th>Ideal</th>
      <td>0.052540</td>
      <td>0.072358</td>
      <td>0.070931</td>
      <td>0.090545</td>
      <td>0.057749</td>
      <td>0.038802</td>
      <td>0.016611</td>
      <td>0.399537</td>
    </tr>
    <tr>
      <th>Premium</th>
      <td>0.029718</td>
      <td>0.043326</td>
      <td>0.043215</td>
      <td>0.054208</td>
      <td>0.043752</td>
      <td>0.026474</td>
      <td>0.014980</td>
      <td>0.255673</td>
    </tr>
    <tr>
      <th>Very Good</th>
      <td>0.028050</td>
      <td>0.044494</td>
      <td>0.040119</td>
      <td>0.042621</td>
      <td>0.033815</td>
      <td>0.022321</td>
      <td>0.012570</td>
      <td>0.223990</td>
    </tr>
    <tr>
      <th>All</th>
      <td>0.125603</td>
      <td>0.181628</td>
      <td>0.176900</td>
      <td>0.209344</td>
      <td>0.153949</td>
      <td>0.100519</td>
      <td>0.052058</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.crosstab([dia['cut'], dia['clarity']], dia['color'], margins=True, normalize=True)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>color</th>
      <th>D</th>
      <th>E</th>
      <th>F</th>
      <th>G</th>
      <th>H</th>
      <th>I</th>
      <th>J</th>
      <th>All</th>
    </tr>
    <tr>
      <th>cut</th>
      <th>clarity</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="8" valign="top">Fair</th>
      <th>I1</th>
      <td>0.000074</td>
      <td>0.000167</td>
      <td>0.000649</td>
      <td>0.000983</td>
      <td>0.000964</td>
      <td>0.000630</td>
      <td>0.000426</td>
      <td>0.003893</td>
    </tr>
    <tr>
      <th>IF</th>
      <td>0.000056</td>
      <td>0.000000</td>
      <td>0.000074</td>
      <td>0.000037</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000167</td>
    </tr>
    <tr>
      <th>SI1</th>
      <td>0.001075</td>
      <td>0.001205</td>
      <td>0.001539</td>
      <td>0.001279</td>
      <td>0.001390</td>
      <td>0.000556</td>
      <td>0.000519</td>
      <td>0.007564</td>
    </tr>
    <tr>
      <th>SI2</th>
      <td>0.001038</td>
      <td>0.001446</td>
      <td>0.001650</td>
      <td>0.001483</td>
      <td>0.001687</td>
      <td>0.000834</td>
      <td>0.000501</td>
      <td>0.008639</td>
    </tr>
    <tr>
      <th>VS1</th>
      <td>0.000093</td>
      <td>0.000260</td>
      <td>0.000612</td>
      <td>0.000834</td>
      <td>0.000593</td>
      <td>0.000463</td>
      <td>0.000297</td>
      <td>0.003152</td>
    </tr>
    <tr>
      <th>VS2</th>
      <td>0.000463</td>
      <td>0.000779</td>
      <td>0.000983</td>
      <td>0.000834</td>
      <td>0.000760</td>
      <td>0.000593</td>
      <td>0.000426</td>
      <td>0.004839</td>
    </tr>
    <tr>
      <th>VVS1</th>
      <td>0.000056</td>
      <td>0.000056</td>
      <td>0.000093</td>
      <td>0.000056</td>
      <td>0.000019</td>
      <td>0.000019</td>
      <td>0.000019</td>
      <td>0.000315</td>
    </tr>
    <tr>
      <th>VVS2</th>
      <td>0.000167</td>
      <td>0.000241</td>
      <td>0.000185</td>
      <td>0.000315</td>
      <td>0.000204</td>
      <td>0.000148</td>
      <td>0.000019</td>
      <td>0.001279</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Good</th>
      <th>I1</th>
      <td>0.000148</td>
      <td>0.000426</td>
      <td>0.000352</td>
      <td>0.000352</td>
      <td>0.000260</td>
      <td>0.000167</td>
      <td>0.000074</td>
      <td>0.001780</td>
    </tr>
    <tr>
      <th>IF</th>
      <td>0.000167</td>
      <td>0.000167</td>
      <td>0.000278</td>
      <td>0.000408</td>
      <td>0.000074</td>
      <td>0.000111</td>
      <td>0.000111</td>
      <td>0.001316</td>
    </tr>
    <tr>
      <th>SI1</th>
      <td>0.004394</td>
      <td>0.006581</td>
      <td>0.005061</td>
      <td>0.003838</td>
      <td>0.004357</td>
      <td>0.003059</td>
      <td>0.001631</td>
      <td>0.028921</td>
    </tr>
    <tr>
      <th>SI2</th>
      <td>0.004134</td>
      <td>0.003745</td>
      <td>0.003726</td>
      <td>0.003022</td>
      <td>0.002929</td>
      <td>0.001502</td>
      <td>0.000983</td>
      <td>0.020041</td>
    </tr>
    <tr>
      <th>VS1</th>
      <td>0.000797</td>
      <td>0.001650</td>
      <td>0.002447</td>
      <td>0.002818</td>
      <td>0.001428</td>
      <td>0.001910</td>
      <td>0.000964</td>
      <td>0.012013</td>
    </tr>
    <tr>
      <th>VS2</th>
      <td>0.001928</td>
      <td>0.002966</td>
      <td>0.003411</td>
      <td>0.003560</td>
      <td>0.002558</td>
      <td>0.002039</td>
      <td>0.001669</td>
      <td>0.018131</td>
    </tr>
    <tr>
      <th>VVS1</th>
      <td>0.000241</td>
      <td>0.000797</td>
      <td>0.000649</td>
      <td>0.000760</td>
      <td>0.000575</td>
      <td>0.000408</td>
      <td>0.000019</td>
      <td>0.003448</td>
    </tr>
    <tr>
      <th>VVS2</th>
      <td>0.000463</td>
      <td>0.000964</td>
      <td>0.000927</td>
      <td>0.001390</td>
      <td>0.000834</td>
      <td>0.000482</td>
      <td>0.000241</td>
      <td>0.005302</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Ideal</th>
      <th>I1</th>
      <td>0.000241</td>
      <td>0.000334</td>
      <td>0.000779</td>
      <td>0.000297</td>
      <td>0.000704</td>
      <td>0.000315</td>
      <td>0.000037</td>
      <td>0.002707</td>
    </tr>
    <tr>
      <th>IF</th>
      <td>0.000519</td>
      <td>0.001465</td>
      <td>0.004968</td>
      <td>0.009103</td>
      <td>0.004190</td>
      <td>0.001761</td>
      <td>0.000463</td>
      <td>0.022469</td>
    </tr>
    <tr>
      <th>SI1</th>
      <td>0.013682</td>
      <td>0.014201</td>
      <td>0.011272</td>
      <td>0.012236</td>
      <td>0.014145</td>
      <td>0.009344</td>
      <td>0.004505</td>
      <td>0.079385</td>
    </tr>
    <tr>
      <th>SI2</th>
      <td>0.006600</td>
      <td>0.008695</td>
      <td>0.008398</td>
      <td>0.009010</td>
      <td>0.008343</td>
      <td>0.005080</td>
      <td>0.002039</td>
      <td>0.048165</td>
    </tr>
    <tr>
      <th>VS1</th>
      <td>0.006507</td>
      <td>0.010994</td>
      <td>0.011420</td>
      <td>0.017668</td>
      <td>0.008658</td>
      <td>0.007564</td>
      <td>0.003726</td>
      <td>0.066537</td>
    </tr>
    <tr>
      <th>VS2</th>
      <td>0.017056</td>
      <td>0.021060</td>
      <td>0.016296</td>
      <td>0.016871</td>
      <td>0.010308</td>
      <td>0.008120</td>
      <td>0.004301</td>
      <td>0.094012</td>
    </tr>
    <tr>
      <th>VVS1</th>
      <td>0.002670</td>
      <td>0.006211</td>
      <td>0.008157</td>
      <td>0.011012</td>
      <td>0.006044</td>
      <td>0.003319</td>
      <td>0.000538</td>
      <td>0.037950</td>
    </tr>
    <tr>
      <th>VVS2</th>
      <td>0.005265</td>
      <td>0.009399</td>
      <td>0.009640</td>
      <td>0.014349</td>
      <td>0.005358</td>
      <td>0.003300</td>
      <td>0.001001</td>
      <td>0.048313</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Premium</th>
      <th>I1</th>
      <td>0.000222</td>
      <td>0.000556</td>
      <td>0.000630</td>
      <td>0.000853</td>
      <td>0.000853</td>
      <td>0.000445</td>
      <td>0.000241</td>
      <td>0.003801</td>
    </tr>
    <tr>
      <th>IF</th>
      <td>0.000185</td>
      <td>0.000501</td>
      <td>0.000575</td>
      <td>0.001613</td>
      <td>0.000742</td>
      <td>0.000426</td>
      <td>0.000222</td>
      <td>0.004264</td>
    </tr>
    <tr>
      <th>SI1</th>
      <td>0.010308</td>
      <td>0.011383</td>
      <td>0.011272</td>
      <td>0.010493</td>
      <td>0.012143</td>
      <td>0.006804</td>
      <td>0.003875</td>
      <td>0.066277</td>
    </tr>
    <tr>
      <th>SI2</th>
      <td>0.007805</td>
      <td>0.009622</td>
      <td>0.009696</td>
      <td>0.009121</td>
      <td>0.009659</td>
      <td>0.005784</td>
      <td>0.002985</td>
      <td>0.054672</td>
    </tr>
    <tr>
      <th>VS1</th>
      <td>0.002429</td>
      <td>0.005413</td>
      <td>0.005376</td>
      <td>0.010493</td>
      <td>0.006229</td>
      <td>0.004097</td>
      <td>0.002836</td>
      <td>0.036874</td>
    </tr>
    <tr>
      <th>VS2</th>
      <td>0.006285</td>
      <td>0.011661</td>
      <td>0.011476</td>
      <td>0.013367</td>
      <td>0.009863</td>
      <td>0.005840</td>
      <td>0.003745</td>
      <td>0.062236</td>
    </tr>
    <tr>
      <th>VVS1</th>
      <td>0.000742</td>
      <td>0.001947</td>
      <td>0.001483</td>
      <td>0.003170</td>
      <td>0.002076</td>
      <td>0.001557</td>
      <td>0.000445</td>
      <td>0.011420</td>
    </tr>
    <tr>
      <th>VVS2</th>
      <td>0.001743</td>
      <td>0.002243</td>
      <td>0.002707</td>
      <td>0.005098</td>
      <td>0.002188</td>
      <td>0.001520</td>
      <td>0.000630</td>
      <td>0.016129</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">Very Good</th>
      <th>I1</th>
      <td>0.000093</td>
      <td>0.000408</td>
      <td>0.000241</td>
      <td>0.000297</td>
      <td>0.000222</td>
      <td>0.000148</td>
      <td>0.000148</td>
      <td>0.001557</td>
    </tr>
    <tr>
      <th>IF</th>
      <td>0.000426</td>
      <td>0.000797</td>
      <td>0.001242</td>
      <td>0.001465</td>
      <td>0.000538</td>
      <td>0.000352</td>
      <td>0.000148</td>
      <td>0.004968</td>
    </tr>
    <tr>
      <th>SI1</th>
      <td>0.009158</td>
      <td>0.011605</td>
      <td>0.010363</td>
      <td>0.008788</td>
      <td>0.010141</td>
      <td>0.006637</td>
      <td>0.003374</td>
      <td>0.060067</td>
    </tr>
    <tr>
      <th>SI2</th>
      <td>0.005821</td>
      <td>0.008250</td>
      <td>0.006359</td>
      <td>0.006062</td>
      <td>0.006359</td>
      <td>0.003708</td>
      <td>0.002373</td>
      <td>0.038932</td>
    </tr>
    <tr>
      <th>VS1</th>
      <td>0.003244</td>
      <td>0.005432</td>
      <td>0.005432</td>
      <td>0.008009</td>
      <td>0.004765</td>
      <td>0.003801</td>
      <td>0.002225</td>
      <td>0.032907</td>
    </tr>
    <tr>
      <th>VS2</th>
      <td>0.005729</td>
      <td>0.009325</td>
      <td>0.008639</td>
      <td>0.008880</td>
      <td>0.006971</td>
      <td>0.005080</td>
      <td>0.003411</td>
      <td>0.048035</td>
    </tr>
    <tr>
      <th>VVS1</th>
      <td>0.000964</td>
      <td>0.003152</td>
      <td>0.003226</td>
      <td>0.003522</td>
      <td>0.002132</td>
      <td>0.001279</td>
      <td>0.000352</td>
      <td>0.014627</td>
    </tr>
    <tr>
      <th>VVS2</th>
      <td>0.002614</td>
      <td>0.005525</td>
      <td>0.004616</td>
      <td>0.005599</td>
      <td>0.002688</td>
      <td>0.001316</td>
      <td>0.000538</td>
      <td>0.022896</td>
    </tr>
    <tr>
      <th>All</th>
      <th></th>
      <td>0.125603</td>
      <td>0.181628</td>
      <td>0.176900</td>
      <td>0.209344</td>
      <td>0.153949</td>
      <td>0.100519</td>
      <td>0.052058</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>


